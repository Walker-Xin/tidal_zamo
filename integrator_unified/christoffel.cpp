void christoffel(double r, double chi, double christ[4][4][4])
{
    double t2 = pow(r, 2);
    double t3 = pow(spin, 2);
    double t6 = pow(charge, 2);
    double t7 = -2 * M * r;
    double t10 = pow(chi, 2);
    double t11 = t10 * t3;
    double t12 = t11 + t2;
    double t13 = pow(t12, -2);
    double t5 = t2 + t3;
    double t8 = t2 + t3 + t6 + t7;
    double t9 = 1 / t8;
    double t14 = -(r * t6);
    double t15 = -(chi * spin);
    double t16 = r + t15;
    double t17 = chi * spin;
    double t18 = r + t17;
    double t19 = M * t16 * t18;
    double t20 = t14 + t19;
    double t21 = t13 * t20 * t5 * t9;
    double t24 = -1 + t10;
    double t22 = t6 + t7;
    double t23 = -(chi * t13 * t22 * t3);
    double t35 = pow(spin, 3);
    double t25 = pow(r, 3);
    double t26 = -2 * t6;
    double t27 = 3 * M * r;
    double t28 = t26 + t27;
    double t29 = spin * t24 * t25 * t28;
    double t30 = pow(chi, 4);
    double t31 = -1 + t30;
    double t32 = -t6;
    double t33 = M * r;
    double t34 = t32 + t33;
    double t36 = r * t31 * t34 * t35;
    double t37 = pow(spin, 5);
    double t38 = -(M * t10 * t24 * t37);
    double t39 = t29 + t36 + t38;
    double t40 = t13 * t39 * t9;
    double t41 = -(chi * t13 * t22 * t24 * t35);
    double t42 = pow(t12, -3);
    double t43 = -(M * r);
    double t44 = t43 + t6;
    double t45 = r * t44;
    double t46 = M * t10 * t3;
    double t47 = t45 + t46;
    double t53 = 1 / t12;
    double t56 = chi * t3 * t53;
    double t49 = -(spin * t24 * t42 * t47 * t8);
    double t54 = r * t53;
    double t57 = 1 / t24;
    double t75 = -(chi * spin * t22 * t24 * t42 * t5);
    double t70 = pow(spin, 4);
    double t101 = -(spin * t13 * t47 * t9);
    double t102 = chi * spin * t13 * t22 * t57;
    double t106 = pow(r, 4);
    double t103 = r * t5 * t6;
    double t104 = pow(t12, 2);
    double t105 = r * t104;
    double t107 = 2 * t106;
    double t108 = 1 + t10;
    double t109 = t108 * t2 * t3;
    double t110 = t10 * t24 * t70;
    double t111 = t107 + t109 + t110;
    double t112 = -(M * t111);
    double t113 = t103 + t105 + t112;
    double t114 = t113 * t13 * t9;
    double t115 = t24 * t6;
    double t116 = 2 * M * r;
    double t117 = -M;
    double t118 = r + t117;
    double t119 = 2 * r * t10 * t118;
    double t120 = t115 + t116 + t119;
    double t121 = t120 * t3;
    double t122 = t30 * t70;
    double t123 = t106 + t121 + t122;
    double t124 = chi * t123 * t13 * t57;
    christ[0][0][0] = 0;
    christ[0][0][1] = t21;
    christ[0][0][2] = t23;
    christ[0][0][3] = 0;
    christ[0][1][0] = t21;
    christ[0][1][1] = 0;
    christ[0][1][2] = 0;
    christ[0][1][3] = t40;
    christ[0][2][0] = t23;
    christ[0][2][1] = 0;
    christ[0][2][2] = 0;
    christ[0][2][3] = t41;
    christ[0][3][0] = 0;
    christ[0][3][1] = t40;
    christ[0][3][2] = t41;
    christ[0][3][3] = 0;
    christ[1][0][0] = -(t42 * t47 * t8);
    christ[1][0][1] = 0;
    christ[1][0][2] = 0;
    christ[1][0][3] = t49;
    christ[1][1][0] = 0;
    christ[1][1][1] = t54 + (M - r) * t9;
    christ[1][1][2] = t56;
    christ[1][1][3] = 0;
    christ[1][2][0] = 0;
    christ[1][2][1] = t56;
    christ[1][2][2] = r * t53 * t57 * t8;
    christ[1][2][3] = 0;
    christ[1][3][0] = t49;
    christ[1][3][1] = 0;
    christ[1][3][2] = 0;
    christ[1][3][3] = -(t24 * t42 * (-pow(r, 5) - r * t3 * (r * (M + 2 * r) * t10 + t43 - t24 * t6) - t10 * (M - M * t10 + r * t10) * t70) * t8);
    christ[2][0][0] = chi * t22 * t24 * t3 * t42;
    christ[2][0][1] = 0;
    christ[2][0][2] = 0;
    christ[2][0][3] = t75;
    christ[2][1][0] = 0;
    christ[2][1][1] = chi * t24 * t3 * t53 * t9;
    christ[2][1][2] = t54;
    christ[2][1][3] = 0;
    christ[2][2][0] = 0;
    christ[2][2][1] = t54;
    christ[2][2][2] = -(chi * t5 * t53 * t57);
    christ[2][2][3] = 0;
    christ[2][3][0] = t75;
    christ[2][3][1] = 0;
    christ[2][3][2] = 0;
    christ[2][3][3] = chi * t24 * t42 * (-pow(r, 6) - pow(spin, 6) * t30 - t2 * t3 * (4 * M * r + r * (r + 2 * (-2 * M + r) * t10) + 2 * t24 * t6) - (r * (r * t10 * (2 + t10) - 2 * M * t31) + t31 * t6) * t70);
    christ[3][0][0] = 0;
    christ[3][0][1] = t101;
    christ[3][0][2] = t102;
    christ[3][0][3] = 0;
    christ[3][1][0] = t101;
    christ[3][1][1] = 0;
    christ[3][1][2] = 0;
    christ[3][1][3] = t114;
    christ[3][2][0] = t102;
    christ[3][2][1] = 0;
    christ[3][2][2] = 0;
    christ[3][2][3] = t124;
    christ[3][3][0] = 0;
    christ[3][3][1] = t114;
    christ[3][3][2] = t124;
    christ[3][3][3] = 0;
}

void christoffel_spherical(double r, double chi, double christ[4][4][4])
{
    double t3 = pow(charge, 2);
    double t2 = 1 / r;
    double t5 = -t3;
    double t6 = M * r;
    double t7 = t5 + t6;
    double t8 = -2 * M;
    double t9 = r + t8;
    double t10 = r * t9;
    double t11 = t10 + t3;
    double t12 = 1 / t11;
    double t13 = t12 * t2 * t7;
    double t24 = pow(chi, 2);
    double t25 = -1 + t24;
    double t26 = 1 / t25;
    double t36 = chi * t26;
    christ[0][0][0] = 0;
    christ[0][0][1] = t13;
    christ[0][0][2] = 0;
    christ[0][0][3] = 0;
    christ[0][1][0] = t13;
    christ[0][1][1] = 0;
    christ[0][1][2] = 0;
    christ[0][1][3] = 0;
    christ[0][2][0] = 0;
    christ[0][2][1] = 0;
    christ[0][2][2] = 0;
    christ[0][2][3] = 0;
    christ[0][3][0] = 0;
    christ[0][3][1] = 0;
    christ[0][3][2] = 0;
    christ[0][3][3] = 0;
    christ[1][0][0] = (t11 * t7) / pow(r, 5);
    christ[1][0][1] = 0;
    christ[1][0][2] = 0;
    christ[1][0][3] = 0;
    christ[1][1][0] = 0;
    christ[1][1][1] = t2 + (M - r) / (-2 * M * r + pow(r, 2) + t3);
    christ[1][1][2] = 0;
    christ[1][1][3] = 0;
    christ[1][2][0] = 0;
    christ[1][2][1] = 0;
    christ[1][2][2] = t11 * t2 * t26;
    christ[1][2][3] = 0;
    christ[1][3][0] = 0;
    christ[1][3][1] = 0;
    christ[1][3][2] = 0;
    christ[1][3][3] = t11 * t2 * t25;
    christ[2][0][0] = 0;
    christ[2][0][1] = 0;
    christ[2][0][2] = 0;
    christ[2][0][3] = 0;
    christ[2][1][0] = 0;
    christ[2][1][1] = 0;
    christ[2][1][2] = t2;
    christ[2][1][3] = 0;
    christ[2][2][0] = 0;
    christ[2][2][1] = t2;
    christ[2][2][2] = chi / (1 - t24);
    christ[2][2][3] = 0;
    christ[2][3][0] = 0;
    christ[2][3][1] = 0;
    christ[2][3][2] = 0;
    christ[2][3][3] = chi - pow(chi, 3);
    christ[3][0][0] = 0;
    christ[3][0][1] = 0;
    christ[3][0][2] = 0;
    christ[3][0][3] = 0;
    christ[3][1][0] = 0;
    christ[3][1][1] = 0;
    christ[3][1][2] = 0;
    christ[3][1][3] = t2;
    christ[3][2][0] = 0;
    christ[3][2][1] = 0;
    christ[3][2][2] = 0;
    christ[3][2][3] = t36;
    christ[3][3][0] = 0;
    christ[3][3][1] = t2;
    christ[3][3][2] = t36;
    christ[3][3][3] = 0;
}