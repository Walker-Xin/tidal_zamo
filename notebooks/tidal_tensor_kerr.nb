Notebook[{

Cell[CellGroupData[{
Cell["Local Tidal Tensor via ZAMO", "Title",
 CellChangeTimes->{{3.935053924860917*^9, 
  3.935053943461486*^9}},ExpressionUUID->"16e929a7-d0a3-42bd-8425-\
5fe6587a4caa"],

Cell["\<\
Unified Approach for Stationary Axisymmetric Spacetimes - Kerr\
\>", "Subtitle",
 CellChangeTimes->{{3.9350552014790783`*^9, 3.935055213434576*^9}, {
  3.9350556245990334`*^9, 3.9350556258457522`*^9}, {3.936775706479599*^9, 
  3.936775711701614*^9}, {3.9714245792911777`*^9, 
  3.971424580215911*^9}},ExpressionUUID->"98bfcee8-72d8-4f3e-afeb-\
66e7a6644858"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<`*\>\"", "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{
   "reset", " ", "ALL", " ", "variables", " ", "of", " ", "this", " ", 
    "notebook", " ", "context"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{
  3.933854951673094*^9, {3.935054949859747*^9, 3.935054984633556*^9}, {
   3.935055290227911*^9, 3.935055292198041*^9}, {3.935148580061857*^9, 
   3.9351485834819307`*^9}, {3.935148640876643*^9, 3.9351486562020683`*^9}, {
   3.935148691924416*^9, 3.935148693266941*^9}, {3.935148813298492*^9, 
   3.935148847458622*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"a3093947-3853-774a-841d-0c6bf4e2cbdf"],

Cell[CellGroupData[{

Cell["0. Define Helper Functions", "Section",
 CellChangeTimes->{{3.935054792536417*^9, 3.93505480129784*^9}, {
  3.935055311243207*^9, 
  3.935055312033422*^9}},ExpressionUUID->"5f924686-9550-4b1f-97d5-\
11d0f0d62160"],

Cell[CellGroupData[{

Cell["Code for optimising symbolic expressions to C++", "Subsection",
 CellChangeTimes->{{3.935054854935876*^9, 
  3.935054883663043*^9}},ExpressionUUID->"266c74b9-ee4f-4521-9adc-\
47bbfd6a6dc8"],

Cell["ref. https://github.com/ABHModels/raytransfer", "Text",
 CellChangeTimes->{{3.93505491642021*^9, 
  3.935054919625326*^9}},ExpressionUUID->"1541ac38-f1ea-4eb3-b4f2-\
b100322da472"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"::", "Package", "::"}], "*)"}], "\n", "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"BeginPackage", "[", "\"\<OptimizeExpressionToC`\>\"", "]"}], 
    ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"OptimizeExpressionToC", "::", "usage"}], 
     "=", "\"\<Generates optimized version of expression in C\>\""}], ";"}], 
   "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ExtractTags", "::", "usage"}], "=", "\"\<\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ClearTagText", "::", "usage"}], "=", "\"\<\>\""}], ";"}], "\n", 
   
   RowBox[{
    RowBox[{
     RowBox[{"TagExistQ", "::", "usage"}], "=", "\"\<\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"AppendToTag", "::", "usage"}], "=", "\"\<\>\""}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{"Begin", "[", "\"\<Private`\>\"", "]"}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"OptimizeExpressionToC", "[", "expr_List", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "optimizedExpr", ",", "mainExpr", ",", "n", ",", "m", ",", "defs", ",",
          "output"}], "}"}], ",", 
       RowBox[{
        RowBox[{"optimizedExpr", "=", 
         RowBox[{"Experimental`OptimizeExpression", "[", "expr", "]"}]}], ";", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"ToString", "@", 
            RowBox[{"optimizedExpr", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "0"}], "]"}], "]"}]}], 
           "==", "\"\<Block\>\""}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"n", "=", 
             RowBox[{"Length", "[", 
              RowBox[{"optimizedExpr", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
            RowBox[{"mainExpr", "=", 
             RowBox[{"optimizedExpr", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "2", ",", 
                RowBox[{"n", "+", "1"}]}], "]"}], "]"}]}], ";"}], "}"}], ",", 
          
          RowBox[{"{", 
           RowBox[{
            RowBox[{"n", "=", "0"}], ";", 
            RowBox[{"mainExpr", "=", 
             RowBox[{"Flatten", "@", 
              RowBox[{"{", 
               RowBox[{"optimizedExpr", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "}"}]}]}], ";"}], "}"}]}], 
         "]"}], ";", 
        RowBox[{"m", "=", 
         RowBox[{"Length", "[", "mainExpr", "]"}]}], ";", 
        RowBox[{"defs", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"\"\<double \>\"", "<>", 
            RowBox[{"ToString", "@", 
             RowBox[{"CForm", "@", 
              RowBox[{"optimizedExpr", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "2", ",", "i", ",", "1"}], "]"}], "]"}]}]}],
             "<>", "\"\< = \>\"", "<>", 
            RowBox[{"ToString", "@", 
             RowBox[{"CForm", "@", 
              RowBox[{"optimizedExpr", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "2", ",", "i", ",", "2"}], "]"}], "]"}]}]}],
             "<>", "\"\<;\>\""}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", 
        RowBox[{"output", "=", 
         RowBox[{"MapIndexed", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"\"\<out(\>\"", "<>", 
             RowBox[{"StringJoin", "@", 
              RowBox[{"Riffle", "[", 
               RowBox[{
                RowBox[{"ToString", "/@", 
                 RowBox[{"(", 
                  RowBox[{"#2", "-", "1"}], ")"}]}], ",", "\"\<\>\""}], 
               "]"}]}], "<>", "\"\<) = \>\"", "<>", 
             RowBox[{"ToString", "@", 
              RowBox[{"CForm", "@", "#1"}]}], "<>", "\"\<;\>\""}], "&"}], ",",
            "mainExpr", ",", 
           RowBox[{"{", 
            RowBox[{"ArrayDepth", "[", "mainExpr", "]"}], "}"}]}], "]"}]}], ";", 
        RowBox[{"StringReplace", "[", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{"defs", ",", "output"}], "]"}], ",", 
          RowBox[{"\"\<Compile_$\>\"", "->", "\"\<t\>\""}]}], "]"}]}]}], 
      "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{"End", "[", "]"}], ";"}], "\n", "Null", "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ExtractTags", "[", "string_String", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"regex", ",", "extractTag"}], "}"}], ",", 
       RowBox[{
        RowBox[{"regex", "=", 
         RowBox[{
         "RegularExpression", 
          "[", "\"\<\\\\n([^\\\\n]*)// (\\\\[|</?)([^\\\\]\\\\n]*)(\\\\]|>)[^\
\\\\n]*\\\\n\>\"", "]"}]}], ";", 
        RowBox[{
         RowBox[{"extractTag", "[", "bounds_", "]"}], ":=", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "substring", ",", "indentation", ",", "tagType", ",", "tag"}], 
            "}"}], ",", 
           RowBox[{
            RowBox[{"substring", "=", 
             RowBox[{"StringTake", "[", 
              RowBox[{"string", ",", "bounds"}], "]"}]}], ";", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"{", 
               RowBox[{"indentation", ",", "tagType", ",", "tag"}], "}"}], 
              "}"}], "=", 
             RowBox[{"StringCases", "[", 
              RowBox[{"substring", ",", 
               RowBox[{"regex", "->", 
                RowBox[{"{", 
                 RowBox[{"\"\<$1\>\"", ",", "\"\<$2\>\"", ",", "\"\<$3\>\""}],
                  "}"}]}]}], "]"}]}], ";", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{"\"\<indentation\>\"", "->", "indentation"}], ",", 
              RowBox[{"\"\<tagType\>\"", "->", "tagType"}], ",", 
              RowBox[{"\"\<tag\>\"", "->", "tag"}], ",", 
              RowBox[{"\"\<start\>\"", "->", 
               RowBox[{
                RowBox[{"bounds", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "+", "1"}]}], ",", 
              RowBox[{"\"\<end\>\"", "->", 
               RowBox[{"bounds", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}]}]}], "]"}]}], ";", 
        RowBox[{
         RowBox[{
          RowBox[{"extractTag", "[", "#", "]"}], "&"}], "/@", 
         RowBox[{"StringPosition", "[", 
          RowBox[{"string", ",", "regex"}], "]"}]}]}]}], "]"}]}], ";"}], "\n",
    "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"TagExistQ", "[", 
      RowBox[{"string_String", ",", "tag_String"}], "]"}], ":=", 
     RowBox[{"AnyTrue", "[", 
      RowBox[{
       RowBox[{"ExtractTags", "[", "string", "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "\"\<tag\>\"", "]"}], "]"}], "==", "tag"}], "&"}]}], 
      "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{"ClearTagText", "[", 
     RowBox[{"string_String", ",", "tag_String"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"tags", ",", "startTag", ",", "endTag", ",", "x"}], "}"}], ",", 
      RowBox[{
       RowBox[{"tags", "=", 
        RowBox[{"ExtractTags", "[", "string", "]"}]}], ";", 
       RowBox[{"startTag", "=", 
        RowBox[{"FirstCase", "[", 
         RowBox[{"tags", ",", 
          RowBox[{"x_", "/;", 
           RowBox[{
            RowBox[{
             RowBox[{"x", "[", 
              RowBox[{"[", "\"\<tag\>\"", "]"}], "]"}], "==", "tag"}], "&&", 
            RowBox[{
             RowBox[{"x", "[", 
              RowBox[{"[", "\"\<tagType\>\"", "]"}], "]"}], 
             "==", "\"\<<\>\""}]}]}]}], "]"}]}], ";", 
       RowBox[{"endTag", "=", 
        RowBox[{"FirstCase", "[", 
         RowBox[{"tags", ",", 
          RowBox[{"x_", "/;", 
           RowBox[{
            RowBox[{
             RowBox[{"x", "[", 
              RowBox[{"[", "\"\<tag\>\"", "]"}], "]"}], "==", "tag"}], "&&", 
            RowBox[{
             RowBox[{"x", "[", 
              RowBox[{"[", "\"\<tagType\>\"", "]"}], "]"}], 
             "==", "\"\<</\>\""}]}]}]}], "]"}]}], ";", 
       RowBox[{
        RowBox[{"StringTake", "[", 
         RowBox[{"string", ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"startTag", "[", 
             RowBox[{"[", "\"\<end\>\"", "]"}], "]"}]}], "}"}]}], "]"}], "<>", 
        RowBox[{"StringTake", "[", 
         RowBox[{"string", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"endTag", "[", 
             RowBox[{"[", "\"\<start\>\"", "]"}], "]"}], ",", 
            RowBox[{"StringLength", "[", "string", "]"}]}], "}"}]}], 
         "]"}]}]}]}], "]"}]}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"AppendToTag", "[", 
      RowBox[{"string_String", ",", "tag_String", ",", "linesToAppend_List"}],
       "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tags", ",", "startTag", ",", "indent", ",", "x"}], "}"}], ",", 
       RowBox[{
        RowBox[{"tags", "=", 
         RowBox[{"ExtractTags", "[", "string", "]"}]}], ";", 
        RowBox[{"startTag", "=", 
         RowBox[{"FirstCase", "[", 
          RowBox[{"tags", ",", 
           RowBox[{"x_", "/;", 
            RowBox[{
             RowBox[{
              RowBox[{"x", "[", 
               RowBox[{"[", "\"\<tag\>\"", "]"}], "]"}], "==", "tag"}], "&&", 
             
             RowBox[{
              RowBox[{"x", "[", 
               RowBox[{"[", "\"\<tagType\>\"", "]"}], "]"}], 
              "==", "\"\<<\>\""}]}]}]}], "]"}]}], ";", 
        RowBox[{"indent", "=", 
         RowBox[{"startTag", "[", 
          RowBox[{"[", "\"\<indentation\>\"", "]"}], "]"}]}], ";", 
        RowBox[{
         RowBox[{"StringTake", "[", 
          RowBox[{"string", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"startTag", "[", 
              RowBox[{"[", "\"\<end\>\"", "]"}], "]"}]}], "}"}]}], "]"}], "<>", 
         RowBox[{"StringRiffle", "[", 
          RowBox[{"linesToAppend", ",", 
           RowBox[{"{", 
            RowBox[{"indent", ",", 
             RowBox[{"\"\<\\n\>\"", "<>", "indent"}], ",", "\"\<\\n\>\""}], 
            "}"}]}], "]"}], "<>", 
         RowBox[{"StringTake", "[", 
          RowBox[{"string", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"startTag", "[", 
               RowBox[{"[", "\"\<end\>\"", "]"}], "]"}], "+", "1"}], ",", 
             RowBox[{"StringLength", "[", "string", "]"}]}], "}"}]}], 
          "]"}]}]}]}], "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"AppendToTag", "[", 
      RowBox[{
      "string_String", ",", "tag_String", ",", "stringToAppend_String"}], 
      "]"}], ":=", 
     RowBox[{"AppendToTag", "[", 
      RowBox[{"string", ",", "tag", ",", 
       RowBox[{"StringSplit", "[", 
        RowBox[{"stringToAppend", ",", "\"\<\\n\>\""}], "]"}]}], "]"}]}], 
    ";"}], "\n", "Null", "\n", "\n", 
   RowBox[{
    RowBox[{"EndPackage", "[", "]"}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.934547450354631*^9, {3.9348698658165197`*^9, 3.934869870264975*^9}},
 CellLabel->"In[50]:=",ExpressionUUID->"f21bef1c-65ef-4768-aab2-4366f8ad3ab3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"outputMetric", "[", 
    RowBox[{"matrix_", ",", 
     RowBox[{"filename_", ":", "\"\<metric.cpp\>\""}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "text", ",", "meat", ",", "header", ",", "footer", ",", "output"}], 
      "}"}], ",", 
     RowBox[{
      RowBox[{"text", "=", 
       RowBox[{"OptimizeExpressionToC", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"matrix", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"matrix", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"matrix", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"matrix", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "4", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"matrix", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"matrix", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"matrix", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"matrix", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", 
           RowBox[{"[", "4", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"matrix", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"matrix", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"matrix", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"matrix", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "[", 
           RowBox[{"[", "4", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"matrix", "[", 
            RowBox[{"[", "4", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"matrix", "[", 
            RowBox[{"[", "4", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"matrix", "[", 
            RowBox[{"[", "4", "]"}], "]"}], "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"matrix", "[", 
            RowBox[{"[", "4", "]"}], "]"}], "[", 
           RowBox[{"[", "4", "]"}], "]"}]}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"meat", "=", 
       RowBox[{"ToString", "[", 
        RowBox[{"Column", "[", 
         RowBox[{"StringReplace", "[", 
          RowBox[{"text", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\"\<Sqrt\>\"", "->", "\"\<sqrt\>\""}], ",", 
             RowBox[{"\"\<Power(E,\>\"", "->", "\"\<exp(\>\""}], ",", 
             RowBox[{"\"\<Power\>\"", "->", "\"\<pow\>\""}], ",", 
             RowBox[{"\"\<Sin\>\"", "->", "\"\<sin\>\""}], ",", 
             RowBox[{"\"\<Cos\>\"", "->", "\"\<cos\>\""}], ",", 
             RowBox[{"\"\<Csc\>\"", "->", "\"\<1/sin\>\""}], ",", 
             RowBox[{"\"\<Cot\>\"", "->", "\"\<1/tan\>\""}], ",", 
             RowBox[{"\"\<double\>\"", "->", "\"\<double\>\""}], ",", 
             RowBox[{"\"\<;,\>\"", "->", "\"\<;\\n    \>\""}], ",", 
             RowBox[{"\"\<out(0)\>\"", "->", "\"\<g[0][0]\>\""}], ",", 
             RowBox[{"\"\<out(1)\>\"", "->", "\"\<g[0][1]\>\""}], ",", 
             RowBox[{"\"\<out(2)\>\"", "->", "\"\<g[0][2]\>\""}], ",", 
             RowBox[{"\"\<out(3)\>\"", "->", "\"\<g[0][3]\>\""}], ",", 
             RowBox[{"\"\<out(4)\>\"", "->", "\"\<g[1][0]\>\""}], ",", 
             RowBox[{"\"\<out(5)\>\"", "->", "\"\<g[1][1]\>\""}], ",", 
             RowBox[{"\"\<out(6)\>\"", "->", "\"\<g[1][2]\>\""}], ",", 
             RowBox[{"\"\<out(7)\>\"", "->", "\"\<g[1][3]\>\""}], ",", 
             RowBox[{"\"\<out(8)\>\"", "->", "\"\<g[2][0]\>\""}], ",", 
             RowBox[{"\"\<out(9)\>\"", "->", "\"\<g[2][1]\>\""}], ",", 
             RowBox[{"\"\<out(10)\>\"", "->", "\"\<g[2][2]\>\""}], ",", 
             RowBox[{"\"\<out(11)\>\"", "->", "\"\<g[2][3]\>\""}], ",", 
             RowBox[{"\"\<out(12)\>\"", "->", "\"\<g[3][0]\>\""}], ",", 
             RowBox[{"\"\<out(13)\>\"", "->", "\"\<g[3][1]\>\""}], ",", 
             RowBox[{"\"\<out(14)\>\"", "->", "\"\<g[3][2]\>\""}], ",", 
             RowBox[{"\"\<out(15)\>\"", "->", "\"\<g[3][3]\>\""}]}], "}"}]}], 
          "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
      "header", 
       "=", "\"\<void metric(double r, double chi, double \
g[4][4])\\n{\\n\>\""}], ";", "\[IndentingNewLine]", 
      RowBox[{"footer", "=", "\"\<\\n}\>\""}], ";", "\[IndentingNewLine]", 
      RowBox[{"output", "=", 
       RowBox[{"header", "<>", "meat", "<>", "footer"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{"filename", ",", "output", ",", "\"\<Text\>\""}], "]"}]}]}], 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"outputChristoffel", "[", 
    RowBox[{"matrix_", ",", 
     RowBox[{"filename_", ":", "\"\<christoffel.cpp\>\""}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "text", ",", "meat", ",", "header", ",", "footer", ",", "output"}], 
      "}"}], ",", 
     RowBox[{
      RowBox[{"text", "=", 
       RowBox[{"OptimizeExpressionToC", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "4", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", 
           RowBox[{"[", "4", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", 
            RowBox[{"[", "3", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", 
            RowBox[{"[", "3", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", 
            RowBox[{"[", "3", "]"}], "]"}], "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", 
            RowBox[{"[", "3", "]"}], "]"}], "[", 
           RowBox[{"[", "4", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", 
            RowBox[{"[", "4", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", 
            RowBox[{"[", "4", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", 
            RowBox[{"[", "4", "]"}], "]"}], "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", 
            RowBox[{"[", "4", "]"}], "]"}], "[", 
           RowBox[{"[", "4", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "4", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", 
           RowBox[{"[", "4", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "[", 
            RowBox[{"[", "3", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "[", 
            RowBox[{"[", "3", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "[", 
            RowBox[{"[", "3", "]"}], "]"}], "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "[", 
            RowBox[{"[", "3", "]"}], "]"}], "[", 
           RowBox[{"[", "4", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "[", 
            RowBox[{"[", "4", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "[", 
            RowBox[{"[", "4", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "[", 
            RowBox[{"[", "4", "]"}], "]"}], "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "[", 
            RowBox[{"[", "4", "]"}], "]"}], "[", 
           RowBox[{"[", "4", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "4", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", 
           RowBox[{"[", "4", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "[", 
            RowBox[{"[", "3", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "[", 
            RowBox[{"[", "3", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "[", 
            RowBox[{"[", "3", "]"}], "]"}], "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "[", 
            RowBox[{"[", "3", "]"}], "]"}], "[", 
           RowBox[{"[", "4", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "[", 
            RowBox[{"[", "4", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "[", 
            RowBox[{"[", "4", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "[", 
            RowBox[{"[", "4", "]"}], "]"}], "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "[", 
            RowBox[{"[", "4", "]"}], "]"}], "[", 
           RowBox[{"[", "4", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "4", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "4", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "4", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "4", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "4", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "4", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "4", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "4", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "4", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", 
           RowBox[{"[", "4", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "4", "]"}], "]"}], "[", 
            RowBox[{"[", "3", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "4", "]"}], "]"}], "[", 
            RowBox[{"[", "3", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "4", "]"}], "]"}], "[", 
            RowBox[{"[", "3", "]"}], "]"}], "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "4", "]"}], "]"}], "[", 
            RowBox[{"[", "3", "]"}], "]"}], "[", 
           RowBox[{"[", "4", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "4", "]"}], "]"}], "[", 
            RowBox[{"[", "4", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "4", "]"}], "]"}], "[", 
            RowBox[{"[", "4", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "4", "]"}], "]"}], "[", 
            RowBox[{"[", "4", "]"}], "]"}], "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "4", "]"}], "]"}], "[", 
            RowBox[{"[", "4", "]"}], "]"}], "[", 
           RowBox[{"[", "4", "]"}], "]"}]}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"meat", "=", 
       RowBox[{"ToString", "[", 
        RowBox[{"Column", "[", 
         RowBox[{"StringReplace", "[", 
          RowBox[{"text", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\"\<Sqrt\>\"", "->", "\"\<sqrt\>\""}], ",", 
             RowBox[{"\"\<Power(E,\>\"", "->", "\"\<exp(\>\""}], ",", 
             RowBox[{"\"\<Power\>\"", "->", "\"\<pow\>\""}], ",", 
             RowBox[{"\"\<Sin\>\"", "->", "\"\<sin\>\""}], ",", 
             RowBox[{"\"\<Cos\>\"", "->", "\"\<cos\>\""}], ",", 
             RowBox[{"\"\<Csc\>\"", "->", "\"\<1/sin\>\""}], ",", 
             RowBox[{"\"\<Cot\>\"", "->", "\"\<1/tan\>\""}], ",", 
             RowBox[{"\"\<double\>\"", "->", "\"\<double\>\""}], ",", 
             RowBox[{"\"\<;,\>\"", "->", "\"\<;\\n    \>\""}], ",", 
             RowBox[{"\"\<out(0)\>\"", "->", "\"\<christ[0][0][0]\>\""}], ",", 
             RowBox[{"\"\<out(1)\>\"", "->", "\"\<christ[0][0][1]\>\""}], ",", 
             RowBox[{"\"\<out(2)\>\"", "->", "\"\<christ[0][0][2]\>\""}], ",", 
             RowBox[{"\"\<out(3)\>\"", "->", "\"\<christ[0][0][3]\>\""}], ",", 
             RowBox[{"\"\<out(4)\>\"", "->", "\"\<christ[0][1][0]\>\""}], ",", 
             RowBox[{"\"\<out(5)\>\"", "->", "\"\<christ[0][1][1]\>\""}], ",", 
             RowBox[{"\"\<out(6)\>\"", "->", "\"\<christ[0][1][2]\>\""}], ",", 
             RowBox[{"\"\<out(7)\>\"", "->", "\"\<christ[0][1][3]\>\""}], ",", 
             RowBox[{"\"\<out(8)\>\"", "->", "\"\<christ[0][2][0]\>\""}], ",", 
             RowBox[{"\"\<out(9)\>\"", "->", "\"\<christ[0][2][1]\>\""}], ",",
              
             RowBox[{"\"\<out(10)\>\"", "->", "\"\<christ[0][2][2]\>\""}], ",", 
             RowBox[{"\"\<out(11)\>\"", "->", "\"\<christ[0][2][3]\>\""}], ",", 
             RowBox[{"\"\<out(12)\>\"", "->", "\"\<christ[0][3][0]\>\""}], ",", 
             RowBox[{"\"\<out(13)\>\"", "->", "\"\<christ[0][3][1]\>\""}], ",", 
             RowBox[{"\"\<out(14)\>\"", "->", "\"\<christ[0][3][2]\>\""}], ",", 
             RowBox[{"\"\<out(15)\>\"", "->", "\"\<christ[0][3][3]\>\""}], ",", 
             RowBox[{"\"\<out(16)\>\"", "->", "\"\<christ[1][0][0]\>\""}], ",", 
             RowBox[{"\"\<out(17)\>\"", "->", "\"\<christ[1][0][1]\>\""}], ",", 
             RowBox[{"\"\<out(18)\>\"", "->", "\"\<christ[1][0][2]\>\""}], ",", 
             RowBox[{"\"\<out(19)\>\"", "->", "\"\<christ[1][0][3]\>\""}], ",", 
             RowBox[{"\"\<out(20)\>\"", "->", "\"\<christ[1][1][0]\>\""}], ",", 
             RowBox[{"\"\<out(21)\>\"", "->", "\"\<christ[1][1][1]\>\""}], ",", 
             RowBox[{"\"\<out(22)\>\"", "->", "\"\<christ[1][1][2]\>\""}], ",", 
             RowBox[{"\"\<out(23)\>\"", "->", "\"\<christ[1][1][3]\>\""}], ",", 
             RowBox[{"\"\<out(24)\>\"", "->", "\"\<christ[1][2][0]\>\""}], ",", 
             RowBox[{"\"\<out(25)\>\"", "->", "\"\<christ[1][2][1]\>\""}], ",", 
             RowBox[{"\"\<out(26)\>\"", "->", "\"\<christ[1][2][2]\>\""}], ",", 
             RowBox[{"\"\<out(27)\>\"", "->", "\"\<christ[1][2][3]\>\""}], ",", 
             RowBox[{"\"\<out(28)\>\"", "->", "\"\<christ[1][3][0]\>\""}], ",", 
             RowBox[{"\"\<out(29)\>\"", "->", "\"\<christ[1][3][1]\>\""}], ",", 
             RowBox[{"\"\<out(30)\>\"", "->", "\"\<christ[1][3][2]\>\""}], ",", 
             RowBox[{"\"\<out(31)\>\"", "->", "\"\<christ[1][3][3]\>\""}], ",", 
             RowBox[{"\"\<out(32)\>\"", "->", "\"\<christ[2][0][0]\>\""}], ",", 
             RowBox[{"\"\<out(33)\>\"", "->", "\"\<christ[2][0][1]\>\""}], ",", 
             RowBox[{"\"\<out(34)\>\"", "->", "\"\<christ[2][0][2]\>\""}], ",", 
             RowBox[{"\"\<out(35)\>\"", "->", "\"\<christ[2][0][3]\>\""}], ",", 
             RowBox[{"\"\<out(36)\>\"", "->", "\"\<christ[2][1][0]\>\""}], ",", 
             RowBox[{"\"\<out(37)\>\"", "->", "\"\<christ[2][1][1]\>\""}], ",", 
             RowBox[{"\"\<out(38)\>\"", "->", "\"\<christ[2][1][2]\>\""}], ",", 
             RowBox[{"\"\<out(39)\>\"", "->", "\"\<christ[2][1][3]\>\""}], ",", 
             RowBox[{"\"\<out(40)\>\"", "->", "\"\<christ[2][2][0]\>\""}], ",", 
             RowBox[{"\"\<out(41)\>\"", "->", "\"\<christ[2][2][1]\>\""}], ",", 
             RowBox[{"\"\<out(42)\>\"", "->", "\"\<christ[2][2][2]\>\""}], ",", 
             RowBox[{"\"\<out(43)\>\"", "->", "\"\<christ[2][2][3]\>\""}], ",", 
             RowBox[{"\"\<out(44)\>\"", "->", "\"\<christ[2][3][0]\>\""}], ",", 
             RowBox[{"\"\<out(45)\>\"", "->", "\"\<christ[2][3][1]\>\""}], ",", 
             RowBox[{"\"\<out(46)\>\"", "->", "\"\<christ[2][3][2]\>\""}], ",", 
             RowBox[{"\"\<out(47)\>\"", "->", "\"\<christ[2][3][3]\>\""}], ",", 
             RowBox[{"\"\<out(48)\>\"", "->", "\"\<christ[3][0][0]\>\""}], ",", 
             RowBox[{"\"\<out(49)\>\"", "->", "\"\<christ[3][0][1]\>\""}], ",", 
             RowBox[{"\"\<out(50)\>\"", "->", "\"\<christ[3][0][2]\>\""}], ",", 
             RowBox[{"\"\<out(51)\>\"", "->", "\"\<christ[3][0][3]\>\""}], ",", 
             RowBox[{"\"\<out(52)\>\"", "->", "\"\<christ[3][1][0]\>\""}], ",", 
             RowBox[{"\"\<out(53)\>\"", "->", "\"\<christ[3][1][1]\>\""}], ",", 
             RowBox[{"\"\<out(54)\>\"", "->", "\"\<christ[3][1][2]\>\""}], ",", 
             RowBox[{"\"\<out(55)\>\"", "->", "\"\<christ[3][1][3]\>\""}], ",", 
             RowBox[{"\"\<out(56)\>\"", "->", "\"\<christ[3][2][0]\>\""}], ",", 
             RowBox[{"\"\<out(57)\>\"", "->", "\"\<christ[3][2][1]\>\""}], ",", 
             RowBox[{"\"\<out(58)\>\"", "->", "\"\<christ[3][2][2]\>\""}], ",", 
             RowBox[{"\"\<out(59)\>\"", "->", "\"\<christ[3][2][3]\>\""}], ",", 
             RowBox[{"\"\<out(60)\>\"", "->", "\"\<christ[3][3][0]\>\""}], ",", 
             RowBox[{"\"\<out(61)\>\"", "->", "\"\<christ[3][3][1]\>\""}], ",", 
             RowBox[{"\"\<out(62)\>\"", "->", "\"\<christ[3][3][2]\>\""}], ",", 
             RowBox[{"\"\<out(63)\>\"", "->", "\"\<christ[3][3][3]\>\""}]}], 
            "}"}]}], "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
      "header", 
       "=", "\"\<void christoffel(double r, double chi, double \
christ[4][4][4])\\n{\\n\>\""}], ";", "\[IndentingNewLine]", 
      RowBox[{"footer", "=", "\"\<\\n}\>\""}], ";", "\[IndentingNewLine]", 
      RowBox[{"output", "=", 
       RowBox[{"header", "<>", "meat", "<>", "footer"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{"filename", ",", "output", ",", "\"\<Text\>\""}], "]"}]}]}], 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"outputTidal", "[", 
   RowBox[{"matrix_", ",", 
    RowBox[{"filename_", ":", "\"\<Cloc.cpp\>\""}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "text", ",", "meat", ",", "header", ",", "footer", ",", "output"}], 
     "}"}], ",", 
    RowBox[{
     RowBox[{"text", "=", 
      RowBox[{"OptimizeExpressionToC", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"matrix", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"matrix", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"matrix", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"matrix", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", "4", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"matrix", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"matrix", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"matrix", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"matrix", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "[", 
          RowBox[{"[", "4", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"matrix", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"matrix", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"matrix", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"matrix", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "[", 
          RowBox[{"[", "4", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"matrix", "[", 
           RowBox[{"[", "4", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"matrix", "[", 
           RowBox[{"[", "4", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"matrix", "[", 
           RowBox[{"[", "4", "]"}], "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"matrix", "[", 
           RowBox[{"[", "4", "]"}], "]"}], "[", 
          RowBox[{"[", "4", "]"}], "]"}]}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"meat", "=", 
      RowBox[{"ToString", "[", 
       RowBox[{"Column", "[", 
        RowBox[{"StringReplace", "[", 
         RowBox[{"text", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\"\<Sqrt\>\"", "->", "\"\<sqrt\>\""}], ",", 
            RowBox[{"\"\<Power(E,\>\"", "->", "\"\<exp(\>\""}], ",", 
            RowBox[{"\"\<Power\>\"", "->", "\"\<pow\>\""}], ",", 
            RowBox[{"\"\<Abs\>\"", "->", "\"\<abs\>\""}], ",", 
            RowBox[{"\"\<Sin\>\"", "->", "\"\<sin\>\""}], ",", 
            RowBox[{"\"\<Cos\>\"", "->", "\"\<cos\>\""}], ",", 
            RowBox[{"\"\<Csc\>\"", "->", "\"\<1/sin\>\""}], ",", 
            RowBox[{"\"\<Cot\>\"", "->", "\"\<1/tan\>\""}], ",", 
            RowBox[{"\"\<;,\>\"", "->", "\"\<;\\n    \>\""}], ",", 
            RowBox[{"\"\<double\>\"", "->", "\"\<complex<double>\>\""}], ",", 
            
            RowBox[{"\"\<out(0)\>\"", "->", "\"\<C[0][0]\>\""}], ",", 
            RowBox[{"\"\<out(1)\>\"", "->", "\"\<C[0][1]\>\""}], ",", 
            RowBox[{"\"\<out(2)\>\"", "->", "\"\<C[0][2]\>\""}], ",", 
            RowBox[{"\"\<out(3)\>\"", "->", "\"\<C[0][3]\>\""}], ",", 
            RowBox[{"\"\<out(4)\>\"", "->", "\"\<C[1][0]\>\""}], ",", 
            RowBox[{"\"\<out(5)\>\"", "->", "\"\<C[1][1]\>\""}], ",", 
            RowBox[{"\"\<out(6)\>\"", "->", "\"\<C[1][2]\>\""}], ",", 
            RowBox[{"\"\<out(7)\>\"", "->", "\"\<C[1][3]\>\""}], ",", 
            RowBox[{"\"\<out(8)\>\"", "->", "\"\<C[2][0]\>\""}], ",", 
            RowBox[{"\"\<out(9)\>\"", "->", "\"\<C[2][1]\>\""}], ",", 
            RowBox[{"\"\<out(10)\>\"", "->", "\"\<C[2][2]\>\""}], ",", 
            RowBox[{"\"\<out(11)\>\"", "->", "\"\<C[2][3]\>\""}], ",", 
            RowBox[{"\"\<out(12)\>\"", "->", "\"\<C[3][0]\>\""}], ",", 
            RowBox[{"\"\<out(13)\>\"", "->", "\"\<C[3][1]\>\""}], ",", 
            RowBox[{"\"\<out(14)\>\"", "->", "\"\<C[3][2]\>\""}], ",", 
            RowBox[{"\"\<out(15)\>\"", "->", "\"\<C[3][3]\>\""}]}], "}"}]}], 
         "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
     "header", 
      "=", "\"\<void ClocH(complex<double> r, complex<double> theta, \
complex<double> dt, complex<double> dr, complex<double> dtheta, \
complex<double> dphi, complex<double> C[4][4])\\n{\\n\>\""}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"footer", "=", "\"\<\\n}\>\""}], ";", "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"header", "<>", "meat", "<>", "footer"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{"filename", ",", "output", ",", "\"\<Text\>\""}], "]"}]}]}], 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.934869974432248*^9, 3.934870117393032*^9}, {
   3.934870153965412*^9, 3.934870208815731*^9}, {3.934870340045987*^9, 
   3.934870355954009*^9}, {3.934870428919546*^9, 3.934870444496529*^9}, {
   3.934978673074291*^9, 3.934978704115281*^9}, {3.935056641516304*^9, 
   3.935056670590549*^9}, 3.935056922765959*^9, {3.935057012829417*^9, 
   3.935057013270317*^9}, 3.935057044174729*^9, {3.935057173539551*^9, 
   3.935057177828099*^9}, 3.935057229696449*^9, 3.935057373313364*^9, {
   3.935065402986771*^9, 3.935065411323144*^9}, {3.935065910064347*^9, 
   3.935065914760546*^9}, 3.936767364096298*^9},
 CellLabel->
  "In[67]:=",ExpressionUUID->"29641491-fd16-4695-b0a2-9de0b589632a"]
}, Closed]],

Cell[CellGroupData[{

Cell["Functions for solving IBSO radii", "Subsection",
 CellChangeTimes->{{3.935055016277986*^9, 
  3.9350550534232197`*^9}},ExpressionUUID->"7a59d467-6954-4c48-aa92-\
e192b76561a5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Ralt", "[", 
     RowBox[{
     "r_", ",", "ep_", ",", "lz_", ",", "a_", ",", "Q_", ",", "e_", ",", "m_",
       ",", "Lambda_"}], "]"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"ep", "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"r", "^", "2"}], "+", 
           RowBox[{"a", "^", "2"}]}], ")"}]}], "-", 
        RowBox[{"a", "*", "lz"}], "-", 
        RowBox[{"e", "*", "Q", "*", "r"}]}], ")"}], "^", "2"}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"r", "^", "2"}], "-", 
        RowBox[{"2", "*", "r"}], "+", 
        RowBox[{"a", "^", "2"}], "+", 
        RowBox[{"Q", "^", "2"}]}], ")"}], "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"m", "^", "2"}], "*", 
         RowBox[{"r", "^", "2"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"a", "*", "ep"}], "-", "lz"}], ")"}], "^", "2"}], "+", 
        RowBox[{
         RowBox[{"lz", "^", "2"}], "*", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Lambda", "^", "2"}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"Lambda", "^", "2"}]}], ")"}]}]}]}], ")"}]}]}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"dRaltdr", "[", 
     RowBox[{
     "r_", ",", "ep_", ",", "lz_", ",", "a_", ",", "Q_", ",", "e_", ",", "m_",
       ",", "Lambda_"}], "]"}], "=", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"Ralt", "[", 
       RowBox[{
       "r", ",", "ep", ",", "lz", ",", "a", ",", "Q", ",", "e", ",", "m", ",",
         "Lambda"}], "]"}], ",", "r"}], "]"}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"dRaltdr2", "[", 
     RowBox[{
     "r_", ",", "ep_", ",", "lz_", ",", "a_", ",", "Q_", ",", "e_", ",", "m_",
       ",", "Lambda_"}], "]"}], "=", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"dRaltdr", "[", 
       RowBox[{
       "r", ",", "ep", ",", "lz", ",", "a", ",", "Q", ",", "e", ",", "m", ",",
         "Lambda"}], "]"}], ",", "r"}], "]"}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"solplus", "[", 
     RowBox[{"var1_", ",", "var2_", ",", "var3_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"spin", "=", "var1"}], ",", 
        RowBox[{"charge", "=", "var2"}], ",", 
        RowBox[{"lam", "=", "var3"}], ",", "out"}], "}"}], ",", 
      RowBox[{
       RowBox[{"out", "=", 
        RowBox[{
         RowBox[{"NSolve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Ralt", "[", 
              RowBox[{
              "rsol", ",", "1", ",", "lzsol", ",", "var1", ",", "var2", ",", 
               "0", ",", "1", ",", "var3"}], "]"}], "==", "0"}], "&&", 
            RowBox[{
             RowBox[{"dRaltdr", "[", 
              RowBox[{
              "rsol", ",", "1", ",", "lzsol", ",", "var1", ",", "var2", ",", 
               "0", ",", "1", ",", "var3"}], "]"}], "==", "0"}], "&&", 
            RowBox[{"rsol", ">", "0"}], "&&", 
            RowBox[{"lzsol", ">", "0"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"rsol", ",", "lzsol"}], "}"}], ",", "Reals", ",", 
           RowBox[{"WorkingPrecision", "->", "16"}]}], "]"}], "/.", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "}"}], "->", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"rsol", "->", "0"}], ",", 
             RowBox[{"lzsol", "->", "0"}]}], "}"}]}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", "out"}]}], "]"}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"solminus", "[", 
     RowBox[{"var1_", ",", "var2_", ",", "var3_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"spin", "=", "var1"}], ",", 
        RowBox[{"charge", "=", "var2"}], ",", 
        RowBox[{"lam", "=", "var3"}], ",", "out"}], "}"}], ",", 
      RowBox[{
       RowBox[{"out", "=", 
        RowBox[{
         RowBox[{"NSolve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Ralt", "[", 
              RowBox[{
              "rsol", ",", "1", ",", "lzsol", ",", "var1", ",", "var2", ",", 
               "0", ",", "1", ",", "var3"}], "]"}], "==", "0"}], "&&", 
            RowBox[{
             RowBox[{"dRaltdr", "[", 
              RowBox[{
              "rsol", ",", "1", ",", "lzsol", ",", "var1", ",", "var2", ",", 
               "0", ",", "1", ",", "var3"}], "]"}], "==", "0"}], "&&", 
            RowBox[{"rsol", ">", "0"}], "&&", 
            RowBox[{"lzsol", "<", "0"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"rsol", ",", "lzsol"}], "}"}], ",", "Reals", ",", 
           RowBox[{"WorkingPrecision", "->", "16"}]}], "]"}], "/.", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "}"}], "->", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"rsol", "->", "0"}], ",", 
             RowBox[{"lzsol", "->", "0"}]}], "}"}]}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", "out"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"momentum", "[", 
     RowBox[{"r_", ",", "a_", ",", "Q_"}], "]"}], "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"a", "^", "2"}]}], "+", 
       RowBox[{"r", "*", 
        RowBox[{"(", 
         RowBox[{"r", "-", 
          RowBox[{"Q", "^", "2"}]}], ")"}]}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"r", "^", "2"}], "-", 
          RowBox[{"2", "*", "r"}], "+", 
          RowBox[{"a", "^", "2"}], "+", 
          RowBox[{"Q", "^", "2"}]}], ")"}], "*", 
        RowBox[{"Sqrt", "[", "r", "]"}]}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"a", "*", 
       RowBox[{"(", 
        RowBox[{"r", "-", "1"}], ")"}]}], ")"}]}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"carterk", "[", 
     RowBox[{"r_", ",", "a_", ",", "Q_"}], "]"}], "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"r", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"a", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "3"}], " ", "+", " ", "r"}], ")"}], "*", "r"}], " ", 
         "+", " ", 
         RowBox[{
          RowBox[{"a", "^", "3"}], "*", 
          RowBox[{"(", 
           RowBox[{"1", " ", "+", " ", "r"}], ")"}]}], " ", "+", " ", 
         RowBox[{"a", "*", 
          RowBox[{"Q", "^", "2"}], "*", 
          RowBox[{"(", 
           RowBox[{"1", " ", "+", " ", "r"}], ")"}]}], " ", "+", " ", 
         RowBox[{"2", "*", 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            RowBox[{"a", "^", "2"}], "*", "r", "*", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"a", "^", "2"}], " ", "+", " ", 
               RowBox[{"Q", "^", "2"}], " ", "+", " ", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "2"}], " ", "+", " ", "r"}], ")"}], "*", 
                "r"}]}], ")"}], "^", "2"}]}], "]"}]}]}], ")"}]}], ")"}], "/", 
     
     RowBox[{"(", 
      RowBox[{"a", "*", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], " ", "+", " ", "r"}], ")"}], "^", "2"}]}], 
      ")"}]}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"carterq", "[", 
    RowBox[{"r_", ",", "a_", ",", "Q_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"carterk", "[", 
     RowBox[{"r", ",", "a", ",", "Q"}], "]"}], "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"momentum", "[", 
        RowBox[{"r", ",", "a", ",", "Q"}], "]"}], "-", "a"}], ")"}], "^", 
     "2"}]}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9344847378635025`*^9, 3.934484751366549*^9}, 
   3.935051829537908*^9, {3.935051860010437*^9, 3.9350519122344627`*^9}, 
   3.935052189118833*^9, 3.935052242770153*^9, 3.935052717342176*^9, {
   3.9350527623910217`*^9, 3.935052770221189*^9}, 3.9350528129648523`*^9, {
   3.935085850647981*^9, 3.9350858821391563`*^9}, {3.935087376567683*^9, 
   3.9350873797774105`*^9}, {3.935087434789034*^9, 3.935087552151163*^9}, {
   3.935087623573366*^9, 3.935087625497801*^9}, {3.935087831104906*^9, 
   3.935087838302534*^9}, 3.9350878741166935`*^9, {3.935087973098192*^9, 
   3.935087973331245*^9}, {3.935088010652687*^9, 3.935088010963759*^9}},
 CellLabel->"In[70]:=",ExpressionUUID->"7b5cbb39-9bc8-9740-88af-1d3c898d22e0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"carterq", "[", 
   RowBox[{"r", ",", "a", ",", "Q"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.935088074170103*^9, 3.935088080589596*^9}},
 CellLabel->"In[78]:=",ExpressionUUID->"58b998a6-e969-e743-8963-d8c277bce876"],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{
   FractionBox["1", 
    RowBox[{
     SuperscriptBox["a", "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "r"}], ")"}], "2"]}]], 
   RowBox[{"r", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", 
       SuperscriptBox["a", "4"], " ", 
       SqrtBox["r"]}], "-", 
      RowBox[{"2", " ", "a", " ", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["a", "2"], " ", "r", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["a", "2"], "+", 
            SuperscriptBox["Q", "2"], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "2"}], "+", "r"}], ")"}], " ", "r"}]}], ")"}], 
          "2"]}]]}], "+", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SqrtBox["r"]}], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["Q", "2"], "-", 
          RowBox[{"2", " ", "r"}], "+", 
          SuperscriptBox["r", 
           RowBox[{"3", "/", "2"}]]}], ")"}], "2"]}], "+", 
      RowBox[{
       SuperscriptBox["a", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["Q", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"4", " ", 
             SqrtBox["r"]}], "+", "r"}], ")"}]}], "+", 
         RowBox[{"r", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "-", 
            RowBox[{"6", " ", 
             SqrtBox["r"]}], "-", "r", "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["r", 
              RowBox[{"3", "/", "2"}]]}]}], ")"}]}]}], ")"}]}]}], 
     ")"}]}]}]}]], "Output",
 CellChangeTimes->{3.935088081066704*^9, 3.93524646990815*^9, 
  3.935246987896463*^9, 3.9352574009204464`*^9, 3.935500657457992*^9, 
  3.935582573493124*^9, 3.935750124713419*^9, 3.9367756960027323`*^9, 
  3.9405224263692837`*^9, 3.9405243249193916`*^9, 3.9405303478174686`*^9, 
  3.9519447569747562`*^9},
 CellLabel->
  "Out[78]=",ExpressionUUID->"eba73a7d-67e5-854a-8a34-ea580bf717c3"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Modules for constructing tensors", "Subsection",
 CellChangeTimes->{{3.935055039191413*^9, 
  3.9350550596537743`*^9}},ExpressionUUID->"17f84823-11f9-46f5-87d2-\
1880f8fd34f6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"getR", "[", 
    RowBox[{"a0_", ",", "b0_", ",", "c0_", ",", "d0_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"i0", "=", "0"}], ",", 
       RowBox[{"j0", "=", "0"}], ",", 
       RowBox[{"k0", "=", "0"}], ",", 
       RowBox[{"l0", "=", "0"}], ",", 
       RowBox[{"component", "=", "0"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i0", "=", "1"}], ",", 
        RowBox[{"i0", "<=", "4"}], ",", 
        RowBox[{"i0", "++"}], ",", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"j0", "=", "1"}], ",", 
          RowBox[{"j0", "<=", "4"}], ",", 
          RowBox[{"j0", "++"}], ",", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"k0", "=", "1"}], ",", 
            RowBox[{"k0", "<=", "4"}], ",", 
            RowBox[{"k0", "++"}], ",", 
            RowBox[{"For", "[", 
             RowBox[{
              RowBox[{"l0", "=", "1"}], ",", 
              RowBox[{"l0", "<=", "4"}], ",", 
              RowBox[{"l0", "++"}], ",", 
              RowBox[{
               RowBox[{"component", "+=", 
                RowBox[{
                 RowBox[{"Part", "[", 
                  RowBox[{
                  "Robs", ",", "i0", ",", "j0", ",", "k0", ",", "l0"}], "]"}],
                  "*", 
                 RowBox[{"Part", "[", 
                  RowBox[{"matdown", ",", "a0", ",", "i0"}], "]"}], "*", 
                 RowBox[{"Part", "[", 
                  RowBox[{"matdown", ",", "b0", ",", "j0"}], "]"}], "*", 
                 RowBox[{"Part", "[", 
                  RowBox[{"matdown", ",", "c0", ",", "k0"}], "]"}], "*", 
                 RowBox[{"Part", "[", 
                  RowBox[{"matdown", ",", "d0", ",", "l0"}], "]"}]}]}], 
               ";"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "component"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"getRH", "[", 
    RowBox[{"a0_", ",", "b0_", ",", "c0_", ",", "d0_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"i0", "=", "0"}], ",", 
       RowBox[{"j0", "=", "0"}], ",", 
       RowBox[{"k0", "=", "0"}], ",", 
       RowBox[{"l0", "=", "0"}], ",", 
       RowBox[{"component", "=", "0"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i0", "=", "1"}], ",", 
        RowBox[{"i0", "<=", "4"}], ",", 
        RowBox[{"i0", "++"}], ",", 
        RowBox[{
         RowBox[{"component", "+=", 
          RowBox[{
           RowBox[{"Part", "[", 
            RowBox[{"Rlnrf", ",", "i0", ",", "b0", ",", "c0", ",", "d0"}], 
            "]"}], "*", 
           RowBox[{"Part", "[", 
            RowBox[{"eta", ",", "a0", ",", "i0"}], "]"}]}]}], ";"}]}], "]"}], 
      ";", "\[IndentingNewLine]", "component"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"getRIC", "[", 
    RowBox[{"a0_", ",", "b0_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"i0", "=", "0"}], ",", 
       RowBox[{"j0", "=", "0"}], ",", 
       RowBox[{"k0", "=", "0"}], ",", 
       RowBox[{"l0", "=", "0"}], ",", 
       RowBox[{"component", "=", "0"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i0", "=", "1"}], ",", 
        RowBox[{"i0", "<=", "4"}], ",", 
        RowBox[{"i0", "++"}], ",", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"j0", "=", "1"}], ",", 
          RowBox[{"j0", "<=", "4"}], ",", 
          RowBox[{"j0", "++"}], ",", 
          RowBox[{
           RowBox[{"component", "+=", 
            RowBox[{
             RowBox[{"Part", "[", 
              RowBox[{"eta", ",", "i0", ",", "j0"}], "]"}], "*", 
             RowBox[{"Part", "[", 
              RowBox[{"Rlnrf", ",", "i0", ",", "a0", ",", "j0", ",", "b0"}], 
              "]"}]}]}], ";"}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      "component"}]}], "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getRlocH", "[", 
    RowBox[{"a0_", ",", "b0_", ",", "c0_", ",", "d0_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"i0", "=", "0"}], ",", 
       RowBox[{"j0", "=", "0"}], ",", 
       RowBox[{"k0", "=", "0"}], ",", 
       RowBox[{"l0", "=", "0"}], ",", 
       RowBox[{"component", "=", "0"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i0", "=", "1"}], ",", 
        RowBox[{"i0", "<=", "4"}], ",", 
        RowBox[{"i0", "++"}], ",", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"j0", "=", "1"}], ",", 
          RowBox[{"j0", "<=", "4"}], ",", 
          RowBox[{"j0", "++"}], ",", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"k0", "=", "1"}], ",", 
            RowBox[{"k0", "<=", "4"}], ",", 
            RowBox[{"k0", "++"}], ",", 
            RowBox[{"For", "[", 
             RowBox[{
              RowBox[{"l0", "=", "1"}], ",", 
              RowBox[{"l0", "<=", "4"}], ",", 
              RowBox[{"l0", "++"}], ",", 
              RowBox[{
               RowBox[{"component", "+=", 
                RowBox[{
                 RowBox[{"Part", "[", 
                  RowBox[{
                  "RlnrfH", ",", "i0", ",", "j0", ",", "k0", ",", "l0"}], 
                  "]"}], "*", 
                 RowBox[{"Part", "[", 
                  RowBox[{"lorentz", ",", "a0", ",", "i0"}], "]"}], "*", 
                 RowBox[{"Part", "[", 
                  RowBox[{"lorentzinv", ",", "j0", ",", "b0"}], "]"}], "*", 
                 RowBox[{"Part", "[", 
                  RowBox[{"lorentzinv", ",", "k0", ",", "c0"}], "]"}], "*", 
                 RowBox[{"Part", "[", 
                  RowBox[{"lorentzinv", ",", "l0", ",", "d0"}], "]"}]}]}], 
               ";"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "component"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"getC", "[", 
    RowBox[{"a0_", ",", "b0_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"i0", "=", "0"}], ",", 
       RowBox[{"j0", "=", "0"}], ",", 
       RowBox[{"k0", "=", "0"}], ",", 
       RowBox[{"l0", "=", "0"}], ",", 
       RowBox[{"component", "=", "0"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i0", "=", "1"}], ",", 
        RowBox[{"i0", "<=", "4"}], ",", 
        RowBox[{"i0", "++"}], ",", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"j0", "=", "1"}], ",", 
          RowBox[{"j0", "<=", "4"}], ",", 
          RowBox[{"j0", "++"}], ",", 
          RowBox[{
           RowBox[{"component", "-=", 
            RowBox[{
             RowBox[{"Part", "[", 
              RowBox[{"Rlnrf", ",", "a0", ",", "i0", ",", "b0", ",", "j0"}], 
              "]"}], "*", 
             RowBox[{"Part", "[", 
              RowBox[{"Ulnrf", ",", "i0"}], "]"}], "*", 
             RowBox[{"Part", "[", 
              RowBox[{"Ulnrf", ",", "j0"}], "]"}]}]}], ";"}]}], "]"}]}], 
       "]"}], ";", "\[IndentingNewLine]", "component"}]}], "]"}]}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getCH", "[", 
    RowBox[{"a0_", ",", "b0_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"i0", "=", "0"}], ",", 
       RowBox[{"j0", "=", "0"}], ",", 
       RowBox[{"k0", "=", "0"}], ",", 
       RowBox[{"l0", "=", "0"}], ",", 
       RowBox[{"component", "=", "0"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i0", "=", "1"}], ",", 
        RowBox[{"i0", "<=", "4"}], ",", 
        RowBox[{"i0", "++"}], ",", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"j0", "=", "1"}], ",", 
          RowBox[{"j0", "<=", "4"}], ",", 
          RowBox[{"j0", "++"}], ",", 
          RowBox[{
           RowBox[{"component", "-=", 
            RowBox[{
             RowBox[{"Part", "[", 
              RowBox[{"RlnrfH", ",", "a0", ",", "i0", ",", "b0", ",", "j0"}], 
              "]"}], "*", 
             RowBox[{"Part", "[", 
              RowBox[{"Ulnrf", ",", "i0"}], "]"}], "*", 
             RowBox[{"Part", "[", 
              RowBox[{"Ulnrf", ",", "j0"}], "]"}]}]}], ";"}]}], "]"}]}], 
       "]"}], ";", "\[IndentingNewLine]", "component"}]}], "]"}]}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getCobs", "[", 
    RowBox[{"a0_", ",", "b0_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"i0", "=", "0"}], ",", 
       RowBox[{"j0", "=", "0"}], ",", 
       RowBox[{"k0", "=", "0"}], ",", 
       RowBox[{"l0", "=", "0"}], ",", 
       RowBox[{"component", "=", "0"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i0", "=", "1"}], ",", 
        RowBox[{"i0", "<=", "4"}], ",", 
        RowBox[{"i0", "++"}], ",", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"j0", "=", "1"}], ",", 
          RowBox[{"j0", "<=", "4"}], ",", 
          RowBox[{"j0", "++"}], ",", 
          RowBox[{
           RowBox[{"component", "-=", 
            RowBox[{
             RowBox[{"Part", "[", 
              RowBox[{"Robs", ",", "a0", ",", "i0", ",", "b0", ",", "j0"}], 
              "]"}], "*", 
             RowBox[{"Part", "[", 
              RowBox[{"U", ",", "i0"}], "]"}], "*", 
             RowBox[{"Part", "[", 
              RowBox[{"U", ",", "j0"}], "]"}]}]}], ";"}]}], "]"}]}], "]"}], ";",
       "\[IndentingNewLine]", "component"}]}], "]"}]}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getCobsH", "[", 
    RowBox[{"a0_", ",", "b0_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"i0", "=", "0"}], ",", 
       RowBox[{"j0", "=", "0"}], ",", 
       RowBox[{"k0", "=", "0"}], ",", 
       RowBox[{"l0", "=", "0"}], ",", 
       RowBox[{"component", "=", "0"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i0", "=", "1"}], ",", 
        RowBox[{"i0", "<=", "4"}], ",", 
        RowBox[{"i0", "++"}], ",", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"j0", "=", "1"}], ",", 
          RowBox[{"j0", "<=", "4"}], ",", 
          RowBox[{"j0", "++"}], ",", 
          RowBox[{
           RowBox[{"component", "-=", 
            RowBox[{
             RowBox[{"Part", "[", 
              RowBox[{"RobsH", ",", "a0", ",", "i0", ",", "b0", ",", "j0"}], 
              "]"}], "*", 
             RowBox[{"Part", "[", 
              RowBox[{"U", ",", "i0"}], "]"}], "*", 
             RowBox[{"Part", "[", 
              RowBox[{"U", ",", "j0"}], "]"}]}]}], ";"}]}], "]"}]}], "]"}], ";",
       "\[IndentingNewLine]", "component"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"getClocH", "[", 
    RowBox[{"mu0_", ",", "nu0_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"i0", "=", "0"}], ",", 
       RowBox[{"j0", "=", "0"}], ",", 
       RowBox[{"k0", "=", "0"}], ",", 
       RowBox[{"l0", "=", "0"}], ",", 
       RowBox[{"component", "=", "0"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i0", "=", "1"}], ",", 
        RowBox[{"i0", "<=", "4"}], ",", 
        RowBox[{"i0", "++"}], ",", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"j0", "=", "1"}], ",", 
          RowBox[{"j0", "<=", "4"}], ",", 
          RowBox[{"j0", "++"}], ",", 
          RowBox[{
           RowBox[{"component", "+=", 
            RowBox[{
             RowBox[{"Part", "[", 
              RowBox[{"ClnrfH", ",", "i0", ",", "j0"}], "]"}], "*", 
             RowBox[{"Part", "[", 
              RowBox[{"lorentz", ",", "mu0", ",", "i0"}], "]"}], "*", 
             RowBox[{"Part", "[", 
              RowBox[{"lorentzinv", ",", "j0", ",", "nu0"}], "]"}]}]}], 
           ";"}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      "component"}]}], "]"}]}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"genRlnrf", "[", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i0", ",", "j0", ",", "k0", ",", "l0", ",", "output"}], "}"}], ",", 
     RowBox[{
      RowBox[{"output", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"getR", "[", 
          RowBox[{"i0", ",", "j0", ",", "k0", ",", "l0"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i0", ",", "1", ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j0", ",", "1", ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k0", ",", "1", ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"l0", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Simplify", "[", 
       RowBox[{"output", ",", 
        RowBox[{"Assumptions", "->", "assume"}]}], "]"}]}]}], "]"}]}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"genRlnrfH", "[", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i0", ",", "j0", ",", "k0", ",", "l0", ",", "output"}], "}"}], ",", 
     RowBox[{
      RowBox[{"output", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"getRH", "[", 
          RowBox[{"i0", ",", "j0", ",", "k0", ",", "l0"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i0", ",", "1", ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j0", ",", "1", ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k0", ",", "1", ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"l0", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Simplify", "[", 
       RowBox[{"output", ",", 
        RowBox[{"Assumptions", "->", "assume"}]}], "]"}]}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"genRlocH", "[", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i0", ",", "j0", ",", "k0", ",", "l0", ",", "output"}], "}"}], ",", 
     RowBox[{
      RowBox[{"output", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"getRlocH", "[", 
          RowBox[{"i0", ",", "j0", ",", "k0", ",", "l0"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i0", ",", "1", ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j0", ",", "1", ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k0", ",", "1", ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"l0", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "output"}]}], "]"}]}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"genRIClnrf", "[", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i0", ",", "j0", ",", "output"}], "}"}], ",", 
     RowBox[{
      RowBox[{"output", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"getRIC", "[", 
          RowBox[{"i0", ",", "j0"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i0", ",", "1", ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j0", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Simplify", "[", 
       RowBox[{"output", ",", 
        RowBox[{"Assumptions", "->", "assume"}]}], "]"}]}]}], "]"}]}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"genUlnrf", "[", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i0", ",", "j0", ",", "output"}], "}"}], ",", 
     RowBox[{
      RowBox[{"output", "=", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", "4", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i0", "=", "1"}], ",", 
        RowBox[{"i0", "<=", "4"}], ",", 
        RowBox[{"i0", "++"}], ",", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"j0", "=", "1"}], ",", 
          RowBox[{"j0", "<=", "4"}], ",", 
          RowBox[{"j0", "++"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"output", "[", 
             RowBox[{"[", "i0", "]"}], "]"}], "+=", 
            RowBox[{
             RowBox[{"Part", "[", 
              RowBox[{"U", ",", "j0"}], "]"}], "*", 
             RowBox[{"Part", "[", 
              RowBox[{"matup", ",", "i0", ",", "j0"}], "]"}]}]}], ";"}]}], 
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Simplify", "[", 
       RowBox[{"output", ",", 
        RowBox[{"Assumptions", "->", "assume"}]}], "]"}]}]}], "]"}]}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"genClnrf", "[", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i0", ",", "j0", ",", "output"}], "}"}], ",", 
     RowBox[{
      RowBox[{"output", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"getC", "[", 
          RowBox[{"i0", ",", "j0"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i0", ",", "1", ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j0", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"-", "output"}]}]}], "]"}]}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"genClnrfH", "[", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i0", ",", "j0", ",", "output"}], "}"}], ",", 
     RowBox[{
      RowBox[{"output", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"getCH", "[", 
          RowBox[{"i0", ",", "j0"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i0", ",", "1", ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j0", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"-", "output"}]}]}], "]"}]}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"genCobs", "[", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i0", ",", "j0", ",", "output"}], "}"}], ",", 
     RowBox[{
      RowBox[{"output", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"getCobs", "[", 
          RowBox[{"i0", ",", "j0"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i0", ",", "1", ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j0", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"-", "output"}]}]}], "]"}]}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"genCobsH", "[", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i0", ",", "j0", ",", "output"}], "}"}], ",", 
     RowBox[{
      RowBox[{"output", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"getCobsH", "[", 
          RowBox[{"i0", ",", "j0"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i0", ",", "1", ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j0", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"-", "output"}]}]}], "]"}]}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"genClocH", "[", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i0", ",", "j0", ",", "output"}], "}"}], ",", 
     RowBox[{
      RowBox[{"output", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"getClocH", "[", 
          RowBox[{"i0", ",", "j0"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i0", ",", "1", ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j0", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "output"}]}], "]"}]}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"genLorentz", "[", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "i0", ",", "j0", ",", "output", ",", "beta", ",", "gamma", ",", "betar",
        ",", "betatheta", ",", "betaphi"}], "}"}], ",", 
     RowBox[{
      RowBox[{"beta", "=", 
       RowBox[{"Sqrt", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Part", "[", 
           RowBox[{"UlnrfN", ",", "2"}], "]"}], "^", "2"}], "+", 
         RowBox[{
          RowBox[{"Part", "[", 
           RowBox[{"UlnrfN", ",", "3"}], "]"}], "^", "2"}], "+", 
         RowBox[{
          RowBox[{"Part", "[", 
           RowBox[{"UlnrfN", ",", "4"}], "]"}], "^", "2"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gamma", "=", 
       RowBox[{"1", "/", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"1", "-", 
          RowBox[{"beta", "^", "2"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"betar", "=", 
       RowBox[{"Part", "[", 
        RowBox[{"UlnrfN", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"betatheta", "=", 
       RowBox[{"Part", "[", 
        RowBox[{"UlnrfN", ",", "3"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"betaphi", "=", 
       RowBox[{"Part", "[", 
        RowBox[{"UlnrfN", ",", "4"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"output", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"gamma", ",", 
           RowBox[{
            RowBox[{"-", "gamma"}], "*", "betar"}], ",", 
           RowBox[{
            RowBox[{"-", "gamma"}], "*", "betatheta"}], ",", 
           RowBox[{
            RowBox[{"-", "gamma"}], "*", "betaphi"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "gamma"}], "*", "betar"}], ",", 
           RowBox[{"1", "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"gamma", "-", "1"}], ")"}], "*", 
             RowBox[{
              RowBox[{"betar", "^", "2"}], "/", 
              RowBox[{"(", 
               RowBox[{"beta", "^", "2"}], ")"}]}]}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"gamma", "-", "1"}], ")"}], "*", "betar", "*", 
            RowBox[{"betatheta", "/", 
             RowBox[{"(", 
              RowBox[{"beta", "^", "2"}], ")"}]}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"gamma", "-", "1"}], ")"}], "*", "betar", "*", 
            RowBox[{"betaphi", "/", 
             RowBox[{"(", 
              RowBox[{"beta", "^", "2"}], ")"}]}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "gamma"}], "*", "betatheta"}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"gamma", "-", "1"}], ")"}], "*", "betar", "*", 
            RowBox[{"betatheta", "/", 
             RowBox[{"(", 
              RowBox[{"beta", "^", "2"}], ")"}]}]}], ",", 
           RowBox[{"1", "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"gamma", "-", "1"}], ")"}], "*", 
             RowBox[{
              RowBox[{"betatheta", "^", "2"}], "/", 
              RowBox[{"(", 
               RowBox[{"beta", "^", "2"}], ")"}]}]}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"gamma", "-", "1"}], ")"}], "*", "betatheta", "*", 
            RowBox[{"betaphi", "/", 
             RowBox[{"(", 
              RowBox[{"beta", "^", "2"}], ")"}]}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "gamma"}], "*", "betaphi"}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"gamma", "-", "1"}], ")"}], "*", "betar", "*", 
            RowBox[{"betaphi", "/", 
             RowBox[{"(", 
              RowBox[{"beta", "^", "2"}], ")"}]}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"gamma", "-", "1"}], ")"}], "*", "betatheta", "*", 
            RowBox[{"betaphi", "/", 
             RowBox[{"(", 
              RowBox[{"beta", "^", "2"}], ")"}]}]}], ",", 
           RowBox[{"1", "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"gamma", "-", "1"}], ")"}], "*", 
             RowBox[{
              RowBox[{"betaphi", "^", "2"}], "/", 
              RowBox[{"(", 
               RowBox[{"beta", "^", "2"}], ")"}]}]}]}]}], "}"}]}], "}"}]}], ";",
       "\[IndentingNewLine]", "output"}]}], "]"}]}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"genLorentzinv", "[", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "i0", ",", "j0", ",", "output", ",", "beta", ",", "gamma", ",", "betar", 
      ",", "betatheta", ",", "betaphi"}], "}"}], ",", 
    RowBox[{
     RowBox[{"beta", "=", 
      RowBox[{"Sqrt", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Part", "[", 
          RowBox[{"UlnrfN", ",", "2"}], "]"}], "^", "2"}], "+", 
        RowBox[{
         RowBox[{"Part", "[", 
          RowBox[{"UlnrfN", ",", "3"}], "]"}], "^", "2"}], "+", 
        RowBox[{
         RowBox[{"Part", "[", 
          RowBox[{"UlnrfN", ",", "4"}], "]"}], "^", "2"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"gamma", "=", 
      RowBox[{"1", "/", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"1", "-", 
         RowBox[{"beta", "^", "2"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"betar", "=", 
      RowBox[{"Part", "[", 
       RowBox[{"UlnrfN", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"betatheta", "=", 
      RowBox[{"Part", "[", 
       RowBox[{"UlnrfN", ",", "3"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"betaphi", "=", 
      RowBox[{"Part", "[", 
       RowBox[{"UlnrfN", ",", "4"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"gamma", ",", 
          RowBox[{"gamma", "*", "betar"}], ",", 
          RowBox[{"gamma", "*", "betatheta"}], ",", 
          RowBox[{"gamma", "*", "betaphi"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"gamma", "*", "betar"}], ",", 
          RowBox[{"1", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"gamma", "-", "1"}], ")"}], "*", 
            RowBox[{
             RowBox[{"betar", "^", "2"}], "/", 
             RowBox[{"(", 
              RowBox[{"beta", "^", "2"}], ")"}]}]}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"gamma", "-", "1"}], ")"}], "*", "betar", "*", 
           RowBox[{"betatheta", "/", 
            RowBox[{"(", 
             RowBox[{"beta", "^", "2"}], ")"}]}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"gamma", "-", "1"}], ")"}], "*", "betar", "*", 
           RowBox[{"betaphi", "/", 
            RowBox[{"(", 
             RowBox[{"beta", "^", "2"}], ")"}]}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"gamma", "*", "betatheta"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"gamma", "-", "1"}], ")"}], "*", "betar", "*", 
           RowBox[{"betatheta", "/", 
            RowBox[{"(", 
             RowBox[{"beta", "^", "2"}], ")"}]}]}], ",", 
          RowBox[{"1", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"gamma", "-", "1"}], ")"}], "*", 
            RowBox[{
             RowBox[{"betatheta", "^", "2"}], "/", 
             RowBox[{"(", 
              RowBox[{"beta", "^", "2"}], ")"}]}]}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"gamma", "-", "1"}], ")"}], "*", "betatheta", "*", 
           RowBox[{"betaphi", "/", 
            RowBox[{"(", 
             RowBox[{"beta", "^", "2"}], ")"}]}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"gamma", "*", "betaphi"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"gamma", "-", "1"}], ")"}], "*", "betar", "*", 
           RowBox[{"betaphi", "/", 
            RowBox[{"(", 
             RowBox[{"beta", "^", "2"}], ")"}]}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"gamma", "-", "1"}], ")"}], "*", "betatheta", "*", 
           RowBox[{"betaphi", "/", 
            RowBox[{"(", 
             RowBox[{"beta", "^", "2"}], ")"}]}]}], ",", 
          RowBox[{"1", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"gamma", "-", "1"}], ")"}], "*", 
            RowBox[{
             RowBox[{"betaphi", "^", "2"}], "/", 
             RowBox[{"(", 
              RowBox[{"beta", "^", "2"}], ")"}]}]}]}]}], "}"}]}], "}"}]}], ";",
      "\[IndentingNewLine]", "output"}]}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9338510986322403`*^9, 3.933851231350432*^9}, {
   3.933851264401556*^9, 3.933851291694806*^9}, {3.933852357893911*^9, 
   3.933852470053194*^9}, {3.933852620603965*^9, 3.933852622282379*^9}, {
   3.933918998888369*^9, 3.93391900982312*^9}, {3.933919129849835*^9, 
   3.933919194820705*^9}, 3.933919276592138*^9, {3.9339196672698603`*^9, 
   3.93391967187815*^9}, 3.933919749230995*^9, {3.9339206852422943`*^9, 
   3.933920706503937*^9}, {3.933921386163795*^9, 3.933921407644115*^9}, {
   3.933923039275528*^9, 3.933923048758379*^9}, {3.933928940911278*^9, 
   3.933928951417703*^9}, {3.93393076808773*^9, 3.933930781131068*^9}, {
   3.933931244490231*^9, 3.933931276162438*^9}, 3.933931310830996*^9, {
   3.93393135525995*^9, 3.93393144524244*^9}, 3.933931603522331*^9, {
   3.933937038227434*^9, 3.93393706237845*^9}, {3.933939334093277*^9, 
   3.933939338000237*^9}, {3.9339418166997557`*^9, 3.933941835392231*^9}, {
   3.934001923920185*^9, 3.934001927671034*^9}, 3.934002048740551*^9, {
   3.934003274589704*^9, 3.934003326101707*^9}, {3.934003691621823*^9, 
   3.934003728143428*^9}, {3.934003956037683*^9, 3.934003956531888*^9}, {
   3.934004471745371*^9, 3.934004485422675*^9}, {3.934004707352284*^9, 
   3.9340047432435493`*^9}, {3.9340048053731737`*^9, 3.934004809181737*^9}, {
   3.934005274833391*^9, 3.934005282839207*^9}, {3.934018228838429*^9, 
   3.934018241699321*^9}, {3.934023612875197*^9, 3.9340236143227787`*^9}, {
   3.934024220860395*^9, 3.934024250200943*^9}, {3.934024334829576*^9, 
   3.934024353723679*^9}, {3.9348076894679585`*^9, 3.93480769216395*^9}, 
   3.935049508448844*^9, {3.935050269271167*^9, 3.935050276329628*^9}, {
   3.93505038947381*^9, 3.935050391199315*^9}, {3.935050458058854*^9, 
   3.93505047520511*^9}, {3.9350506212700777`*^9, 3.935050632084358*^9}, {
   3.9350506762543077`*^9, 3.935050676906253*^9}, 3.935050730547758*^9, 
   3.935050836159843*^9, {3.935051035995641*^9, 3.935051036770199*^9}, 
   3.935257893308975*^9, {3.935257929390691*^9, 3.935257930054338*^9}, 
   3.935258142046438*^9, {3.935751373060025*^9, 3.9357513786987953`*^9}, 
   3.940523083983074*^9, {3.940530659636448*^9, 3.94053069759194*^9}, {
   3.9405307496436787`*^9, 3.940530841114147*^9}, {3.9519453233599377`*^9, 
   3.9519453283434906`*^9}, {3.9519454125394974`*^9, 3.95194542135478*^9}},
 CellLabel->"In[348]:=",ExpressionUUID->"4a10e253-4bcc-48e9-974d-f71d19202c61"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["1. Construct Metric and LNRF Tetrad", "Section",
 CellChangeTimes->{{3.934005722624063*^9, 3.934005732198447*^9}, {
  3.935053996240841*^9, 3.935054001785119*^9}, {3.9350540410011473`*^9, 
  3.935054058875512*^9}, {3.935054834798462*^9, 3.935054837860755*^9}, {
  3.935055173142095*^9, 3.935055181168125*^9}, {3.935055317595064*^9, 
  3.935055318057983*^9}},ExpressionUUID->"75a54489-e589-bb4b-8ccb-\
4831d80e56e4"],

Cell[CellGroupData[{

Cell["Define Metric Functions (Kerr)", "Subsection",
 CellChangeTimes->{{3.934282090937512*^9, 3.934282091510206*^9}, {
   3.934867310974741*^9, 3.934867312633335*^9}, {3.935054061101269*^9, 
   3.935054065558511*^9}, {3.935054132337101*^9, 3.93505414518657*^9}, 
   3.951944764966957*^9},ExpressionUUID->"874ebe37-2463-c749-a897-\
3d4f99b12b07"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Delta", " ", "=", " ", 
    RowBox[{
     RowBox[{"r", "^", "2"}], " ", "-", " ", 
     RowBox[{"2", " ", "*", " ", "r"}], " ", "+", " ", 
     RowBox[{"a", "^", "2"}]}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Sigma", " ", "=", " ", 
    RowBox[{
     RowBox[{"r", "^", "2"}], " ", "+", " ", 
     RowBox[{
      RowBox[{"a", "^", "2"}], " ", "*", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Cos", "[", "theta", "]"}], ")"}], " ", "^", " ", "2"}]}]}]}],
    ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"A", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"r", "^", "2"}], "+", 
        RowBox[{"a", "^", "2"}]}], ")"}], " ", "^", " ", "2"}], " ", "-", " ", 
     RowBox[{
      RowBox[{"a", "^", "2"}], " ", "*", " ", "Delta", " ", "*", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Sin", "[", "theta", "]"}], ")"}], " ", "^", " ", "2"}]}]}]}],
    ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"nu", " ", "=", " ", 
    RowBox[{
     RowBox[{"Log", "[", 
      RowBox[{"Sigma", " ", "*", " ", 
       RowBox[{"Delta", " ", "/", " ", "A"}]}], "]"}], " ", "/", " ", "2"}]}],
    ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"psi", " ", "=", " ", 
    RowBox[{
     RowBox[{"Log", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Sin", "[", "theta", "]"}], ")"}], " ", "^", " ", "2"}], " ",
        "*", " ", 
       RowBox[{"A", " ", "/", " ", "Sigma"}]}], "]"}], " ", "/", " ", "2"}]}],
    ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"mu1", " ", "=", " ", 
    RowBox[{
     RowBox[{"Log", "[", 
      RowBox[{"Sigma", " ", "/", " ", "Delta"}], "]"}], " ", "/", " ", 
     "2"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"mu2", " ", "=", " ", 
    RowBox[{
     RowBox[{"Log", "[", "Sigma", "]"}], " ", "/", " ", "2"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"omega", " ", "=", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"2", " ", "*", "r"}], ")"}], " ", "*", 
     RowBox[{"a", "/", " ", "A"}]}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Assumptions", " ", "help", " ", "to", " ", "improve", " ", "results", " ",
     "from", " ", "Simplify", " ", "and", " ", "FullSimplify"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"assume", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"0", " ", "<", " ", "a"}], " ", ",", 
      RowBox[{"0", " ", "<", " ", "theta", " ", "<", " ", 
       RowBox[{"Pi", "/", "2"}]}], ",", 
      RowBox[{"ep", ">", "0"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"a", "^", "2"}], "-", 
        RowBox[{"2", "*", "r"}], "+", 
        RowBox[{"r", "^", "2"}]}], ">", "0"}], ",", 
      RowBox[{"lz", ">", "0"}]}], "}"}]}], ";"}], " "}]}], "Input",
 CellChangeTimes->{{3.933854959792768*^9, 3.9338549611571903`*^9}, {
   3.9339165206197433`*^9, 3.933916548912434*^9}, {3.933922207420917*^9, 
   3.93392222609068*^9}, {3.9339309974196997`*^9, 3.933931016199965*^9}, 
   3.933931092421702*^9, {3.93393193798018*^9, 3.933931945639496*^9}, {
   3.933932000241374*^9, 3.933932003585867*^9}, {3.933932521507957*^9, 
   3.933932523034479*^9}, {3.933932952322185*^9, 3.933933045856726*^9}, {
   3.933935218213648*^9, 3.93393521932358*^9}, {3.933935412240082*^9, 
   3.933935420434956*^9}, {3.933935477694027*^9, 3.93393561136913*^9}, {
   3.933935672477589*^9, 3.933935677470853*^9}, {3.9339358170739*^9, 
   3.933935817518752*^9}, {3.9339363257707376`*^9, 3.933936326330152*^9}, {
   3.933936910919734*^9, 3.9339369118980308`*^9}, {3.933937248099874*^9, 
   3.933937265456704*^9}, {3.933937556432447*^9, 3.933937580853297*^9}, 
   3.934005742711608*^9, {3.93401780523812*^9, 3.9340178071297913`*^9}, {
   3.934282283708282*^9, 3.934282292174451*^9}, {3.934287381989078*^9, 
   3.934287396583023*^9}, {3.934360216878838*^9, 3.934360217943141*^9}, {
   3.9344847650006657`*^9, 3.934484767675772*^9}, {3.934867360995327*^9, 
   3.934867365173066*^9}, {3.934867418011077*^9, 3.9348674556908503`*^9}, {
   3.934867573124275*^9, 3.934867604084247*^9}, {3.934867706865942*^9, 
   3.934867832007077*^9}, {3.934868357289069*^9, 3.934868358330013*^9}, {
   3.934868567418899*^9, 3.934868568290724*^9}, {3.934868785125916*^9, 
   3.934868785444957*^9}, {3.934984782456099*^9, 3.934984782770516*^9}, 
   3.935055431316845*^9, {3.935055490001709*^9, 3.935055526904283*^9}, {
   3.9352467704868317`*^9, 3.935246773894331*^9}, {3.9367764882195253`*^9, 
   3.9367764912368937`*^9}, 3.936778145822246*^9, {3.9405321036978855`*^9, 
   3.9405321152132034`*^9}, {3.951944766986498*^9, 3.9519448117268505`*^9}, {
   3.951945036564987*^9, 3.951945053359062*^9}, {3.951946281070608*^9, 
   3.9519462964464684`*^9}},
 CellLabel->
  "In[495]:=",ExpressionUUID->"f137eb3e-4cd4-4943-9a43-e6b2a687391a"],

Cell["First integrals to geodesic equations", "Text",
 CellChangeTimes->{{3.935055462311392*^9, 
  3.935055472508378*^9}},ExpressionUUID->"d258098f-5d64-174f-bd8a-\
4d2eaa199b50"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Check", " ", "these", " ", "expressions", " ", "very", " ", 
    RowBox[{"carefully", "!"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"T", " ", "=", " ", 
     RowBox[{
      RowBox[{"ep", " ", "*", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"r", "^", "2"}], " ", "+", " ", 
         RowBox[{"a", "^", "2"}]}], ")"}]}], " ", "-", " ", 
      RowBox[{"lz", "*", "a"}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Vr", " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"(", "T", ")"}], "^", "2"}], " ", "-", " ", 
      RowBox[{"Delta", " ", "*", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"r", "^", "2"}], " ", "+", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"lz", " ", "-", " ", 
            RowBox[{"a", " ", "*", " ", "ep"}]}], ")"}], " ", "^", " ", "2"}],
          " ", "+", " ", "q"}], ")"}]}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Vtheta", " ", "=", " ", 
     RowBox[{"q", " ", "+", 
      RowBox[{
       RowBox[{"a", "^", "2"}], "*", 
       RowBox[{"ep", "^", "2"}], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Cos", "[", "theta", "]"}], "^", "2"}], ")"}]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"lz", "/", 
         RowBox[{"Tan", "[", "theta", "]"}]}], ")"}], "^", "2"}], "-", 
      RowBox[{
       RowBox[{"a", "^", "2"}], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Cos", "[", "theta", "]"}], "^", "2"}], ")"}]}]}]}], ";"}], 
   " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dsub", " ", "=", " ", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dt", " ", "->", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "a"}], " ", "*", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"a", "*", "ep", "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Sin", "[", "theta", "]"}], "^", "2"}], ")"}]}], "-",
               "lz"}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"r", "^", "2"}], "+", 
              RowBox[{"a", "^", "2"}]}], ")"}], "*", 
            RowBox[{"T", "/", "Delta"}]}]}], ")"}], "/", "Sigma"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"dr", " ", "->", " ", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"Sqrt", "[", "Vr", "]"}]}], " ", "/", " ", "Sigma"}]}], ",", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "Choose", " ", "negative", " ", "for", " ", "inward", " ", "going", " ",
           "particle"}], ",", " ", 
         RowBox[{"does", " ", "not", " ", "matter"}]}], " ", "*)"}], " ", 
       "\[IndentingNewLine]", 
       RowBox[{"dtheta", " ", "->", " ", 
        RowBox[{
         RowBox[{"Sqrt", "[", "Vtheta", "]"}], " ", "/", " ", "Sigma"}]}], ",",
        " ", "\[IndentingNewLine]", 
       RowBox[{"dphi", " ", "->", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "a"}], "*", "ep"}], "+", 
           RowBox[{"lz", "/", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Sin", "[", "theta", "]"}], "^", "2"}], ")"}]}], "+", 
           RowBox[{"a", "*", 
            RowBox[{"T", "/", "Delta"}]}]}], ")"}], "/", "Sigma"}]}]}], 
      "\[IndentingNewLine]", "}"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.933854959792768*^9, 3.9338549611571903`*^9}, {
   3.9339165206197433`*^9, 3.933916548912434*^9}, {3.933922207420917*^9, 
   3.93392222609068*^9}, {3.9339309974196997`*^9, 3.933931016199965*^9}, 
   3.933931092421702*^9, {3.93393193798018*^9, 3.933931945639496*^9}, {
   3.933932000241374*^9, 3.933932003585867*^9}, {3.933932521507957*^9, 
   3.933932523034479*^9}, {3.933932952322185*^9, 3.933933045856726*^9}, {
   3.933935218213648*^9, 3.93393521932358*^9}, {3.933935412240082*^9, 
   3.933935420434956*^9}, {3.933935477694027*^9, 3.93393561136913*^9}, {
   3.933935672477589*^9, 3.933935677470853*^9}, {3.9339358170739*^9, 
   3.933935817518752*^9}, {3.9339363257707376`*^9, 3.933936326330152*^9}, {
   3.933936910919734*^9, 3.9339369118980308`*^9}, {3.933937248099874*^9, 
   3.933937265456704*^9}, {3.933937556432447*^9, 3.933937580853297*^9}, 
   3.934005742711608*^9, {3.93401780523812*^9, 3.9340178071297913`*^9}, {
   3.934282283708282*^9, 3.934282292174451*^9}, {3.934287381989078*^9, 
   3.934287396583023*^9}, {3.934360216878838*^9, 3.934360217943141*^9}, {
   3.9344847650006657`*^9, 3.934484767675772*^9}, {3.934867360995327*^9, 
   3.934867365173066*^9}, {3.934867418011077*^9, 3.9348674556908503`*^9}, {
   3.934867573124275*^9, 3.934867604084247*^9}, {3.934867706865942*^9, 
   3.934867832007077*^9}, {3.934868357289069*^9, 3.934868358330013*^9}, {
   3.934868567418899*^9, 3.934868568290724*^9}, {3.934868785125916*^9, 
   3.934868785444957*^9}, {3.934984782456099*^9, 3.934984782770516*^9}, {
   3.935055431316845*^9, 3.9350554466229253`*^9}, {3.935055487741909*^9, 
   3.935055488044009*^9}, {3.9350854017214184`*^9, 3.935085422545128*^9}, {
   3.935085474660419*^9, 3.935085521189094*^9}, 3.935085603327206*^9, 
   3.935085644106483*^9, 3.935086885401148*^9, 3.9405240825567493`*^9, {
   3.9405241781821537`*^9, 3.9405241892787704`*^9}, {3.9405243365664864`*^9, 
   3.9405243902588825`*^9}, 3.951944816779951*^9},
 CellLabel->"In[210]:=",ExpressionUUID->"324a0401-3ca4-644f-8e6d-06887426cfa2"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Define Metric Functions (Reissner\[Dash]Nordstr\[ODoubleDot]m) (not used by \
default)\
\>", "Subsection",
 CellChangeTimes->{{3.934282090937512*^9, 3.934282091510206*^9}, {
  3.934867310974741*^9, 3.934867312633335*^9}, {3.935054061101269*^9, 
  3.935054065558511*^9}, {3.935054132337101*^9, 3.93505414518657*^9}, {
  3.9352466916494102`*^9, 3.9352467316998863`*^9}, {3.9352503443520927`*^9, 
  3.9352503497747974`*^9}},ExpressionUUID->"46b06921-f27d-4c46-b096-\
218a1cfeb282"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"Delta", " ", "=", " ", 
    RowBox[{
     RowBox[{"r", "^", "2"}], " ", "-", " ", 
     RowBox[{"2", " ", "*", " ", "M", " ", "*", " ", "r"}], " ", "+", 
     RowBox[{"Q", "^", "2"}]}]}], ";", "\n", "\n", 
   RowBox[{"Sigma", " ", "=", " ", 
    RowBox[{"r", "^", "2"}]}], ";", "\n", "\n", 
   RowBox[{"A", " ", "=", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"r", "^", "2"}], ")"}], " ", "^", " ", "2"}]}], ";", "\n", "\n", 
   RowBox[{"nu", " ", "=", " ", 
    RowBox[{
     RowBox[{"Log", "[", 
      RowBox[{"Sigma", " ", "*", " ", 
       RowBox[{"Delta", " ", "/", " ", "A"}]}], "]"}], " ", "/", " ", "2"}]}],
    ";", "\n", "\n", 
   RowBox[{"psi", " ", "=", " ", 
    RowBox[{
     RowBox[{"Log", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Sin", "[", "theta", "]"}], ")"}], " ", "^", " ", "2"}], " ",
        "*", " ", 
       RowBox[{"A", " ", "/", " ", "Sigma"}]}], "]"}], " ", "/", " ", "2"}]}],
    ";", "\n", "\n", 
   RowBox[{"mu1", " ", "=", " ", 
    RowBox[{
     RowBox[{"Log", "[", 
      RowBox[{"Sigma", " ", "/", " ", "Delta"}], "]"}], " ", "/", " ", 
     "2"}]}], ";", "\n", "\n", 
   RowBox[{"mu2", " ", "=", " ", 
    RowBox[{
     RowBox[{"Log", "[", "Sigma", "]"}], " ", "/", " ", "2"}]}], ";", "\n", 
   "\n", 
   RowBox[{"omega", " ", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Assumptions", " ", "help", " ", "to", " ", "improve", " ", "results", " ",
      "from", " ", "Simplify", " ", "and", " ", "FullSimplify"}], " ", "*)"}],
    "\[IndentingNewLine]", 
   RowBox[{"assume", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Q", ">", "0"}], ",", 
      RowBox[{"M", " ", ">", "0"}], ",", 
      RowBox[{"ep", ">", "0"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"a", "^", "2"}], "-", 
        RowBox[{"2", "*", "M", "*", "r"}], "+", 
        RowBox[{"r", "^", "2"}], "+", 
        RowBox[{"Q", "^", "2"}]}], ">", "0"}], ",", 
      RowBox[{"r", ">", "2"}]}], "}"}]}], ";"}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.933854959792768*^9, 3.9338549611571903`*^9}, {
   3.9339165206197433`*^9, 3.933916548912434*^9}, {3.933922207420917*^9, 
   3.93392222609068*^9}, {3.9339309974196997`*^9, 3.933931016199965*^9}, 
   3.933931092421702*^9, {3.93393193798018*^9, 3.933931945639496*^9}, {
   3.933932000241374*^9, 3.933932003585867*^9}, {3.933932521507957*^9, 
   3.933932523034479*^9}, {3.933932952322185*^9, 3.933933045856726*^9}, {
   3.933935218213648*^9, 3.93393521932358*^9}, {3.933935412240082*^9, 
   3.933935420434956*^9}, {3.933935477694027*^9, 3.93393561136913*^9}, {
   3.933935672477589*^9, 3.933935677470853*^9}, {3.9339358170739*^9, 
   3.933935817518752*^9}, {3.9339363257707376`*^9, 3.933936326330152*^9}, {
   3.933936910919734*^9, 3.9339369118980308`*^9}, {3.933937248099874*^9, 
   3.933937265456704*^9}, {3.933937556432447*^9, 3.933937580853297*^9}, 
   3.934005742711608*^9, {3.93401780523812*^9, 3.9340178071297913`*^9}, {
   3.934282283708282*^9, 3.934282292174451*^9}, {3.934287381989078*^9, 
   3.934287396583023*^9}, {3.934360216878838*^9, 3.934360217943141*^9}, {
   3.9344847650006657`*^9, 3.934484767675772*^9}, {3.934867360995327*^9, 
   3.934867365173066*^9}, {3.934867418011077*^9, 3.9348674556908503`*^9}, {
   3.934867573124275*^9, 3.934867604084247*^9}, {3.934867706865942*^9, 
   3.934867832007077*^9}, {3.934868357289069*^9, 3.934868358330013*^9}, {
   3.934868567418899*^9, 3.934868568290724*^9}, {3.934868785125916*^9, 
   3.934868785444957*^9}, {3.934984782456099*^9, 3.934984782770516*^9}, 
   3.935055431316845*^9, {3.935055490001709*^9, 3.935055526904283*^9}, {
   3.935246736765882*^9, 3.935246790198759*^9}, {3.935250399888427*^9, 
   3.935250427509848*^9}, {3.935250458324114*^9, 3.935250458896299*^9}, 
   3.935257406835378*^9},
 CellLabel->
  "In[101]:=",ExpressionUUID->"b4e45bcf-2832-834b-8e84-eb5e3074f1b8"],

Cell["First integrals to geodesic equations", "Text",
 CellChangeTimes->{{3.935055462311392*^9, 
  3.935055472508378*^9}},ExpressionUUID->"838c72df-84ea-7f4f-9b8f-\
f8654e88db88"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"T", " ", "=", " ", 
    RowBox[{
     RowBox[{"ep", " ", "*", " ", 
      RowBox[{"(", 
       RowBox[{"r", "^", "2"}], ")"}]}], " ", "-", 
     RowBox[{"Q", "*", "e", "*", "r"}]}]}], ";", "\n", 
   RowBox[{"Vr", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"(", "T", ")"}], "^", "2"}], " ", "-", " ", 
     RowBox[{"Delta", " ", "*", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"r", "^", "2"}], " ", "+", " ", 
        RowBox[{
         RowBox[{"(", "lz", " ", ")"}], " ", "^", " ", "2"}], " ", "+", " ", 
        "q"}], ")"}]}]}]}], ";", "\n", 
   RowBox[{"Vtheta", " ", "=", " ", 
    RowBox[{"q", " ", "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"lz", "/", 
        RowBox[{"Tan", "[", "theta", "]"}]}], ")"}], "^", "2"}]}]}], ";", 
   "\n", "\[IndentingNewLine]", 
   RowBox[{"dsub", " ", "=", " ", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dt", " ", "->", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"r", "^", "2"}], ")"}], "*", 
          RowBox[{"T", "/", "Delta"}]}], ")"}], "/", "Sigma"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"dr", " ", "->", " ", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Sqrt", "[", "Vr", "]"}]}], " ", "/", " ", "Sigma"}]}], ",", 
      " ", "\[IndentingNewLine]", 
      RowBox[{"dtheta", " ", "->", " ", "0"}], ",", " ", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"Assume", " ", "theta"}], "=", 
        RowBox[{"Pi", "/", "2"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"dphi", " ", "->", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"lz", "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Sin", "[", "theta", "]"}], "^", "2"}], ")"}]}], ")"}], "/",
         "Sigma"}]}]}], "\[IndentingNewLine]", "}"}]}], ";"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.933854959792768*^9, 3.9338549611571903`*^9}, {
   3.9339165206197433`*^9, 3.933916548912434*^9}, {3.933922207420917*^9, 
   3.93392222609068*^9}, {3.9339309974196997`*^9, 3.933931016199965*^9}, 
   3.933931092421702*^9, {3.93393193798018*^9, 3.933931945639496*^9}, {
   3.933932000241374*^9, 3.933932003585867*^9}, {3.933932521507957*^9, 
   3.933932523034479*^9}, {3.933932952322185*^9, 3.933933045856726*^9}, {
   3.933935218213648*^9, 3.93393521932358*^9}, {3.933935412240082*^9, 
   3.933935420434956*^9}, {3.933935477694027*^9, 3.93393561136913*^9}, {
   3.933935672477589*^9, 3.933935677470853*^9}, {3.9339358170739*^9, 
   3.933935817518752*^9}, {3.9339363257707376`*^9, 3.933936326330152*^9}, {
   3.933936910919734*^9, 3.9339369118980308`*^9}, {3.933937248099874*^9, 
   3.933937265456704*^9}, {3.933937556432447*^9, 3.933937580853297*^9}, 
   3.934005742711608*^9, {3.93401780523812*^9, 3.9340178071297913`*^9}, {
   3.934282283708282*^9, 3.934282292174451*^9}, {3.934287381989078*^9, 
   3.934287396583023*^9}, {3.934360216878838*^9, 3.934360217943141*^9}, {
   3.9344847650006657`*^9, 3.934484767675772*^9}, {3.934867360995327*^9, 
   3.934867365173066*^9}, {3.934867418011077*^9, 3.9348674556908503`*^9}, {
   3.934867573124275*^9, 3.934867604084247*^9}, {3.934867706865942*^9, 
   3.934867832007077*^9}, {3.934868357289069*^9, 3.934868358330013*^9}, {
   3.934868567418899*^9, 3.934868568290724*^9}, {3.934868785125916*^9, 
   3.934868785444957*^9}, {3.934984782456099*^9, 3.934984782770516*^9}, {
   3.935055431316845*^9, 3.9350554466229253`*^9}, {3.935055487741909*^9, 
   3.935055488044009*^9}, {3.9350854017214184`*^9, 3.935085422545128*^9}, {
   3.935085474660419*^9, 3.935085521189094*^9}, 3.935085603327206*^9, 
   3.935085644106483*^9, 3.935086885401148*^9, {3.935246844716083*^9, 
   3.93524692899094*^9}, 3.935257411905031*^9},
 CellLabel->"In[102]:=",ExpressionUUID->"51dff62a-5ced-4c4b-ad45-8503d8c30d88"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Construct metric", "Subsection",
 CellChangeTimes->{{3.934005736741164*^9, 
  3.934005752075032*^9}},ExpressionUUID->"f670db8a-8d75-e34f-b307-\
6bca94049d7c"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"g00", " ", "=", " ", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"Exp", "[", 
       RowBox[{"2", " ", "*", " ", "nu"}], "]"}]}], " ", "+", " ", 
     RowBox[{
      RowBox[{"omega", "^", "2"}], " ", "*", " ", 
      RowBox[{"Exp", "[", 
       RowBox[{"2", " ", "*", " ", "psi"}], "]"}]}]}]}], ";"}], "\n"}], "\n", 

 RowBox[{
  RowBox[{
   RowBox[{"g11", " ", "=", " ", 
    RowBox[{"Exp", "[", 
     RowBox[{"2", " ", "*", " ", "mu1"}], "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"g22", " ", "=", " ", 
    RowBox[{"Exp", "[", 
     RowBox[{"2", " ", "*", " ", "mu2"}], "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"g33", " ", "=", " ", 
    RowBox[{"Exp", "[", 
     RowBox[{"2", " ", "*", " ", "psi"}], "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"g03", " ", "=", " ", 
    RowBox[{
     RowBox[{"-", "omega"}], " ", "*", " ", 
     RowBox[{"Exp", "[", 
      RowBox[{"2", " ", "*", " ", "psi"}], "]"}]}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"g30", " ", "=", " ", "g03"}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"G", " ", "=", " ", 
    RowBox[{"Simplify", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"g00", ",", " ", "0", ",", " ", "0", ",", " ", "g03"}], "}"}],
        ",", " ", 
       RowBox[{"{", 
        RowBox[{"0", ",", " ", "g11", ",", " ", "0", ",", " ", "0"}], "}"}], ",",
        " ", 
       RowBox[{"{", 
        RowBox[{"0", ",", " ", "0", ",", " ", "g22", ",", " ", "0"}], "}"}], ",",
        " ", 
       RowBox[{"{", 
        RowBox[{
        "g03", ",", "\n", "     ", "0", ",", " ", "0", ",", " ", "g33"}], 
        "}"}]}], "}"}], "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{"G", " ", "//", " ", "MatrixForm"}], "\n", 
 RowBox[{
  RowBox[{"eta", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", " ", "0", ",", " ", "0", ",", " ", "0"}], 
      "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", "1", ",", " ", "0", ",", " ", "0"}], "}"}], ",", 
     " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", "0", ",", " ", "1", ",", " ", "0"}], "}"}], ",", 
     " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", "0", ",", " ", "0", ",", " ", "1"}], "}"}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ginv", " ", "=", " ", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"Inverse", "[", "G", "]"}], ",", 
     RowBox[{"Assumptions", "->", "assume"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Ginv", " ", "//", " ", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{"eta", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.933830506502351*^9, 3.933830703486718*^9}, {
  3.933830915507316*^9, 3.933830920422785*^9}, {3.933836233776398*^9, 
  3.933836260761751*^9}, {3.933836437750134*^9, 3.933836437887389*^9}, {
  3.933854076771879*^9, 3.9338540773039503`*^9}, {3.933931160043805*^9, 
  3.93393116219117*^9}, {3.933939187034836*^9, 3.933939225534553*^9}, {
  3.9340239111180973`*^9, 3.934023913949585*^9}, {3.93428330841564*^9, 
  3.934283309314687*^9}, {3.934868103482291*^9, 3.934868104565119*^9}, {
  3.934985157464023*^9, 3.934985160132829*^9}, {3.934985217951686*^9, 
  3.934985218115399*^9}, {3.935086714267599*^9, 3.935086715067781*^9}},
 CellLabel->
  "In[504]:=",ExpressionUUID->"07a79e12-a0ed-c448-818f-cffb501ed195"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["a", "2"], "+", 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "2"}], "+", "r"}], ")"}], " ", "r"}], "+", 
         RowBox[{
          SuperscriptBox["a", "2"], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", "theta"}], "]"}]}]}], 
        RowBox[{
         SuperscriptBox["a", "2"], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["r", "2"]}], "+", 
         RowBox[{
          SuperscriptBox["a", "2"], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", "theta"}], "]"}]}]}]]}], "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "a", " ", "r", " ", 
         SuperscriptBox[
          RowBox[{"Sin", "[", "theta", "]"}], "2"]}], 
        RowBox[{
         SuperscriptBox["r", "2"], "+", 
         RowBox[{
          SuperscriptBox["a", "2"], " ", 
          SuperscriptBox[
           RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}]]}]},
     {"0", 
      FractionBox[
       RowBox[{
        SuperscriptBox["r", "2"], "+", 
        RowBox[{
         SuperscriptBox["a", "2"], " ", 
         SuperscriptBox[
          RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], 
       RowBox[{
        SuperscriptBox["a", "2"], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "2"}], "+", "r"}], ")"}], " ", "r"}]}]], "0", "0"},
     {"0", "0", 
      RowBox[{
       SuperscriptBox["r", "2"], "+", 
       RowBox[{
        SuperscriptBox["a", "2"], " ", 
        SuperscriptBox[
         RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], "0"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "a", " ", "r", " ", 
         SuperscriptBox[
          RowBox[{"Sin", "[", "theta", "]"}], "2"]}], 
        RowBox[{
         SuperscriptBox["r", "2"], "+", 
         RowBox[{
          SuperscriptBox["a", "2"], " ", 
          SuperscriptBox[
           RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}]]}], "0", "0", 
      FractionBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"Sin", "[", "theta", "]"}], "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["a", "2"], "+", 
             SuperscriptBox["r", "2"]}], ")"}], "2"], "-", 
          RowBox[{
           SuperscriptBox["a", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["a", "2"], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "2"}], "+", "r"}], ")"}], " ", "r"}]}], ")"}], " ", 
           SuperscriptBox[
            RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}]}], 
       RowBox[{
        SuperscriptBox["r", "2"], "+", 
        RowBox[{
         SuperscriptBox["a", "2"], " ", 
         SuperscriptBox[
          RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}]]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.9339312024151096`*^9, 3.933935223747494*^9, {3.9339391945553102`*^9, 
   3.933939225779566*^9}, 3.9340012486098213`*^9, 3.934003742512697*^9, 
   3.934005753759734*^9, 3.9340138668696823`*^9, 3.934017492692045*^9, 
   3.934017590460136*^9, 3.934023914392991*^9, 3.9340243052464952`*^9, 
   3.9342820232155123`*^9, 3.934282533478303*^9, 3.934283310056161*^9, 
   3.934283631193225*^9, 3.934285199943402*^9, 3.934347691979907*^9, 
   3.9343602292722273`*^9, 3.934366496979014*^9, 3.934375198589778*^9, 
   3.934484762342026*^9, 3.934539886215872*^9, 3.934807715691887*^9, 
   3.934867841402401*^9, 3.934868115877814*^9, 3.934978171671949*^9, 
   3.934981167904202*^9, {3.934985154650413*^9, 3.934985160515249*^9}, 
   3.934985218960063*^9, 3.93504996646565*^9, 3.935055988088559*^9, 
   3.93506545948032*^9, {3.935065994332148*^9, 3.9350660063390427`*^9}, 
   3.935083959596672*^9, 3.935086732097634*^9, 3.935136760236305*^9, 
   3.9352465099070168`*^9, 3.935246946769863*^9, {3.935250419743862*^9, 
   3.93525042973784*^9}, 3.935250473841503*^9, 3.935257431568857*^9, 
   3.93558257637195*^9, 3.935750126665118*^9, 3.936775702012369*^9, 
   3.940522427726177*^9, {3.9405244017006836`*^9, 3.9405244261061077`*^9}, {
   3.9405303511895657`*^9, 3.940530374554817*^9}, 3.9519448217440395`*^9, 
   3.9519450602222004`*^9, 3.951946300261078*^9},
 CellLabel->
  "Out[511]//MatrixForm=",ExpressionUUID->"17c2decf-6f92-6642-9b1d-\
49b7473082da"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["a", "4"], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["r", "4"]}], "+", 
         RowBox[{
          SuperscriptBox["a", "2"], " ", "r", " ", 
          RowBox[{"(", 
           RowBox[{"2", "+", 
            RowBox[{"3", " ", "r"}]}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["a", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["a", "2"], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "2"}], "+", "r"}], ")"}], " ", "r"}]}], ")"}], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", "theta"}], "]"}]}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["a", "2"], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "2"}], "+", "r"}], ")"}], " ", "r"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["a", "2"], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["r", "2"]}], "+", 
           RowBox[{
            SuperscriptBox["a", "2"], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", "theta"}], "]"}]}]}], ")"}]}]]}], "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"4", " ", "a", " ", "r"}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["a", "2"], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "2"}], "+", "r"}], ")"}], " ", "r"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["a", "2"], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["r", "2"]}], "+", 
           RowBox[{
            SuperscriptBox["a", "2"], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", "theta"}], "]"}]}]}], ")"}]}]]}]},
     {"0", 
      FractionBox[
       RowBox[{
        SuperscriptBox["a", "2"], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "2"}], "+", "r"}], ")"}], " ", "r"}]}], 
       RowBox[{
        SuperscriptBox["r", "2"], "+", 
        RowBox[{
         SuperscriptBox["a", "2"], " ", 
         SuperscriptBox[
          RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}]], "0", "0"},
     {"0", "0", 
      FractionBox["1", 
       RowBox[{
        SuperscriptBox["r", "2"], "+", 
        RowBox[{
         SuperscriptBox["a", "2"], " ", 
         SuperscriptBox[
          RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}]], "0"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"4", " ", "a", " ", "r"}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["a", "2"], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "2"}], "+", "r"}], ")"}], " ", "r"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["a", "2"], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["r", "2"]}], "+", 
           RowBox[{
            SuperscriptBox["a", "2"], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", "theta"}], "]"}]}]}], ")"}]}]]}], "0", "0", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["a", "2"], "+", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "2"}], "+", "r"}], ")"}], " ", "r"}], "+", 
          RowBox[{
           SuperscriptBox["a", "2"], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", "theta"}], "]"}]}]}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"Csc", "[", "theta", "]"}], "2"]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["a", "2"], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "2"}], "+", "r"}], ")"}], " ", "r"}]}], ")"}], " ", 
        
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["a", "2"], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["r", "2"]}], "+", 
          RowBox[{
           SuperscriptBox["a", "2"], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", "theta"}], "]"}]}]}], ")"}]}]]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.9339312024151096`*^9, 3.933935223747494*^9, {3.9339391945553102`*^9, 
   3.933939225779566*^9}, 3.9340012486098213`*^9, 3.934003742512697*^9, 
   3.934005753759734*^9, 3.9340138668696823`*^9, 3.934017492692045*^9, 
   3.934017590460136*^9, 3.934023914392991*^9, 3.9340243052464952`*^9, 
   3.9342820232155123`*^9, 3.934282533478303*^9, 3.934283310056161*^9, 
   3.934283631193225*^9, 3.934285199943402*^9, 3.934347691979907*^9, 
   3.9343602292722273`*^9, 3.934366496979014*^9, 3.934375198589778*^9, 
   3.934484762342026*^9, 3.934539886215872*^9, 3.934807715691887*^9, 
   3.934867841402401*^9, 3.934868115877814*^9, 3.934978171671949*^9, 
   3.934981167904202*^9, {3.934985154650413*^9, 3.934985160515249*^9}, 
   3.934985218960063*^9, 3.93504996646565*^9, 3.935055988088559*^9, 
   3.93506545948032*^9, {3.935065994332148*^9, 3.9350660063390427`*^9}, 
   3.935083959596672*^9, 3.935086732097634*^9, 3.935136760236305*^9, 
   3.9352465099070168`*^9, 3.935246946769863*^9, {3.935250419743862*^9, 
   3.93525042973784*^9}, 3.935250473841503*^9, 3.935257431568857*^9, 
   3.93558257637195*^9, 3.935750126665118*^9, 3.936775702012369*^9, 
   3.940522427726177*^9, {3.9405244017006836`*^9, 3.9405244261061077`*^9}, {
   3.9405303511895657`*^9, 3.940530374554817*^9}, 3.9519448217440395`*^9, 
   3.9519450602222004`*^9, 3.951946300413086*^9},
 CellLabel->
  "Out[514]//MatrixForm=",ExpressionUUID->"d6061b0f-8ddf-3d40-a2fe-\
e06e499cb70f"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "1"}], "0", "0", "0"},
     {"0", "1", "0", "0"},
     {"0", "0", "1", "0"},
     {"0", "0", "0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.9339312024151096`*^9, 3.933935223747494*^9, {3.9339391945553102`*^9, 
   3.933939225779566*^9}, 3.9340012486098213`*^9, 3.934003742512697*^9, 
   3.934005753759734*^9, 3.9340138668696823`*^9, 3.934017492692045*^9, 
   3.934017590460136*^9, 3.934023914392991*^9, 3.9340243052464952`*^9, 
   3.9342820232155123`*^9, 3.934282533478303*^9, 3.934283310056161*^9, 
   3.934283631193225*^9, 3.934285199943402*^9, 3.934347691979907*^9, 
   3.9343602292722273`*^9, 3.934366496979014*^9, 3.934375198589778*^9, 
   3.934484762342026*^9, 3.934539886215872*^9, 3.934807715691887*^9, 
   3.934867841402401*^9, 3.934868115877814*^9, 3.934978171671949*^9, 
   3.934981167904202*^9, {3.934985154650413*^9, 3.934985160515249*^9}, 
   3.934985218960063*^9, 3.93504996646565*^9, 3.935055988088559*^9, 
   3.93506545948032*^9, {3.935065994332148*^9, 3.9350660063390427`*^9}, 
   3.935083959596672*^9, 3.935086732097634*^9, 3.935136760236305*^9, 
   3.9352465099070168`*^9, 3.935246946769863*^9, {3.935250419743862*^9, 
   3.93525042973784*^9}, 3.935250473841503*^9, 3.935257431568857*^9, 
   3.93558257637195*^9, 3.935750126665118*^9, 3.936775702012369*^9, 
   3.940522427726177*^9, {3.9405244017006836`*^9, 3.9405244261061077`*^9}, {
   3.9405303511895657`*^9, 3.940530374554817*^9}, 3.9519448217440395`*^9, 
   3.9519450602222004`*^9, 3.951946300458132*^9},
 CellLabel->
  "Out[515]//MatrixForm=",ExpressionUUID->"df68f21d-2a6f-6147-8526-\
25f47f4f1de4"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Construct LNRF tetrad", "Subsection",
 CellChangeTimes->{{3.934005758749338*^9, 
  3.9340057711714687`*^9}},ExpressionUUID->"59e53f6e-c6b4-5240-afdf-\
55d00df899c4"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"etup", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Exp", "[", "nu", "]"}], ",", " ", "0", ",", " ", "0", ",", " ",
       "0"}], "}"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"erup", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{"0", ",", " ", 
      RowBox[{"Exp", "[", "mu1", "]"}], ",", " ", "0", ",", " ", "0"}], 
     "}"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ethetaup", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{"0", ",", " ", "0", ",", " ", 
      RowBox[{"Exp", "[", "mu2", "]"}], ",", " ", "0"}], "}"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ephiup", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "omega"}], " ", "*", " ", 
       RowBox[{"Exp", "[", "psi", "]"}]}], ",", " ", "0", ",", " ", "0", ",", 
      " ", 
      RowBox[{"Exp", "[", "psi", "]"}]}], "}"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"etdown", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Exp", "[", 
       RowBox[{"-", "nu"}], "]"}], ",", " ", "0", ",", " ", "0", ",", " ", 
      RowBox[{"omega", " ", "*", " ", 
       RowBox[{"Exp", "[", 
        RowBox[{"-", "nu"}], "]"}]}]}], "}"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"erdown", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{"0", ",", " ", 
      RowBox[{"Exp", "[", 
       RowBox[{"-", "mu1"}], "]"}], ",", " ", "0", ",", " ", "0"}], "}"}]}], 
   ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ethetadown", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{"0", ",", " ", "0", ",", " ", 
      RowBox[{"Exp", "[", 
       RowBox[{"-", "mu2"}], "]"}], ",", " ", "0"}], "}"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ephidown", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{"0", ",", " ", "0", ",", " ", "0", ",", " ", 
      RowBox[{"Exp", "[", 
       RowBox[{"-", "psi"}], "]"}]}], "}"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"matup", " ", "=", " ", 
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "etup", ",", " ", "erup", ",", " ", "ethetaup", ",", " ", "ephiup"}], 
       "}"}], ",", " ", 
      RowBox[{"Assumptions", " ", "->", " ", "assume"}]}], "\n", "    ", 
     "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"matdown", " ", "=", " ", 
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "etdown", ",", " ", "erdown", ",", " ", "ethetadown", ",", " ", 
        "ephidown"}], "}"}], ",", " ", 
      RowBox[{"Assumptions", "\n", "     ", "->", " ", "assume"}]}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"matup", " ", "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{"matdown", " ", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.933845528618372*^9, 3.933845530814603*^9}, {
   3.933845582544602*^9, 3.9338456414921627`*^9}, 3.933850887613605*^9, {
   3.9339186704628773`*^9, 3.933918671732664*^9}, {3.933918709439705*^9, 
   3.93391874278925*^9}, {3.9339188180170097`*^9, 3.933918859579761*^9}, {
   3.933918933241538*^9, 3.933918968286671*^9}, {3.933919431266457*^9, 
   3.9339194653901253`*^9}, {3.933919506084997*^9, 3.93391951262516*^9}, {
   3.9339197304712057`*^9, 3.933919733663788*^9}, {3.9339197939952*^9, 
   3.9339198134478827`*^9}, {3.9339205015447693`*^9, 3.933920504778554*^9}, {
   3.93392057573744*^9, 3.933920602698117*^9}, {3.933921872255871*^9, 
   3.933921934120757*^9}, {3.933922005289003*^9, 3.933922013312416*^9}, {
   3.933922046918565*^9, 3.933922084304058*^9}, {3.933922144501965*^9, 
   3.93392214861307*^9}, 3.933922672780192*^9, {3.93392270533084*^9, 
   3.933922707109283*^9}, {3.933922758324823*^9, 3.93392276929446*^9}, {
   3.933922805919358*^9, 3.933922817797338*^9}, {3.933922859650118*^9, 
   3.933922870404048*^9}, {3.933928854886556*^9, 3.933928859668427*^9}, {
   3.933933407277974*^9, 3.933933416792776*^9}},
 CellLabel->
  "In[516]:=",ExpressionUUID->"84c18ada-202d-7c4c-992c-fea3cc735eec"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      SqrtBox[
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["a", "2"], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "2"}], "+", "r"}], ")"}], " ", "r"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["r", "2"], "+", 
           RowBox[{
            SuperscriptBox["a", "2"], " ", 
            SuperscriptBox[
             RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}]}], 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["a", "2"], "+", 
            SuperscriptBox["r", "2"]}], ")"}], "2"], "-", 
         RowBox[{
          SuperscriptBox["a", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["a", "2"], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "2"}], "+", "r"}], ")"}], " ", "r"}]}], ")"}], " ", 
          SuperscriptBox[
           RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}]]], "0", "0", "0"},
     {"0", 
      SqrtBox[
       FractionBox[
        RowBox[{
         SuperscriptBox["r", "2"], "+", 
         RowBox[{
          SuperscriptBox["a", "2"], " ", 
          SuperscriptBox[
           RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], 
        RowBox[{
         SuperscriptBox["a", "2"], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "2"}], "+", "r"}], ")"}], " ", "r"}]}]]], "0", "0"},
     {"0", "0", 
      SqrtBox[
       RowBox[{
        SuperscriptBox["r", "2"], "+", 
        RowBox[{
         SuperscriptBox["a", "2"], " ", 
         SuperscriptBox[
          RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}]], "0"},
     {
      FractionBox[
       RowBox[{"2", " ", "a", " ", "r", " ", 
        RowBox[{"Sin", "[", "theta", "]"}], " ", 
        SqrtBox[
         FractionBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["a", "2"], "+", 
              SuperscriptBox["r", "2"]}], ")"}], "2"], "-", 
           RowBox[{
            SuperscriptBox["a", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["a", "2"], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "2"}], "+", "r"}], ")"}], " ", "r"}]}], ")"}], " ", 
            SuperscriptBox[
             RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], 
          RowBox[{
           SuperscriptBox["r", "2"], "+", 
           RowBox[{
            SuperscriptBox["a", "2"], " ", 
            SuperscriptBox[
             RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}]]]}], 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["a", "2"], "+", 
            SuperscriptBox["r", "2"]}], ")"}], "2"]}], "+", 
        RowBox[{
         SuperscriptBox["a", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["a", "2"], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "2"}], "+", "r"}], ")"}], " ", "r"}]}], ")"}], " ", 
         SuperscriptBox[
          RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}]], "0", "0", 
      RowBox[{
       RowBox[{"Sin", "[", "theta", "]"}], " ", 
       SqrtBox[
        FractionBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["a", "2"], "+", 
             SuperscriptBox["r", "2"]}], ")"}], "2"], "-", 
          RowBox[{
           SuperscriptBox["a", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["a", "2"], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "2"}], "+", "r"}], ")"}], " ", "r"}]}], ")"}], " ", 
           SuperscriptBox[
            RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], 
         RowBox[{
          SuperscriptBox["r", "2"], "+", 
          RowBox[{
           SuperscriptBox["a", "2"], " ", 
           SuperscriptBox[
            RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}]]]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.933935228922935*^9, 3.934001252988772*^9, 3.9340037487084846`*^9, 
   3.934013889955045*^9, 3.934017598455592*^9, 3.9342820308744717`*^9, 
   3.9342825649346943`*^9, 3.934283315113695*^9, 3.934283641738881*^9, 
   3.934285204444312*^9, 3.934347697182081*^9, 3.9343602344825287`*^9, 
   3.934366501370142*^9, 3.93437520429792*^9, 3.934484772557873*^9, 
   3.93453989876166*^9, 3.934807718462942*^9, 3.934868193511877*^9, 
   3.9349781777070704`*^9, 3.93498117440427*^9, 3.935049970575103*^9, 
   3.935065464069067*^9, 3.935065989385304*^9, 3.935083961536112*^9, 
   3.935136771059964*^9, 3.935246635118269*^9, 3.935246955049659*^9, 
   3.935250477879919*^9, 3.935257434964632*^9, 3.935582578724493*^9, 
   3.935750129873388*^9, 3.93677570584308*^9, 3.940522430400625*^9, {
   3.940524404244011*^9, 3.940524428979393*^9}, {3.940530353999449*^9, 
   3.940530375851301*^9}, 3.95194482515489*^9, 3.9519463042696705`*^9},
 CellLabel->
  "Out[526]//MatrixForm=",ExpressionUUID->"bfa0a43e-6175-6942-b8d2-\
2a24e086665b"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox["1", 
       SqrtBox[
        FractionBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["a", "2"], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "2"}], "+", "r"}], ")"}], " ", "r"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["r", "2"], "+", 
            RowBox[{
             SuperscriptBox["a", "2"], " ", 
             SuperscriptBox[
              RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}]}], 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["a", "2"], "+", 
             SuperscriptBox["r", "2"]}], ")"}], "2"], "-", 
          RowBox[{
           SuperscriptBox["a", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["a", "2"], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "2"}], "+", "r"}], ")"}], " ", "r"}]}], ")"}], " ", 
           SuperscriptBox[
            RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}]]]], "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "a", " ", "r"}], 
        RowBox[{
         SqrtBox[
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["a", "2"], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "2"}], "+", "r"}], ")"}], " ", "r"}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["r", "2"], "+", 
              RowBox[{
               SuperscriptBox["a", "2"], " ", 
               SuperscriptBox[
                RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}]}], 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["a", "2"], "+", 
               SuperscriptBox["r", "2"]}], ")"}], "2"], "-", 
            RowBox[{
             SuperscriptBox["a", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["a", "2"], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "2"}], "+", "r"}], ")"}], " ", "r"}]}], ")"}], 
             " ", 
             SuperscriptBox[
              RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}]]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["a", "2"], "+", 
               SuperscriptBox["r", "2"]}], ")"}], "2"]}], "+", 
           RowBox[{
            SuperscriptBox["a", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["a", "2"], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "2"}], "+", "r"}], ")"}], " ", "r"}]}], ")"}], " ", 
            SuperscriptBox[
             RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}]}]]}]},
     {"0", 
      SqrtBox[
       FractionBox[
        RowBox[{
         SuperscriptBox["a", "2"], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "2"}], "+", "r"}], ")"}], " ", "r"}]}], 
        RowBox[{
         SuperscriptBox["r", "2"], "+", 
         RowBox[{
          SuperscriptBox["a", "2"], " ", 
          SuperscriptBox[
           RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}]]], "0", "0"},
     {"0", "0", 
      FractionBox["1", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["r", "2"], "+", 
         RowBox[{
          SuperscriptBox["a", "2"], " ", 
          SuperscriptBox[
           RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}]]], "0"},
     {"0", "0", "0", 
      FractionBox[
       RowBox[{"Csc", "[", "theta", "]"}], 
       SqrtBox[
        FractionBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["a", "2"], "+", 
             SuperscriptBox["r", "2"]}], ")"}], "2"], "-", 
          RowBox[{
           SuperscriptBox["a", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["a", "2"], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "2"}], "+", "r"}], ")"}], " ", "r"}]}], ")"}], " ", 
           SuperscriptBox[
            RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], 
         RowBox[{
          SuperscriptBox["r", "2"], "+", 
          RowBox[{
           SuperscriptBox["a", "2"], " ", 
           SuperscriptBox[
            RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}]]]]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.933935228922935*^9, 3.934001252988772*^9, 3.9340037487084846`*^9, 
   3.934013889955045*^9, 3.934017598455592*^9, 3.9342820308744717`*^9, 
   3.9342825649346943`*^9, 3.934283315113695*^9, 3.934283641738881*^9, 
   3.934285204444312*^9, 3.934347697182081*^9, 3.9343602344825287`*^9, 
   3.934366501370142*^9, 3.93437520429792*^9, 3.934484772557873*^9, 
   3.93453989876166*^9, 3.934807718462942*^9, 3.934868193511877*^9, 
   3.9349781777070704`*^9, 3.93498117440427*^9, 3.935049970575103*^9, 
   3.935065464069067*^9, 3.935065989385304*^9, 3.935083961536112*^9, 
   3.935136771059964*^9, 3.935246635118269*^9, 3.935246955049659*^9, 
   3.935250477879919*^9, 3.935257434964632*^9, 3.935582578724493*^9, 
   3.935750129873388*^9, 3.93677570584308*^9, 3.940522430400625*^9, {
   3.940524404244011*^9, 3.940524428979393*^9}, {3.940530353999449*^9, 
   3.940530375851301*^9}, 3.95194482515489*^9, 3.9519463043175907`*^9},
 CellLabel->
  "Out[527]//MatrixForm=",ExpressionUUID->"1609c6d2-aedd-e449-afef-\
24e5f5939c66"]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["2. Compute Riemann Tensors in LNRF", "Section",
 CellChangeTimes->{{3.9350542398971577`*^9, 3.935054259276409*^9}, {
  3.9350553195442543`*^9, 
  3.935055319751227*^9}},ExpressionUUID->"1cc04b4d-a8d7-4b00-a7f4-\
affa0de0bc81"],

Cell[CellGroupData[{

Cell["Riemann tensor in observer frame", "Subsection",
 CellChangeTimes->{{3.934005778381692*^9, 3.934005804332829*^9}, {
   3.935054122709726*^9, 3.9350541228289747`*^9}, 3.935055260175907*^9, {
   3.9351417286346817`*^9, 
   3.9351417296350403`*^9}},ExpressionUUID->"20aa5ce1-a8ab-5f4b-b7b1-\
0405258e8457"],

Cell["last two lines take quite a while (~5 min)", "Text",
 CellChangeTimes->{
  3.935054119648446*^9, {3.9350541518052397`*^9, 
   3.935054156511533*^9}},ExpressionUUID->"baf57b4b-7491-4eaa-989f-\
e1c4c200e779"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"metric", " ", "=", " ", 
    RowBox[{
     RowBox[{"ResourceFunction", "[", "\"\<MetricTensor\>\"", "]"}], "[", 
     RowBox[{"G", ",", " ", 
      RowBox[{"{", 
       RowBox[{"t", ",", " ", "r", ",", " ", "theta", ",", " ", "phi"}], 
       "}"}], ",", " ", "True", ",", "\n", "     ", "True"}], "]"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"riemann", " ", "=", " ", 
    RowBox[{
     RowBox[{"ResourceFunction", "[", "\"\<RiemannTensor\>\"", "]"}], "[", 
     "metric", "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"riemann2", " ", "=", " ", 
    RowBox[{"riemann", "[", "\"\<CovariantRiemannTensor\>\"", "]"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{"AbsoluteTiming", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Robs", " ", "=", " ", 
    RowBox[{"riemann2", "[", "\"\<ReducedTensorRepresentation\>\"", "]"}]}], ";",
    "\[IndentingNewLine]", 
   RowBox[{"RobsH", "=", 
    RowBox[{"riemann", "[", "\"\<ReducedTensorRepresentation\>\"", "]"}]}], 
   ";"}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"ricci", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"ResourceFunction", "[", "\"\<RicciTensor\>\"", "]"}], "[", 
       "metric", "]"}], "\[IndentingNewLine]", 
      RowBox[{"ricci", "[", "\"\<ReducedMatrixRepresentation\>\"", "]"}]}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ricci", "[", "\"\<RicciScalar\>\"", "]"}], "//", "Simplify"}]}],
    "*)"}]}]}], "Input",
 TaggingRules->{},
 CellChangeTimes->{{3.890858783291338*^9, 3.890858786030251*^9}, {
   3.933838779198169*^9, 3.933838787724444*^9}, {3.93383883210533*^9, 
   3.933838842651514*^9}, 3.933838894607758*^9, {3.933839077547245*^9, 
   3.933839091084046*^9}, {3.933839124934717*^9, 3.933839178735402*^9}, {
   3.9338392159192133`*^9, 3.933839272874041*^9}, {3.933839317608643*^9, 
   3.933839348699297*^9}, {3.933839416362228*^9, 3.933839425466824*^9}, {
   3.933839512467855*^9, 3.9338395317165203`*^9}, 3.933839617436264*^9, {
   3.933839683511662*^9, 3.9338397148694477`*^9}, {3.9338508983827877`*^9, 
   3.933850914383095*^9}, {3.933930564250897*^9, 3.933930565064574*^9}, {
   3.933939263988366*^9, 3.933939276112163*^9}, {3.934003700757827*^9, 
   3.934003701025343*^9}, {3.934018475370386*^9, 3.934018477632476*^9}, {
   3.934981179467906*^9, 3.934981186726612*^9}, {3.935084074744772*^9, 
   3.9350840748748*^9}},
 CellLabel->"In[528]:=",
 CellID->950018488,ExpressionUUID->"e7f59428-5420-1d45-acc2-071660c59879"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"87.692791`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{
  3.93498152181149*^9, 3.935050314454107*^9, 3.9350657867545357`*^9, 
   3.935084156961912*^9, 3.935137098165834*^9, 3.935246962251263*^9, {
   3.935250464229042*^9, 3.935250480260065*^9}, 3.9352576543679905`*^9, 
   3.935582994967211*^9, 3.935750456997259*^9, 3.936776044216055*^9, 
   3.9405226459321995`*^9, 3.940524410276785*^9, 3.9405246309687004`*^9, 
   3.9405305811381817`*^9, 3.9519449126023464`*^9, 3.9519450880318375`*^9, 
   3.9519463991760483`*^9},
 CellLabel->"Out[531]=",ExpressionUUID->"42f2b781-c24f-8640-a870-b6ea75044db3"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Riemann and Ricci tensors in LNRF", "Subsection",
 CellChangeTimes->{{3.93400582742299*^9, 3.9340058385818157`*^9}, {
  3.935050511259123*^9, 3.935050516525384*^9}, {3.935055246096229*^9, 
  3.93505525862047*^9}},ExpressionUUID->"0fb348d8-f1b2-864d-93f3-\
b26b1432e9b1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Rlnrf", "=", 
   RowBox[{"genRlnrf", "[", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"RlnrfH", "=", 
   RowBox[{"genRlnrfH", "[", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"RIClnrf", "=", 
   RowBox[{"genRIClnrf", "[", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{
  3.935050508147215*^9, {3.935053330034878*^9, 3.935053330230294*^9}},
 CellLabel->
  "In[532]:=",ExpressionUUID->"37f55650-fedc-484f-8e8c-832adccb3e3b"],

Cell["Check Ricci flatness with Q=0", "Text",
 CellChangeTimes->{{3.935054181582512*^9, 
  3.9350541980390873`*^9}},ExpressionUUID->"6e18ca4e-4960-49a7-a810-\
96a2896ebdf7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"RIClnrf", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"M", "->", "1"}], ",", " ", 
       RowBox[{"Q", "->", "0"}]}], "}"}]}], ",", " ", 
    RowBox[{"Assumptions", "->", "assume"}]}], "]"}], " ", "//", " ", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.934003791193665*^9, 3.93400380101388*^9}, {
   3.9340040609500318`*^9, 3.934004101292737*^9}, {3.934022577912411*^9, 
   3.934022579361907*^9}, {3.934022656948678*^9, 3.934022673994715*^9}, {
   3.934022706497559*^9, 3.934022768040991*^9}, 3.934282640958331*^9, {
   3.934283459507721*^9, 3.934283469930155*^9}, {3.934868646425581*^9, 
   3.934868658514599*^9}, {3.935050544785515*^9, 3.935050546751646*^9}, {
   3.935141782193528*^9, 3.935141798345166*^9}, 3.935246997970197*^9},
 CellLabel->
  "In[535]:=",ExpressionUUID->"d4efc434-4a4d-594f-9936-c1db043cf80a"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.934283463974764*^9, 3.934283491397263*^9}, 
   3.934284020812423*^9, 3.9343602502398*^9, {3.934868634810278*^9, 
   3.934868659798898*^9}, 3.934978557063002*^9, 3.934978616231942*^9, {
   3.935050540014135*^9, 3.9350505470716257`*^9}, 3.93506581547355*^9, 
   3.9350841734526424`*^9, {3.935141779199731*^9, 3.935141798664583*^9}, {
   3.935246981917246*^9, 3.9352470006749487`*^9}, 3.935583046641157*^9, 
   3.935750483830226*^9, 3.9367760705108356`*^9, 3.93677810764007*^9, 
   3.940522675039379*^9, 3.9405244130114727`*^9, 3.9405246540620995`*^9, 
   3.940530604846657*^9, 3.9519449427154503`*^9, 3.951946436997671*^9},
 CellLabel->
  "Out[535]//MatrixForm=",ExpressionUUID->"6732f02d-ceca-894c-a6b5-\
7ac3aa0f9d7d"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Velocity vector in LNRF", "Subsection",
 CellChangeTimes->{{3.9340058605886083`*^9, 3.9340058835653477`*^9}, 
   3.935055262714489*^9},ExpressionUUID->"c634655f-8d16-f04f-a9ff-\
c7812ed006e5"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"U", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{"dt", ",", " ", "dr", ",", " ", "dtheta", ",", " ", "dphi"}], 
     "}"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"Ulnrf", "=", 
   RowBox[{"genUlnrf", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ulnrf", " ", "//", "MatrixForm"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"UlnrfN", " ", "=", 
   RowBox[{"Simplify", " ", "[", 
    RowBox[{
     RowBox[{"Ulnrf", "/", 
      RowBox[{"Part", "[", 
       RowBox[{"Ulnrf", ",", "1"}], "]"}]}], ",", 
     RowBox[{"Assumptions", "->", "assume"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"UlnrfN", "=", 
   RowBox[{"UlnrfN", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Abs", "[", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["a", "2"], "+", 
           SuperscriptBox["r", "2"]}], ")"}], "2"], "-", 
        RowBox[{
         SuperscriptBox["a", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["a", "2"], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "2"}], "+", "r"}], ")"}], " ", "r"}]}], ")"}], " ", 
         SuperscriptBox[
          RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], "]"}], " ", "->", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["a", "2"], "+", 
          SuperscriptBox["r", "2"]}], ")"}], "2"], "-", 
       RowBox[{
        SuperscriptBox["a", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["a", "2"], "-", 
          RowBox[{"2", "*", "r"}], "+", 
          SuperscriptBox["r", "2"]}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}]}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"UlnrfN", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.933851675577676*^9, 3.933851686760352*^9}, {
   3.933851735891951*^9, 3.933851756204345*^9}, {3.933851827320006*^9, 
   3.933851958670968*^9}, {3.933932352683338*^9, 3.933932354375801*^9}, {
   3.933933286353787*^9, 3.933933297034184*^9}, {3.933933989737817*^9, 
   3.933933991537427*^9}, {3.933934127933151*^9, 3.9339341295235157`*^9}, {
   3.933940818863429*^9, 3.933940819858439*^9}, {3.9339408594684143`*^9, 
   3.933940860222914*^9}, {3.934001475112189*^9, 3.934001480459841*^9}, {
   3.934003813542688*^9, 3.934003814048861*^9}, {3.934012293335507*^9, 
   3.934012313386685*^9}, {3.934013027602186*^9, 3.93401303513273*^9}, {
   3.934018893738085*^9, 3.9340189004969597`*^9}, {3.9342873119342003`*^9, 
   3.9342873387068663`*^9}, {3.935050576550626*^9, 3.935050588430151*^9}, {
   3.935050697220103*^9, 3.93505074411895*^9}, {3.936778211546294*^9, 
   3.9367782398571997`*^9}, 3.936778462359747*^9, {3.9519464529848576`*^9, 
   3.95194648371047*^9}},
 CellLabel->
  "In[547]:=",ExpressionUUID->"bbb3b868-ef02-d043-82ac-6db52f99a920"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{"dt", " ", 
        SqrtBox[
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["a", "2"], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "2"}], "+", "r"}], ")"}], " ", "r"}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["r", "2"], "+", 
             RowBox[{
              SuperscriptBox["a", "2"], " ", 
              SuperscriptBox[
               RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}]}], 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["a", "2"], "+", 
              SuperscriptBox["r", "2"]}], ")"}], "2"], "-", 
           RowBox[{
            SuperscriptBox["a", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["a", "2"], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "2"}], "+", "r"}], ")"}], " ", "r"}]}], ")"}], " ", 
            SuperscriptBox[
             RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}]]]}]},
      {
       RowBox[{"dr", " ", 
        SqrtBox[
         FractionBox[
          RowBox[{
           SuperscriptBox["r", "2"], "+", 
           RowBox[{
            SuperscriptBox["a", "2"], " ", 
            SuperscriptBox[
             RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], 
          RowBox[{
           SuperscriptBox["a", "2"], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "2"}], "+", "r"}], ")"}], " ", "r"}]}]]]}]},
      {
       RowBox[{"dtheta", " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["r", "2"], "+", 
          RowBox[{
           SuperscriptBox["a", "2"], " ", 
           SuperscriptBox[
            RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}]]}]},
      {
       RowBox[{
        RowBox[{"Sin", "[", "theta", "]"}], " ", 
        SqrtBox[
         FractionBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["a", "2"], "+", 
              SuperscriptBox["r", "2"]}], ")"}], "2"], "-", 
           RowBox[{
            SuperscriptBox["a", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["a", "2"], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "2"}], "+", "r"}], ")"}], " ", "r"}]}], ")"}], " ", 
            SuperscriptBox[
             RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], 
          RowBox[{
           SuperscriptBox["r", "2"], "+", 
           RowBox[{
            SuperscriptBox["a", "2"], " ", 
            SuperscriptBox[
             RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}]]], " ", 
        RowBox[{"(", 
         RowBox[{"dphi", "+", 
          FractionBox[
           RowBox[{"2", " ", "a", " ", "dt", " ", "r"}], 
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["a", "2"], "+", 
                SuperscriptBox["r", "2"]}], ")"}], "2"]}], "+", 
            RowBox[{
             SuperscriptBox["a", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["a", "2"], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "2"}], "+", "r"}], ")"}], " ", "r"}]}], ")"}], 
             " ", 
             SuperscriptBox[
              RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}]]}], ")"}]}]}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.9339332973313*^9, 3.933933992071515*^9, 3.933934129849415*^9, 
   3.933935308195323*^9, 3.933935685136438*^9, 3.9339364260200863`*^9, 
   3.933940820175276*^9, 3.933940860497727*^9, {3.934001471645872*^9, 
   3.9340014808960333`*^9}, 3.934004123570328*^9, 3.934004938133095*^9, 
   3.934005213712189*^9, 3.934005288954352*^9, 3.934005334777742*^9, 
   3.934012313653006*^9, 3.934013035454797*^9, 3.934014193423417*^9, 
   3.934017840273621*^9, {3.934018895097146*^9, 3.934018901058065*^9}, 
   3.934024387583971*^9, 3.93428265042798*^9, 3.934283236076844*^9, 
   3.934283544120026*^9, 3.934284181312636*^9, 3.934285360334037*^9, {
   3.934287304330793*^9, 3.934287338932934*^9}, 3.934287406357931*^9, 
   3.934348488118412*^9, 3.934360255145986*^9, 3.934360296441523*^9, 
   3.934360344119531*^9, 3.93436682145949*^9, 3.934375411912318*^9, 
   3.934484939320122*^9, 3.9345402605057077`*^9, 3.9348080302915173`*^9, 
   3.934868666031741*^9, 3.9348687922031107`*^9, 3.934978617780509*^9, 
   3.934981605282173*^9, 3.935050589473458*^9, 3.935050640517662*^9, {
   3.935050683034323*^9, 3.935050704287129*^9}, 3.9350507451352863`*^9, 
   3.935065816401063*^9, 3.935084174058779*^9, 3.9351418039290667`*^9, 
   3.935247005399332*^9, 3.9352582109994383`*^9, 3.935583047628825*^9, 
   3.935750484723117*^9, 3.936776071410666*^9, 3.9367781107717867`*^9, 
   3.9367781506522207`*^9, {3.936778234862081*^9, 3.936778240617352*^9}, 
   3.936778463323721*^9, 3.9405226763053455`*^9, 3.9405242055154247`*^9, 
   3.9405244166055126`*^9, 3.940524655213272*^9, 3.9405306060598183`*^9, 
   3.951944943233536*^9, {3.951946444634716*^9, 3.951946484402851*^9}},
 CellLabel->
  "Out[549]//MatrixForm=",ExpressionUUID->"87e7c883-f063-cf4d-8819-\
55dd09c974a4"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {"1"},
      {
       FractionBox["dr", 
        RowBox[{"dt", " ", 
         SqrtBox[
          FractionBox[
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["a", "2"], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "2"}], "+", "r"}], ")"}], " ", "r"}]}], ")"}], 
            "2"], 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["a", "2"], "+", 
               SuperscriptBox["r", "2"]}], ")"}], "2"], "-", 
            RowBox[{
             SuperscriptBox["a", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["a", "2"], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "2"}], "+", "r"}], ")"}], " ", "r"}]}], ")"}], 
             " ", 
             SuperscriptBox[
              RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}]]]}]]},
      {
       FractionBox["dtheta", 
        RowBox[{"dt", " ", 
         SqrtBox[
          FractionBox[
           RowBox[{
            SuperscriptBox["a", "2"], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "2"}], "+", "r"}], ")"}], " ", "r"}]}], 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["a", "2"], "+", 
               SuperscriptBox["r", "2"]}], ")"}], "2"], "-", 
            RowBox[{
             SuperscriptBox["a", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["a", "2"], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "2"}], "+", "r"}], ")"}], " ", "r"}]}], ")"}], 
             " ", 
             SuperscriptBox[
              RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}]]]}]]},
      {
       FractionBox[
        RowBox[{
         RowBox[{"Sin", "[", "theta", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["a", "2"], "+", 
              SuperscriptBox["r", "2"]}], ")"}], "2"], "-", 
           RowBox[{
            SuperscriptBox["a", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["a", "2"], "-", 
              RowBox[{"2", " ", "r"}], "+", 
              SuperscriptBox["r", "2"]}], ")"}], " ", 
            SuperscriptBox[
             RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"dphi", "+", 
           FractionBox[
            RowBox[{"2", " ", "a", " ", "dt", " ", "r"}], 
            RowBox[{
             RowBox[{"-", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["a", "2"], "+", 
                 SuperscriptBox["r", "2"]}], ")"}], "2"]}], "+", 
             RowBox[{
              SuperscriptBox["a", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["a", "2"], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "2"}], "+", "r"}], ")"}], " ", "r"}]}], ")"}],
               " ", 
              SuperscriptBox[
               RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}]]}], ")"}]}], 
        RowBox[{"dt", " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox["a", "2"], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "2"}], "+", "r"}], ")"}], " ", "r"}]}]], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["r", "2"], "+", 
           RowBox[{
            SuperscriptBox["a", "2"], " ", 
            SuperscriptBox[
             RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}]}]]}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.9339332973313*^9, 3.933933992071515*^9, 3.933934129849415*^9, 
   3.933935308195323*^9, 3.933935685136438*^9, 3.9339364260200863`*^9, 
   3.933940820175276*^9, 3.933940860497727*^9, {3.934001471645872*^9, 
   3.9340014808960333`*^9}, 3.934004123570328*^9, 3.934004938133095*^9, 
   3.934005213712189*^9, 3.934005288954352*^9, 3.934005334777742*^9, 
   3.934012313653006*^9, 3.934013035454797*^9, 3.934014193423417*^9, 
   3.934017840273621*^9, {3.934018895097146*^9, 3.934018901058065*^9}, 
   3.934024387583971*^9, 3.93428265042798*^9, 3.934283236076844*^9, 
   3.934283544120026*^9, 3.934284181312636*^9, 3.934285360334037*^9, {
   3.934287304330793*^9, 3.934287338932934*^9}, 3.934287406357931*^9, 
   3.934348488118412*^9, 3.934360255145986*^9, 3.934360296441523*^9, 
   3.934360344119531*^9, 3.93436682145949*^9, 3.934375411912318*^9, 
   3.934484939320122*^9, 3.9345402605057077`*^9, 3.9348080302915173`*^9, 
   3.934868666031741*^9, 3.9348687922031107`*^9, 3.934978617780509*^9, 
   3.934981605282173*^9, 3.935050589473458*^9, 3.935050640517662*^9, {
   3.935050683034323*^9, 3.935050704287129*^9}, 3.9350507451352863`*^9, 
   3.935065816401063*^9, 3.935084174058779*^9, 3.9351418039290667`*^9, 
   3.935247005399332*^9, 3.9352582109994383`*^9, 3.935583047628825*^9, 
   3.935750484723117*^9, 3.936776071410666*^9, 3.9367781107717867`*^9, 
   3.9367781506522207`*^9, {3.936778234862081*^9, 3.936778240617352*^9}, 
   3.936778463323721*^9, 3.9405226763053455`*^9, 3.9405242055154247`*^9, 
   3.9405244166055126`*^9, 3.940524655213272*^9, 3.9405306060598183`*^9, 
   3.951944943233536*^9, {3.951946444634716*^9, 3.9519464846068726`*^9}},
 CellLabel->
  "Out[552]//MatrixForm=",ExpressionUUID->"cfc91c8a-5859-934e-9946-\
982334920fcc"]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["3. Compute Tidal Tensors and Test", "Section",
 CellChangeTimes->{{3.934005891057271*^9, 3.934005895421377*^9}, {
  3.9350542893627777`*^9, 3.935054303775754*^9}, {3.935055321429405*^9, 
  3.935055321646806*^9}},ExpressionUUID->"4fd9ff9b-cf85-8f4d-9d7a-\
e5fd5eccf79b"],

Cell[CellGroupData[{

Cell["Tidal tensor in different frames", "Subsection",
 CellChangeTimes->{{3.935054367421761*^9, 3.9350543917158537`*^9}, {
  3.935054444470669*^9, 3.9350544457369328`*^9}, {3.935055267011847*^9, 
  3.9350552758019114`*^9}},ExpressionUUID->"c8d820af-330c-488a-a919-\
8130b9f677e0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clnrf", "=", 
   RowBox[{"genClnrf", "[", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ClnrfH", "=", 
   RowBox[{"genClnrfH", "[", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Cobs", "=", 
   RowBox[{"genCobs", "[", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"CobsH", "=", 
   RowBox[{"genCobsH", "[", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.933853077732523*^9, 3.933853095775056*^9}, {
   3.93385341737712*^9, 3.933853424761711*^9}, {3.9338544386413116`*^9, 
   3.933854441425411*^9}, 3.9339323495542088`*^9, {3.93480804458367*^9, 
   3.934808047112509*^9}, 3.9350507847694407`*^9},
 CellLabel->
  "In[553]:=",ExpressionUUID->"d50d875e-e2d3-8f47-af56-ad99d0d3354e"],

Cell["\<\
Lorentz boost to local free falling frame to get local tensor\
\>", "Text",
 CellChangeTimes->{{3.934005908155973*^9, 3.934005924355298*^9}, {
  3.935051450303854*^9, 3.9350514544332314`*^9}, {3.935054451382663*^9, 
  3.935054471575951*^9}},ExpressionUUID->"435a4df2-1188-9d49-83b7-\
f2766ad91827"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"lorentz", " ", "=", " ", 
   RowBox[{"genLorentz", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lorentzinv", "=", 
   RowBox[{"genLorentzinv", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClocH", " ", "=", " ", 
   RowBox[{"genClocH", "[", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBmIQfTDveVub/1vHyoifvSB63Wzj5g4gvWzu1jYQPaXM
aBuI/hVkvR1EH3Bpugeieb6veACiP0e0/AfRFqkNDJ1AernihLXdQPoF//71
3WD91zaDaL7W49tB9A8uiT0g+vWjiftBNJP381M9QNpb+A2YPsETdRFEPw/Y
9hxE/4i/9RlEr3gs/xNEq2wW+QeizbfkCvYCaS1XjwwQvcLdF0xLX2NPNwp4
67jHlxdMN6x2XtYc+NZx5dSSdSB62WGdzSC6Zk7XThC9rvHMXhB9I5zrEIhe
FRF6CkTLXToPpucJa5vGB711DPgVAqYB8R+fGw==
  "],
 CellLabel->
  "In[562]:=",ExpressionUUID->"1c21f494-e612-4442-8f8c-dbca43a3b0d0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"RlocH", "=", 
   RowBox[{"genRlocH", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClocHalt", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Part", "[", 
      RowBox[{"RlocH", ",", "i0", ",", "1", ",", "j0", ",", "1"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i0", ",", "1", ",", "4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j0", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.9405308656053123`*^9, 3.9405309213483143`*^9}},
 CellLabel->
  "In[565]:=",ExpressionUUID->"7a2f1781-cd72-1c49-a2e1-7632b17d3b1c"],

Cell["\<\
Check trace of tidal tensors, zero if Q=0
Note that first integrals of geodesic equation are substituted in\
\>", "Text",
 CellChangeTimes->{{3.93400590026748*^9, 3.934005904396336*^9}, {
  3.935050867943159*^9, 3.93505087886307*^9}, {3.935500722838395*^9, 
  3.935500738816711*^9}},ExpressionUUID->"ce6aae26-f7f6-4271-b8bc-\
c8a5fd636b36"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"test", "=", 
   RowBox[{
    RowBox[{"Tr", "[", "ClnrfH", "]"}], "/.", "dsub"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"test", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"M", "->", "1"}], ",", 
      RowBox[{"a", "->", ".5"}], ",", 
      RowBox[{"Q", "->", "0"}], ",", 
      RowBox[{"e", "->", "0"}], ",", 
      RowBox[{"ep", "->", "1"}], ",", 
      RowBox[{"lz", "->", "1"}], ",", 
      RowBox[{"q", "->", "0"}], ",", 
      RowBox[{"r", "->", "3"}], ",", 
      RowBox[{"theta", "->", 
       RowBox[{"Pi", "/", "2"}]}]}], "}"}]}], ",", 
   RowBox[{"Assumptions", "->", "assume"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"test", "=", 
   RowBox[{
    RowBox[{"Tr", "[", "CobsH", "]"}], "/.", "dsub"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"test", "/.", 
    RowBox[{"{", 
     RowBox[{"Q", "->", "0"}], "}"}]}], ",", 
   RowBox[{"Assumptions", "->", "assume"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"test", "=", 
   RowBox[{
    RowBox[{"Tr", "[", "ClocH", "]"}], "/.", "dsub"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"test", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"M", "->", "1"}], ",", 
      RowBox[{"a", "->", ".5"}], ",", 
      RowBox[{"Q", "->", "0"}], ",", 
      RowBox[{"e", "->", "0"}], ",", 
      RowBox[{"ep", "->", "1"}], ",", 
      RowBox[{"lz", "->", "1"}], ",", 
      RowBox[{"q", "->", "0"}], ",", 
      RowBox[{"r", "->", "3"}], ",", 
      RowBox[{"theta", "->", 
       RowBox[{"Pi", "/", "2"}]}]}], "}"}]}], ",", 
   RowBox[{"Assumptions", "->", "assume"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"test", "=", 
   RowBox[{
    RowBox[{"Tr", "[", "ClocHalt", "]"}], "/.", "dsub"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"test", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"M", "->", "1"}], ",", 
      RowBox[{"a", "->", ".5"}], ",", 
      RowBox[{"Q", "->", "0"}], ",", 
      RowBox[{"e", "->", "0"}], ",", 
      RowBox[{"ep", "->", "1"}], ",", 
      RowBox[{"lz", "->", "1"}], ",", 
      RowBox[{"q", "->", "0"}], ",", 
      RowBox[{"r", "->", "3"}], ",", 
      RowBox[{"theta", "->", 
       RowBox[{"Pi", "/", "2"}]}]}], "}"}]}], ",", 
   RowBox[{"Assumptions", "->", "assume"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.934013533068023*^9, 3.9340135918519297`*^9}, {
  3.934013692163581*^9, 3.934013748064051*^9}, {3.934019145801316*^9, 
  3.934019153773118*^9}, {3.934284231344943*^9, 3.93428423156833*^9}, {
  3.9342854433675957`*^9, 3.934285443484338*^9}, {3.934288218062892*^9, 
  3.9342882306380367`*^9}, {3.934360403048534*^9, 3.934360403101972*^9}, {
  3.934868870403389*^9, 3.934868880803039*^9}, {3.935051364547426*^9, 
  3.935051433718364*^9}, {3.9350514674218197`*^9, 3.935051518182713*^9}, {
  3.940530929838854*^9, 3.940530931885996*^9}},
 CellLabel->
  "In[441]:=",ExpressionUUID->"c46e751f-e224-c642-9f50-a93e692fbd14"],

Cell[BoxData[
 RowBox[{"-", "2.7755575615628914`*^-17"}]], "Output",
 CellChangeTimes->{
  3.934021881105573*^9, 3.934021972791271*^9, 3.934024440854426*^9, 
   3.9340321604009113`*^9, 3.934283578886213*^9, {3.934284226800846*^9, 
   3.934284232375947*^9}, {3.934285438265156*^9, 3.934285444617446*^9}, 
   3.934287871853967*^9, {3.934288212394031*^9, 3.934288231041123*^9}, 
   3.934348508604311*^9, {3.934360398722095*^9, 3.934360403318028*^9}, 
   3.934366856271817*^9, 3.9343754451890907`*^9, {3.934868866135215*^9, 
   3.934868881154461*^9}, 3.9349787171592703`*^9, {3.935051357478956*^9, 
   3.9350513651092463`*^9}, {3.935051404912303*^9, 3.93505140948622*^9}, {
   3.9350514616684837`*^9, 3.935051518930759*^9}, 3.935065818985527*^9, 
   3.935084175622134*^9, 3.935141822766638*^9, 3.93524703598603*^9, 
   3.936778160682808*^9, 3.936778267980792*^9, 3.940522691342695*^9, 
   3.9405242153201923`*^9, {3.9405246580430984`*^9, 3.9405246666218567`*^9}, 
   3.9405309346707764`*^9, 3.951944972552225*^9, 3.951945353417639*^9, 
   3.951945440180231*^9, 3.9519459688774033`*^9},
 CellLabel->
  "Out[442]=",ExpressionUUID->"af284df2-4cc5-ee43-9854-fae708a5fc31"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.934021881105573*^9, 3.934021972791271*^9, 3.934024440854426*^9, 
   3.9340321604009113`*^9, 3.934283578886213*^9, {3.934284226800846*^9, 
   3.934284232375947*^9}, {3.934285438265156*^9, 3.934285444617446*^9}, 
   3.934287871853967*^9, {3.934288212394031*^9, 3.934288231041123*^9}, 
   3.934348508604311*^9, {3.934360398722095*^9, 3.934360403318028*^9}, 
   3.934366856271817*^9, 3.9343754451890907`*^9, {3.934868866135215*^9, 
   3.934868881154461*^9}, 3.9349787171592703`*^9, {3.935051357478956*^9, 
   3.9350513651092463`*^9}, {3.935051404912303*^9, 3.93505140948622*^9}, {
   3.9350514616684837`*^9, 3.935051518930759*^9}, 3.935065818985527*^9, 
   3.935084175622134*^9, 3.935141822766638*^9, 3.93524703598603*^9, 
   3.936778160682808*^9, 3.936778267980792*^9, 3.940522691342695*^9, 
   3.9405242153201923`*^9, {3.9405246580430984`*^9, 3.9405246666218567`*^9}, 
   3.9405309346707764`*^9, 3.951944972552225*^9, 3.951945353417639*^9, 
   3.951945440180231*^9, 3.95194596911331*^9},
 CellLabel->
  "Out[444]=",ExpressionUUID->"23198ac0-9f7f-c949-978a-f337bae53b83"],

Cell[BoxData[
 RowBox[{"-", "1.1102230246251565`*^-16"}]], "Output",
 CellChangeTimes->{
  3.934021881105573*^9, 3.934021972791271*^9, 3.934024440854426*^9, 
   3.9340321604009113`*^9, 3.934283578886213*^9, {3.934284226800846*^9, 
   3.934284232375947*^9}, {3.934285438265156*^9, 3.934285444617446*^9}, 
   3.934287871853967*^9, {3.934288212394031*^9, 3.934288231041123*^9}, 
   3.934348508604311*^9, {3.934360398722095*^9, 3.934360403318028*^9}, 
   3.934366856271817*^9, 3.9343754451890907`*^9, {3.934868866135215*^9, 
   3.934868881154461*^9}, 3.9349787171592703`*^9, {3.935051357478956*^9, 
   3.9350513651092463`*^9}, {3.935051404912303*^9, 3.93505140948622*^9}, {
   3.9350514616684837`*^9, 3.935051518930759*^9}, 3.935065818985527*^9, 
   3.935084175622134*^9, 3.935141822766638*^9, 3.93524703598603*^9, 
   3.936778160682808*^9, 3.936778267980792*^9, 3.940522691342695*^9, 
   3.9405242153201923`*^9, {3.9405246580430984`*^9, 3.9405246666218567`*^9}, 
   3.9405309346707764`*^9, 3.951944972552225*^9, 3.951945353417639*^9, 
   3.951945440180231*^9, 3.9519459692078056`*^9},
 CellLabel->
  "Out[446]=",ExpressionUUID->"849edecb-569d-6d48-9220-28153303e8e3"],

Cell[BoxData[
 RowBox[{"-", "5.551115123125783`*^-17"}]], "Output",
 CellChangeTimes->{
  3.934021881105573*^9, 3.934021972791271*^9, 3.934024440854426*^9, 
   3.9340321604009113`*^9, 3.934283578886213*^9, {3.934284226800846*^9, 
   3.934284232375947*^9}, {3.934285438265156*^9, 3.934285444617446*^9}, 
   3.934287871853967*^9, {3.934288212394031*^9, 3.934288231041123*^9}, 
   3.934348508604311*^9, {3.934360398722095*^9, 3.934360403318028*^9}, 
   3.934366856271817*^9, 3.9343754451890907`*^9, {3.934868866135215*^9, 
   3.934868881154461*^9}, 3.9349787171592703`*^9, {3.935051357478956*^9, 
   3.9350513651092463`*^9}, {3.935051404912303*^9, 3.93505140948622*^9}, {
   3.9350514616684837`*^9, 3.935051518930759*^9}, 3.935065818985527*^9, 
   3.935084175622134*^9, 3.935141822766638*^9, 3.93524703598603*^9, 
   3.936778160682808*^9, 3.936778267980792*^9, 3.940522691342695*^9, 
   3.9405242153201923`*^9, {3.9405246580430984`*^9, 3.9405246666218567`*^9}, 
   3.9405309346707764`*^9, 3.951944972552225*^9, 3.951945353417639*^9, 
   3.951945440180231*^9, 3.9519459693579807`*^9},
 CellLabel->"Out[448]=",ExpressionUUID->"4327533b-5374-9c44-b969-059a69ec5c92"]
}, Open  ]],

Cell["Check determinant of tidal tensors", "Text",
 CellChangeTimes->{{3.935148161881599*^9, 
  3.935148167234693*^9}},ExpressionUUID->"159b94f4-45dd-431e-8f88-\
22c548ef13fd"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"test", "=", 
   RowBox[{
    RowBox[{"Det", "[", "ClocHalt", "]"}], "/.", "dsub"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"test", "/.", 
    RowBox[{"{", 
     RowBox[{"M", "->", "1"}], "}"}]}], ",", 
   RowBox[{"Assumptions", "->", "assume"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.935148170278261*^9, 3.935148196200309*^9}, {
   3.935148255036672*^9, 3.935148256522995*^9}, {3.935148296993862*^9, 
   3.935148298666018*^9}, {3.935148463518319*^9, 3.935148510448696*^9}, 
   3.935247060804165*^9, {3.9405309451919594`*^9, 3.9405309837957745`*^9}},
 CellLabel->
  "In[567]:=",ExpressionUUID->"583177db-0737-4f5f-a334-3c877f0b224f"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{{3.935148186593994*^9, 3.935148202281328*^9}, 
   3.935148262314911*^9, {3.935148462058482*^9, 3.93514851080492*^9}, 
   3.935247061367012*^9, 3.9367781643166933`*^9, 3.936778272010971*^9, 
   3.940522696885412*^9, 3.940524228054455*^9, {3.9405246608853474`*^9, 
   3.9405246673355484`*^9}, {3.9405309577496433`*^9, 3.9405309843908043`*^9}, 
   3.9519449795702705`*^9, 3.9519453614982376`*^9, 3.9519459757523174`*^9, 
   3.951946513564272*^9},
 CellLabel->"Out[568]=",ExpressionUUID->"2ffbe470-d63e-e340-8c12-d57cc7f7edf1"]
}, Open  ]],

Cell["Substitute first integrals to 4-velocity", "Text",
 CellChangeTimes->{{3.935054322278577*^9, 
  3.93505433388964*^9}},ExpressionUUID->"b963aeff-6dee-42b0-96c5-\
f076cfc9051e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"reduced", "=", 
   RowBox[{"ClocH", "/.", "dsub"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"reducedalt", "=", 
    RowBox[{"ClocHalt", "/.", "dsub"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Part", "[", 
        RowBox[{"reducedalt", ",", "1", ",", "i"}], "]"}], "=", "0"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Part", "[", 
        RowBox[{"reducedalt", ",", "i", ",", "1"}], "]"}], "=", "0"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}], ";"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Save", " ", "expression", " ", "to", " ", "a", " ", "txt", " ", "file", " ",
     "for", " ", "later", " ", "use"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DeleteFile", "[", "\"\<reduced_kerr.wl\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Save", "[", 
   RowBox[{"\"\<reduced_kerr.wl\>\"", ",", "reducedalt"}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.934014330982134*^9, 3.934014359502892*^9}, {
   3.934014400360059*^9, 3.9340144012110023`*^9}, 3.934019192477337*^9, {
   3.934019414602813*^9, 3.934019417153653*^9}, 3.934022257721741*^9, 
   3.934028255542144*^9, {3.934032163486808*^9, 3.934032165951445*^9}, 
   3.935141830055061*^9, {3.935750057771373*^9, 3.935750068537837*^9}, {
   3.935750198729993*^9, 3.935750226250093*^9}, {3.935750382905612*^9, 
   3.935750403737678*^9}, {3.935750549234702*^9, 3.935750579316642*^9}, {
   3.93575069914612*^9, 3.935750699349195*^9}, 3.935750748777122*^9, {
   3.935750782878722*^9, 3.935750783368514*^9}, {3.935750824888731*^9, 
   3.93575082626796*^9}, {3.935750878140646*^9, 3.935750886475389*^9}, {
   3.9357510698219633`*^9, 3.93575107974932*^9}, {3.935751129924722*^9, 
   3.93575113004977*^9}, 3.940522700932495*^9, 3.9405244607332935`*^9, 
   3.940530993748043*^9, {3.9405310516450996`*^9, 3.940531058166361*^9}, {
   3.9519454980515575`*^9, 3.9519455033761883`*^9}, {3.951945571309244*^9, 
   3.9519455722394104`*^9}, {3.9519460239358807`*^9, 3.9519461124011097`*^9}, 
   3.951946518855919*^9, {3.9519466212886276`*^9, 3.9519466287787724`*^9}},
 CellLabel->
  "In[579]:=",ExpressionUUID->"4475f096-b450-5f4c-b13a-81af0beae3e8"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"reducedalt", "[", 
    RowBox[{"[", "1", "]"}], "]"}], "[", 
   RowBox[{"[", "3", "]"}], "]"}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.951945483922325*^9, 3.9519454904136925`*^9}, {
  3.9519455629972935`*^9, 3.9519455862839317`*^9}, {3.95194599033498*^9, 
  3.9519459906088524`*^9}, {3.9519460824898643`*^9, 3.9519460844627495`*^9}, {
  3.951946541353857*^9, 3.951946543471794*^9}, {3.951946641125696*^9, 
  3.951946642566551*^9}},
 CellLabel->
  "In[583]:=",ExpressionUUID->"c5686603-fc91-4245-9bce-136c664e1a56"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.951945487672575*^9, 3.9519454913673897`*^9}, {
   3.951945567461937*^9, 3.951945589116087*^9}, {3.951945986765253*^9, 
   3.951946012247019*^9}, {3.9519460854776917`*^9, 3.951946098983984*^9}, {
   3.9519465268988514`*^9, 3.951946545761677*^9}, 3.9519466455511875`*^9},
 CellLabel->"Out[583]=",ExpressionUUID->"35a61f2e-5731-ff4e-9205-2e879a802695"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Test against previous literature", "Subsection",
 CellChangeTimes->{{3.935054488951998*^9, 
  3.935054497083933*^9}},ExpressionUUID->"0b0d8c38-5959-4cb2-8402-\
743151c97d2c"],

Cell["\<\
IBSO solver, plus for lz>0 and minus for lz<0
Note that carterk must be non-negative\
\>", "Text",
 CellChangeTimes->{{3.935051973095094*^9, 3.935051975199043*^9}, {
  3.935052036470067*^9, 3.9350520477793283`*^9}, {3.935052489240758*^9, 
  3.9350524976399927`*^9}, {3.935054431622481*^9, 3.935054434284334*^9}, {
  3.935088221728325*^9, 
  3.935088222544508*^9}},ExpressionUUID->"cefea732-0c58-40a7-937f-\
a719a8f954cc"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"spintemp", "=", "0.5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"chargetemp", "=", "0.5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"lamtemp", "=", "0.5"}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"sol1", "=", 
  RowBox[{
   RowBox[{"solplus", "[", 
    RowBox[{"spintemp", ",", "chargetemp", ",", "lamtemp"}], "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"r", "->", "rsol"}], "/.", " ", "sol1"}], ",", 
    RowBox[{"lz", "->", 
     RowBox[{"momentum", "[", 
      RowBox[{
       RowBox[{"rsol", "/.", " ", "sol1"}], ",", "spintemp", ",", 
       "chargetemp"}], "]"}]}], ",", 
    RowBox[{"cart", "->", 
     RowBox[{"carterk", "[", 
      RowBox[{
       RowBox[{"rsol", "/.", " ", "sol1"}], ",", "spintemp", ",", 
       "chargetemp"}], "]"}]}], ",", 
    RowBox[{"q", "->", 
     RowBox[{"carterq", "[", 
      RowBox[{
       RowBox[{"rsol", "/.", " ", "sol1"}], ",", "spintemp", ",", 
       "chargetemp"}], "]"}]}]}], "}"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"sol2", "=", 
   RowBox[{
    RowBox[{"solminus", "[", 
     RowBox[{"spintemp", ",", "chargetemp", ",", "lamtemp"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"r", "->", "rsol"}], "/.", " ", "sol2"}], ",", 
   RowBox[{"lz", "->", 
    RowBox[{"momentum", "[", 
     RowBox[{
      RowBox[{"rsol", "/.", " ", "sol2"}], ",", "spintemp", ",", 
      "chargetemp"}], "]"}]}], ",", 
   RowBox[{"cart", "->", 
    RowBox[{"carterk", "[", 
     RowBox[{
      RowBox[{"rsol", "/.", " ", "sol2"}], ",", "spintemp", ",", 
      "chargetemp"}], "]"}]}], ",", 
   RowBox[{"q", "->", 
    RowBox[{"carterq", "[", 
     RowBox[{
      RowBox[{"rsol", "/.", " ", "sol2"}], ",", "spintemp", ",", 
      "chargetemp"}], "]"}]}]}], "}"}]}], "Input",
 CellChangeTimes->{{3.935051980692952*^9, 3.935052145634298*^9}, {
   3.935052260150812*^9, 3.935052419973954*^9}, {3.935052455359934*^9, 
   3.9350524753591805`*^9}, {3.935052606613579*^9, 3.935052616160876*^9}, {
   3.935052823827266*^9, 3.93505282407407*^9}, {3.935052862523212*^9, 
   3.93505293578688*^9}, {3.9350876542243004`*^9, 3.935087654316323*^9}, {
   3.935088213620491*^9, 3.935088213780527*^9}, {3.935088261090278*^9, 
   3.935088261219309*^9}, {3.935141863453864*^9, 3.935141888944558*^9}, {
   3.935142450546044*^9, 3.935142450851448*^9}, 3.9352478178138685`*^9, 
   3.9352478679211407`*^9, {3.935248028811298*^9, 3.9352480432816706`*^9}, {
   3.9352489542315874`*^9, 3.9352489543486013`*^9}, {3.935249604318819*^9, 
   3.935249658531662*^9}, {3.940945576721182*^9, 3.9409455771163197`*^9}, {
   3.9409456121609955`*^9, 3.940945615789871*^9}, {3.9409456761623783`*^9, 
   3.940945676696829*^9}, {3.9409457185786457`*^9, 3.9409457188724213`*^9}, {
   3.940945794785677*^9, 3.940945873991947*^9}, {3.940946002105692*^9, 
   3.9409460114015903`*^9}, {3.940946078696396*^9, 3.94094608592206*^9}, {
   3.9409462818741703`*^9, 3.940946281955658*^9}},
 CellLabel->
  "In[155]:=",ExpressionUUID->"e704c0ad-ebc6-4350-a9ad-0daab7e6d221"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
   "rsol", "\[Rule]", 
    "2.70141826077975129460149602950400393254`15.698970004336019"}], ",", 
   RowBox[{
   "lzsol", "\[Rule]", 
    "2.86369929069063538900486451086446802342`15.698970004336019"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.935052023617093*^9, 3.93505205496021*^9, 3.935052085772092*^9, {
   3.935052124872468*^9, 3.935052146281838*^9}, 3.9350522564550533`*^9, {
   3.935052286692318*^9, 3.935052323585663*^9}, {3.935052384428192*^9, 
   3.935052420789935*^9}, {3.93505245581828*^9, 3.935052475698008*^9}, 
   3.935052618658119*^9, 3.935052820005951*^9, {3.93505286458292*^9, 
   3.935052936189437*^9}, 3.935065821468672*^9, 3.93508417701845*^9, 
   3.935087573648027*^9, 3.9350876547304153`*^9, 3.935087885579286*^9, 
   3.935087981443081*^9, {3.935088215767977*^9, 3.935088225916271*^9}, 
   3.9350882616203976`*^9, {3.935141857001359*^9, 3.93514188949674*^9}, 
   3.935142451263585*^9, 3.935247819707815*^9, 3.935247868259746*^9, {
   3.935248029556123*^9, 3.9352480435813637`*^9}, 3.935248954865602*^9, {
   3.935249605174722*^9, 3.935249658926922*^9}, 3.936778165139915*^9, {
   3.9405246619309883`*^9, 3.940524678783188*^9}, {3.9409455725522404`*^9, 
   3.940945577584364*^9}, 3.9409456174599266`*^9, 3.940945677215025*^9, 
   3.940945719181135*^9, {3.940945795150316*^9, 3.940945874244772*^9}, {
   3.9409460024906883`*^9, 3.9409460120853577`*^9}, {3.9409460790717545`*^9, 
   3.940946086183037*^9}, 3.9409462824346123`*^9},
 CellLabel->
  "Out[158]=",ExpressionUUID->"1f62e6e4-7405-c447-91df-736ed8b70602"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
   "r", "\[Rule]", 
    "2.70141826077975129460149602950400393254`15.698970004336019"}], ",", 
   RowBox[{"lz", "\[Rule]", "2.8636992906906378`"}], ",", 
   RowBox[{"cart", "\[Rule]", "8.320665545978764`"}], ",", 
   RowBox[{"q", "\[Rule]", "2.73359120916734`"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.935052023617093*^9, 3.93505205496021*^9, 3.935052085772092*^9, {
   3.935052124872468*^9, 3.935052146281838*^9}, 3.9350522564550533`*^9, {
   3.935052286692318*^9, 3.935052323585663*^9}, {3.935052384428192*^9, 
   3.935052420789935*^9}, {3.93505245581828*^9, 3.935052475698008*^9}, 
   3.935052618658119*^9, 3.935052820005951*^9, {3.93505286458292*^9, 
   3.935052936189437*^9}, 3.935065821468672*^9, 3.93508417701845*^9, 
   3.935087573648027*^9, 3.9350876547304153`*^9, 3.935087885579286*^9, 
   3.935087981443081*^9, {3.935088215767977*^9, 3.935088225916271*^9}, 
   3.9350882616203976`*^9, {3.935141857001359*^9, 3.93514188949674*^9}, 
   3.935142451263585*^9, 3.935247819707815*^9, 3.935247868259746*^9, {
   3.935248029556123*^9, 3.9352480435813637`*^9}, 3.935248954865602*^9, {
   3.935249605174722*^9, 3.935249658926922*^9}, 3.936778165139915*^9, {
   3.9405246619309883`*^9, 3.940524678783188*^9}, {3.9409455725522404`*^9, 
   3.940945577584364*^9}, 3.9409456174599266`*^9, 3.940945677215025*^9, 
   3.940945719181135*^9, {3.940945795150316*^9, 3.940945874244772*^9}, {
   3.9409460024906883`*^9, 3.9409460120853577`*^9}, {3.9409460790717545`*^9, 
   3.940946086183037*^9}, 3.9409462826953087`*^9},
 CellLabel->
  "Out[159]=",ExpressionUUID->"e3987e77-5943-b84a-81e6-ebdf6cab4baf"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
   "r", "\[Rule]", 
    "4.56069712334621182581463852097449222147`15.698970004336019"}], ",", 
   RowBox[{"lz", "\[Rule]", 
    RowBox[{"-", "3.706296713124471`"}]}], ",", 
   RowBox[{"cart", "\[Rule]", "22.271810480747465`"}], ",", 
   RowBox[{"q", "\[Rule]", "4.578878441905733`"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.935052023617093*^9, 3.93505205496021*^9, 3.935052085772092*^9, {
   3.935052124872468*^9, 3.935052146281838*^9}, 3.9350522564550533`*^9, {
   3.935052286692318*^9, 3.935052323585663*^9}, {3.935052384428192*^9, 
   3.935052420789935*^9}, {3.93505245581828*^9, 3.935052475698008*^9}, 
   3.935052618658119*^9, 3.935052820005951*^9, {3.93505286458292*^9, 
   3.935052936189437*^9}, 3.935065821468672*^9, 3.93508417701845*^9, 
   3.935087573648027*^9, 3.9350876547304153`*^9, 3.935087885579286*^9, 
   3.935087981443081*^9, {3.935088215767977*^9, 3.935088225916271*^9}, 
   3.9350882616203976`*^9, {3.935141857001359*^9, 3.93514188949674*^9}, 
   3.935142451263585*^9, 3.935247819707815*^9, 3.935247868259746*^9, {
   3.935248029556123*^9, 3.9352480435813637`*^9}, 3.935248954865602*^9, {
   3.935249605174722*^9, 3.935249658926922*^9}, 3.936778165139915*^9, {
   3.9405246619309883`*^9, 3.940524678783188*^9}, {3.9409455725522404`*^9, 
   3.940945577584364*^9}, 3.9409456174599266`*^9, 3.940945677215025*^9, 
   3.940945719181135*^9, {3.940945795150316*^9, 3.940945874244772*^9}, {
   3.9409460024906883`*^9, 3.9409460120853577`*^9}, {3.9409460790717545`*^9, 
   3.940946086183037*^9}, 3.940946282951582*^9},
 CellLabel->"Out[161]=",ExpressionUUID->"ae6f4b55-4b49-8543-898a-0f283ba5ca32"]
}, Open  ]],

Cell["\<\
Check Marck calculation, only works for Q=0
May use IBSO above\
\>", "Text",
 CellChangeTimes->{{3.934484801181835*^9, 3.934484804726633*^9}, {
   3.935052553107987*^9, 3.9350525895094624`*^9}, 3.935054504571957*^9, {
   3.93524966302297*^9, 
   3.9352496647336216`*^9}},ExpressionUUID->"2a12e2b8-a341-e242-b6ba-\
6bc758f5e12c"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Msub", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"asub", "=", "0.5"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Qsub", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lamsub", "=", "0.5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"esub", "=", "0.0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"epsub", "=", "1.0"}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sol1", "=", 
   RowBox[{
    RowBox[{"solplus", "[", 
     RowBox[{"asub", ",", "Qsub", ",", "lamsub"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ibsoplus", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"r", "->", "rsol"}], "/.", " ", "sol1"}], ",", 
     RowBox[{"lz", "->", 
      RowBox[{"momentum", "[", 
       RowBox[{
        RowBox[{"rsol", "/.", " ", "sol1"}], ",", "asub", ",", "Qsub"}], 
       "]"}]}], ",", 
     RowBox[{"cart", "->", 
      RowBox[{"carterk", "[", 
       RowBox[{
        RowBox[{"rsol", "/.", " ", "sol1"}], ",", "asub", ",", "Qsub"}], 
       "]"}]}], ",", 
     RowBox[{"q", "->", 
      RowBox[{"carterq", "[", 
       RowBox[{
        RowBox[{"rsol", "/.", " ", "sol1"}], ",", "asub", ",", "Qsub"}], 
       "]"}]}]}], "}"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"qsub", "=", 
   RowBox[{"q", "/.", "ibsoplus"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"lzsub", "=", 
   RowBox[{"lz", "/.", "ibsoplus"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ksub", "=", 
    RowBox[{"cart", "/.", "ibsoplus"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rsub", "=", 
   RowBox[{"r", "/.", "ibsoplus"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"thetasub", "=", 
    RowBox[{"Pi", "/", "2"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"sublist", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"M", "->", "Msub"}], ",", 
      RowBox[{"a", "->", "asub"}], ",", 
      RowBox[{"Q", "->", "Qsub"}], ",", 
      RowBox[{"e", "->", "esub"}], ",", 
      RowBox[{"ep", "->", "epsub"}], ",", 
      RowBox[{"q", "->", "qsub"}], ",", 
      RowBox[{"lz", "->", "lzsub"}], ",", 
      RowBox[{"r", "->", "rsub"}], ",", 
      RowBox[{"theta", "->", "thetasub"}], ",", 
      RowBox[{"cart", "->", "ksub"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vels", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"dt", ",", "dr", ",", "dtheta", ",", "dphi"}], "}"}], "/.", " ", 
    "dsub"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"vels", "/.", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"M", "->", "Msub"}], ",", 
      RowBox[{"a", "->", "asub"}], ",", 
      RowBox[{"Q", "->", "Qsub"}], ",", 
      RowBox[{"e", "->", "esub"}], ",", 
      RowBox[{"ep", "->", "epsub"}], ",", 
      RowBox[{"q", "->", "qsub"}], ",", 
      RowBox[{"lz", "->", "lzsub"}], ",", 
      RowBox[{"r", "->", "rsub"}], ",", 
      RowBox[{"theta", "->", "thetasub"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"I1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"M", "*", 
        RowBox[{"r", "^", "3"}]}], "-", 
       RowBox[{
        RowBox[{"r", "^", "2"}], "*", 
        RowBox[{"Q", "^", "2"}]}]}], ")"}], "/", 
     RowBox[{"Sigma", "^", "3"}]}], "/.", 
    RowBox[{"{", 
     RowBox[{"theta", "->", 
      RowBox[{"Pi", "/", "2"}]}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"C11", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"3", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"r", "^", "2"}], "+", "cart"}], ")"}], "*", "cart", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Cos", "[", "kappa", "]"}], "^", "2"}], ")"}], "*", 
       RowBox[{
        RowBox[{"r", "^", "2"}], "/", 
        RowBox[{"(", 
         RowBox[{"cart", "*", 
          RowBox[{"r", "^", "4"}]}], ")"}]}]}]}], ")"}], "*", "I1"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"C33", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"3", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"r", "^", "2"}], "+", "cart"}], ")"}], "*", "cart", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Sin", "[", "kappa", "]"}], "^", "2"}], ")"}], "*", 
       RowBox[{
        RowBox[{"r", "^", "2"}], "/", 
        RowBox[{"(", 
         RowBox[{"cart", "*", 
          RowBox[{"r", "^", "4"}]}], ")"}]}]}]}], ")"}], "*", "I1"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"C13", "=", 
   RowBox[{"3", "*", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"r", "^", "2"}], "+", "cart"}], ")"}], "*", "cart", "*", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Sin", "[", "kappa", "]"}], "*", 
      RowBox[{"Cos", "[", "kappa", "]"}]}], ")"}], "*", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"r", "^", "2"}]}], "*", "I1"}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"cart", "*", 
       RowBox[{"r", "^", "4"}]}], ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"C22", "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"3", "*", 
        RowBox[{"cart", "/", 
         RowBox[{"r", "^", "2"}]}]}]}], ")"}], "/", 
     RowBox[{"r", "^", "3"}]}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"check1", "=", 
   RowBox[{
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"C11", "+", "C33", "-", 
        RowBox[{"Sqrt", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"C11", "-", "C33"}], ")"}], "^", "2"}], "+", 
          RowBox[{"4", "*", 
           RowBox[{"(", 
            RowBox[{"C13", "^", "2"}], ")"}]}]}], "]"}]}], ")"}], "/", "2"}], 
     "]"}], "/.", "sublist"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"check2", "=", 
   RowBox[{
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"C11", "+", "C33", "+", 
        RowBox[{"Sqrt", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"C11", "-", "C33"}], ")"}], "^", "2"}], "+", 
          RowBox[{"4", "*", 
           RowBox[{"(", 
            RowBox[{"C13", "^", "2"}], ")"}]}]}], "]"}]}], ")"}], "/", "2"}], 
     "]"}], "/.", "sublist"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"check3", "=", 
    RowBox[{
     RowBox[{"Simplify", "[", "C22", "]"}], "/.", "sublist"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"check", "=", 
    RowBox[{"{", 
     RowBox[{"check1", ",", "check2", ",", "check3"}], "}"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"for", " ", "theta"}], " ", "=", " ", 
    RowBox[{"PI", "/", "2"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<check=\>\"", ",", " ", "check"}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Chop", "[", 
   RowBox[{"Eigensystem", "[", 
    RowBox[{"reduced", "/.", " ", "sublist"}], "]"}], "]"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Chop", "[", 
   RowBox[{"Eigensystem", "[", 
    RowBox[{"reducedalt", "/.", " ", "sublist"}], "]"}], "]"}], "//", 
  "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.934019323796913*^9, 3.934019360269251*^9}, {
   3.934019393348624*^9, 3.934019401635276*^9}, 3.9340194457583313`*^9, {
   3.934019479984554*^9, 3.934019575411964*^9}, {3.934019773858533*^9, 
   3.934019854291856*^9}, {3.934019964902627*^9, 3.934020095001525*^9}, {
   3.934020172157627*^9, 3.934020181558871*^9}, {3.934020236571426*^9, 
   3.934020338912859*^9}, {3.934020515439679*^9, 3.934020515874386*^9}, {
   3.934021899219335*^9, 3.934021929437701*^9}, {3.934022202351664*^9, 
   3.93402224169027*^9}, {3.934022275212919*^9, 3.934022299069587*^9}, {
   3.934022350958536*^9, 3.934022351071731*^9}, {3.934024457514798*^9, 
   3.934024462725731*^9}, {3.93402455892461*^9, 3.93402455911165*^9}, {
   3.93402488018326*^9, 3.934024912449438*^9}, {3.934025037400649*^9, 
   3.934025063137047*^9}, 3.934028293568824*^9, {3.934032064888123*^9, 
   3.9340320959830523`*^9}, {3.934033913772017*^9, 3.934033927199291*^9}, {
   3.934284279348919*^9, 3.934284309125951*^9}, {3.934285475128397*^9, 
   3.934285494384237*^9}, {3.934285551160387*^9, 3.934285620282139*^9}, {
   3.9342856829754267`*^9, 3.934285698233384*^9}, {3.934285736723222*^9, 
   3.93428573694352*^9}, {3.934286062353104*^9, 3.934286124415716*^9}, {
   3.9342863984217176`*^9, 3.934286415611139*^9}, {3.934286467810896*^9, 
   3.934286538074527*^9}, {3.934286674501676*^9, 3.9342866747117023`*^9}, {
   3.934286718549687*^9, 3.934286838552929*^9}, {3.934286869852493*^9, 
   3.934286903121421*^9}, {3.934351877235993*^9, 3.934351913504788*^9}, 
   3.934484960035338*^9, {3.934544381051055*^9, 3.934544409295388*^9}, {
   3.934808170085083*^9, 3.934808195987404*^9}, {3.93480822809095*^9, 
   3.934808242007677*^9}, {3.934868901594175*^9, 3.9348690096805363`*^9}, {
   3.934981649965255*^9, 3.934981692455407*^9}, {3.934981741413554*^9, 
   3.934981770683827*^9}, {3.93498243573498*^9, 3.9349825301464376`*^9}, {
   3.9349825668802633`*^9, 3.934982573036895*^9}, {3.934983014207176*^9, 
   3.934983036519724*^9}, {3.934983280827909*^9, 3.934983280884948*^9}, {
   3.934983326205014*^9, 3.934983381703175*^9}, {3.934983420501892*^9, 
   3.934983474963574*^9}, {3.934983834422393*^9, 3.934983863944755*^9}, {
   3.93498409953764*^9, 3.934984164751301*^9}, 3.93498421207614*^9, {
   3.935052895747128*^9, 3.935052905875105*^9}, {3.935052957043683*^9, 
   3.935052990247375*^9}, {3.935053028855157*^9, 3.935053079884991*^9}, {
   3.935053170822455*^9, 3.935053230031311*^9}, 3.935053602740798*^9, 
   3.935084284684017*^9, {3.9350843673128185`*^9, 3.9350846235416927`*^9}, {
   3.9350846610284233`*^9, 3.935084695831297*^9}, 3.93508476477512*^9, {
   3.935085891697321*^9, 3.935085891825348*^9}, {3.935085963393583*^9, 
   3.935085975989435*^9}, {3.935086009321029*^9, 3.935086047670759*^9}, {
   3.935086815090937*^9, 3.935086842224127*^9}, {3.935086918839712*^9, 
   3.935086919710909*^9}, {3.9350869519722557`*^9, 3.93508697254591*^9}, {
   3.935087012765066*^9, 3.9350870142444*^9}, 3.9350870655870647`*^9, {
   3.9350876022135353`*^9, 3.935087602920693*^9}, {3.935087659248438*^9, 
   3.9350876731801147`*^9}, {3.9350882767978325`*^9, 3.93508830543231*^9}, 
   3.935088336631422*^9, {3.935088368119547*^9, 3.935088409116873*^9}, {
   3.935088439280699*^9, 3.9350884699241667`*^9}, {3.9350885263039703`*^9, 
   3.935088528033359*^9}, 3.9352496850456285`*^9, {3.940531016317295*^9, 
   3.940531063754345*^9}},
 CellLabel->
  "In[381]:=",ExpressionUUID->"e8acfbce-cc78-e642-9799-827a8f58b57d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
   "r", "\[Rule]", 
    "3.02813075557873920313483859864775386433`15.698970004336019"}], ",", 
   RowBox[{"lz", "\[Rule]", "3.0243572199368822`"}], ",", 
   RowBox[{"cart", "\[Rule]", "9.421291571775573`"}], ",", 
   RowBox[{"q", "\[Rule]", "3.048912197928108`"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.9405310203214836`*^9, 3.940531030454233*^9}, 
   3.940531066413023*^9, {3.951945366771988*^9, 3.9519453785581036`*^9}, 
   3.951945452306095*^9},
 CellLabel->
  "Out[388]=",ExpressionUUID->"540eb462-7151-7d4b-bbf5-4d9316016bd3"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"check=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.18303788980237054`"}], ",", "0.03601439532165002`", ",", 
     "0.14702349448072058`"}], "}"}]}],
  SequenceForm[
  "check=", {-0.18303788980237054`, 0.03601439532165002, 
   0.14702349448072058`}],
  Editable->False]], "Print",
 CellChangeTimes->{{3.9405310208040104`*^9, 3.9405310307008553`*^9}, 
   3.9405310666486187`*^9, {3.9519453670433292`*^9, 3.9519453786121597`*^9}, 
   3.9519454523538094`*^9},
 CellLabel->
  "During evaluation of \
In[381]:=",ExpressionUUID->"d4562c71-d340-7f4f-bd19-a978c694b962"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "0.1830378898023705`"}], "0.14702349448072047`", 
      "0.036014395321649906`", "0"},
     {
      RowBox[{"{", 
       RowBox[{"0", ",", "1.`", ",", 
        RowBox[{"0.`", "\[VeryThinSpace]", "+", 
         RowBox[{"2.4584947490643497`*^-9", " ", "\[ImaginaryI]"}]}], ",", 
        RowBox[{"0.`", "\[VeryThinSpace]", "+", 
         RowBox[{"3.122322677355973`*^-9", " ", "\[ImaginaryI]"}]}]}], "}"}], 
      
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"0.`", "\[VeryThinSpace]", "-", 
         RowBox[{"3.361911497910178`*^-10", " ", "\[ImaginaryI]"}]}], ",", 
        "0.8351953079980272`", ",", 
        RowBox[{"-", "0.5499534503010964`"}]}], "}"}], 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"0.`", "\[VeryThinSpace]", "-", 
         RowBox[{"3.959806919978573`*^-9", " ", "\[ImaginaryI]"}]}], ",", 
        "0.5499534503010965`", ",", "0.8351953079980272`"}], "}"}], 
      RowBox[{"{", 
       RowBox[{"1.`", ",", "0", ",", "0", ",", "0"}], "}"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.9405310203214836`*^9, 3.940531030454233*^9}, 
   3.940531066413023*^9, {3.951945366771988*^9, 3.9519453785581036`*^9}, 
   3.95194545259437*^9},
 CellLabel->
  "Out[407]//MatrixForm=",ExpressionUUID->"052e165e-2f65-dd46-b48f-\
2ef6a19e41e3"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "0.1830378898023708`"}], "0.14702349448072066`", 
      "0.03601439532165001`", "0"},
     {
      RowBox[{"{", 
       RowBox[{"0", ",", "1.0000000000000002`", ",", 
        RowBox[{"0.`", "\[VeryThinSpace]", "+", 
         RowBox[{"2.45849474906433`*^-9", " ", "\[ImaginaryI]"}]}], ",", 
        RowBox[{"0.`", "\[VeryThinSpace]", "+", 
         RowBox[{"3.122322677355964`*^-9", " ", "\[ImaginaryI]"}]}]}], "}"}], 
      
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"0.`", "\[VeryThinSpace]", "-", 
         RowBox[{"3.361911497910382`*^-10", " ", "\[ImaginaryI]"}]}], ",", 
        "0.835195307998027`", ",", 
        RowBox[{"-", "0.5499534503010965`"}]}], "}"}], 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"0.`", "\[VeryThinSpace]", "-", 
         RowBox[{"3.959806919978598`*^-9", " ", "\[ImaginaryI]"}]}], ",", 
        "0.5499534503010965`", ",", "0.8351953079980272`"}], "}"}], 
      RowBox[{"{", 
       RowBox[{"1.`", ",", "0", ",", "0", ",", "0"}], "}"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.9405310203214836`*^9, 3.940531030454233*^9}, 
   3.940531066413023*^9, {3.951945366771988*^9, 3.9519453785581036`*^9}, 
   3.9519454531133385`*^9},
 CellLabel->
  "Out[408]//MatrixForm=",ExpressionUUID->"676f1f95-e3ab-334a-9ca6-\
d9092430c35e"]
}, Open  ]],

Cell["Check Limo calculation", "Text",
 CellChangeTimes->{{3.9344848091576385`*^9, 
  3.934484813733671*^9}},ExpressionUUID->"a17c6c78-7fc0-7b4c-a110-\
d16883652d45"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"rsub", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"thetasub", "=", "0.0000001"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"Effectively", " ", "zero"}], " ", "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Msub", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"asub", "=", "0.9"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Qsub", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"esub", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"epsub", "=", "1"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"qsub", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"lzsub", "=", "0"}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sublist", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"M", "->", "Msub"}], ",", 
      RowBox[{"a", "->", "asub"}], ",", 
      RowBox[{"Q", "->", "Qsub"}], ",", 
      RowBox[{"e", "->", "esub"}], ",", 
      RowBox[{"ep", "->", "epsub"}], ",", 
      RowBox[{"q", "->", "qsub"}], ",", 
      RowBox[{"lz", "->", "lzsub"}], ",", 
      RowBox[{"r", "->", "rsub"}], ",", 
      RowBox[{"theta", "->", "thetasub"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"check1", "=", 
    RowBox[{"Msub", "*", "rsub", "*", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"rsub", "^", "2"}], "-", 
        RowBox[{"3", "*", 
         RowBox[{"asub", "^", "2"}]}]}], ")"}], "/", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"rsub", "^", "2"}], "+", 
         RowBox[{"asub", "^", "2"}]}], ")"}], "^", "3"}]}]}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"for", " ", "theta"}], " ", "->", " ", "0"}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"check2", "=", 
    RowBox[{
     RowBox[{"-", "2"}], "*", "Msub", "*", "rsub", "*", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"rsub", "^", "2"}], "-", 
        RowBox[{"3", "*", 
         RowBox[{"asub", "^", "2"}]}]}], ")"}], "/", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"rsub", "^", "2"}], "+", 
         RowBox[{"asub", "^", "2"}]}], ")"}], "^", "3"}]}]}]}], " ", ";"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"for", " ", "theta"}], " ", "->", " ", "0"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"check3", "=", 
    RowBox[{"Msub", "*", "rsub", "*", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"rsub", "^", "2"}], "-", 
        RowBox[{"3", "*", 
         RowBox[{"asub", "^", "2"}]}]}], ")"}], "/", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"rsub", "^", "2"}], "+", 
         RowBox[{"asub", "^", "2"}]}], ")"}], "^", "3"}]}]}]}], " ", ";"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"for", " ", "theta"}], " ", "->", " ", "0"}], " ", "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<check = \>\"", ",", " ", 
    RowBox[{"{", 
     RowBox[{"check1", ",", " ", "check2", ",", " ", "check3"}], "}"}]}], 
   "]"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Chop", "[", 
   RowBox[{"Eigensystem", "[", 
    RowBox[{"reduced", "/.", " ", "sublist"}], "]"}], "]"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Chop", "[", 
   RowBox[{"Eigensystem", "[", 
    RowBox[{"reducedalt", "/.", " ", "sublist"}], "]"}], "]"}], "//", 
  "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.934019323796913*^9, 3.934019360269251*^9}, {
   3.934019393348624*^9, 3.934019401635276*^9}, 3.9340194457583313`*^9, {
   3.934019479984554*^9, 3.934019575411964*^9}, {3.934019773858533*^9, 
   3.934019854291856*^9}, {3.934019964902627*^9, 3.934020095001525*^9}, {
   3.934020172157627*^9, 3.934020181558871*^9}, {3.934020236571426*^9, 
   3.934020338912859*^9}, {3.934020515439679*^9, 3.934020515874386*^9}, {
   3.934021899219335*^9, 3.934021929437701*^9}, {3.934022202351664*^9, 
   3.93402224169027*^9}, {3.934022275212919*^9, 3.934022299069587*^9}, {
   3.934022350958536*^9, 3.934022351071731*^9}, {3.934024457514798*^9, 
   3.934024462725731*^9}, {3.93402455892461*^9, 3.93402455911165*^9}, {
   3.93402488018326*^9, 3.934024912449438*^9}, {3.934025037400649*^9, 
   3.934025063137047*^9}, 3.934028293568824*^9, {3.934032064888123*^9, 
   3.9340320959830523`*^9}, {3.934033913772017*^9, 3.934033927199291*^9}, {
   3.934284279348919*^9, 3.934284309125951*^9}, {3.934285475128397*^9, 
   3.934285494384237*^9}, {3.934285551160387*^9, 3.934285620282139*^9}, {
   3.9342856829754267`*^9, 3.934285698233384*^9}, {3.934285736723222*^9, 
   3.93428573694352*^9}, {3.934286062353104*^9, 3.934286124415716*^9}, {
   3.9342863984217176`*^9, 3.934286415611139*^9}, {3.934286467810896*^9, 
   3.934286538074527*^9}, {3.934286674501676*^9, 3.9342866747117023`*^9}, {
   3.934286718549687*^9, 3.934286838552929*^9}, {3.934286869852493*^9, 
   3.934286903121421*^9}, {3.934351877235993*^9, 3.934351913504788*^9}, {
   3.934484826484089*^9, 3.934484855244578*^9}, {3.934808266722937*^9, 
   3.934808284783447*^9}, {3.934869023014154*^9, 3.934869042826632*^9}, {
   3.934869662763193*^9, 3.934869663706465*^9}, {3.935053294844747*^9, 
   3.935053303652269*^9}, {3.940522735203266*^9, 3.940522735696354*^9}, {
   3.94052281681452*^9, 3.940522900939749*^9}, {3.9405231688559475`*^9, 
   3.940523213584902*^9}, 3.9405233186065674`*^9, 3.9405246998272057`*^9, {
   3.9405313161447315`*^9, 3.940531318448244*^9}},
 CellLabel->
  "In[331]:=",ExpressionUUID->"1c49cd10-0437-6a40-889f-87a46c1e2232"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"check = \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0.02087755334979914`", ",", 
     RowBox[{"-", "0.04175510669959828`"}], ",", "0.02087755334979914`"}], 
    "}"}]}],
  SequenceForm[
  "check = ", {0.02087755334979914, -0.04175510669959828, 
   0.02087755334979914}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.934808285704668*^9, 3.934869665577497*^9, 3.935053308834594*^9, 
   3.935065823229387*^9, 3.935084178838861*^9, 3.936778166431733*^9, {
   3.9405227087482014`*^9, 3.9405227360658855`*^9}, {3.940522818496847*^9, 
   3.940522901251055*^9}, {3.940523187215805*^9, 3.9405232138948975`*^9}, 
   3.9405233222116833`*^9, 3.940524242904337*^9, {3.940524664074068*^9, 
   3.94052470093169*^9}, 3.940531318856291*^9},
 CellLabel->
  "During evaluation of \
In[331]:=",ExpressionUUID->"874b98fa-0fef-3b4a-8fda-c7a333d68ca6"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "0.0417551066995986`"}], "0.02087755334979941`", 
      "0.020877553349799283`", "0"},
     {
      RowBox[{"{", 
       RowBox[{"0", ",", "0.9999999999999993`", ",", 
        RowBox[{"-", "3.436365836329003`*^-8"}], ",", 
        RowBox[{"-", "2.2472382961313544`*^-8"}]}], "}"}], 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"-", "3.4326399056539`*^-8"}], ",", 
        RowBox[{"-", "0.9999986290108965`"}], ",", "0.0016558913992849077`"}],
        "}"}], 
      RowBox[{"{", 
       RowBox[{
       "0", ",", "2.2529254637424292`*^-8", ",", "0.0016558913992841353`", ",",
         "0.9999986290108968`"}], "}"}], 
      RowBox[{"{", 
       RowBox[{"1.`", ",", "0", ",", "0", ",", "0"}], "}"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.934484979518659*^9, 3.934808217639524*^9, 3.9348082859899273`*^9, 
   3.934869666067173*^9, 3.935053309336665*^9, 3.935065823755372*^9, 
   3.935084179127926*^9, 3.936778167042685*^9, {3.940522709076065*^9, 
   3.940522736353899*^9}, {3.940522818788681*^9, 3.9405229015150166`*^9}, {
   3.9405231875313416`*^9, 3.940523214204052*^9}, 3.940523322499151*^9, 
   3.9405242431805325`*^9, {3.9405246643409176`*^9, 3.9405247012145767`*^9}, 
   3.9405313191485615`*^9},
 CellLabel->
  "Out[345]//MatrixForm=",ExpressionUUID->"911d22d9-6acb-854f-8d2c-\
76922b70083b"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "0.04175510669959848`"}], "0.02087755334979941`", 
      "0.020877553349799283`", "0"},
     {
      RowBox[{"{", 
       RowBox[{"0", ",", "0.9999999999999991`", ",", 
        RowBox[{"-", "3.436365791920082`*^-8"}], ",", 
        RowBox[{"-", "2.2472382961313557`*^-8"}]}], "}"}], 
      RowBox[{"{", 
       RowBox[{"0", ",", "3.30034092277387`*^-8", ",", "0.998318951327259`", ",", 
        RowBox[{"-", "0.0579592220517199`"}]}], "}"}], 
      RowBox[{"{", 
       RowBox[{
       "0", ",", "2.4426296679758153`*^-8", ",", "0.057959222051719106`", ",",
         "0.9983189513272593`"}], "}"}], 
      RowBox[{"{", 
       RowBox[{"1.`", ",", "0", ",", "0", ",", "0"}], "}"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.934484979518659*^9, 3.934808217639524*^9, 3.9348082859899273`*^9, 
   3.934869666067173*^9, 3.935053309336665*^9, 3.935065823755372*^9, 
   3.935084179127926*^9, 3.936778167042685*^9, {3.940522709076065*^9, 
   3.940522736353899*^9}, {3.940522818788681*^9, 3.9405229015150166`*^9}, {
   3.9405231875313416`*^9, 3.940523214204052*^9}, 3.940523322499151*^9, 
   3.9405242431805325`*^9, {3.9405246643409176`*^9, 3.9405247012145767`*^9}, 
   3.9405313194834976`*^9},
 CellLabel->
  "Out[346]//MatrixForm=",ExpressionUUID->"ec13f5eb-ee5d-2b47-9466-\
6bfa9537a90f"]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["4. Numerical Simulation", "Section",
 CellChangeTimes->{{3.935054593787402*^9, 3.935054611316845*^9}, {
  3.9350546586652813`*^9, 3.935054663895721*^9}, {3.9350553231772747`*^9, 
  3.9350553233580313`*^9}},ExpressionUUID->"e0ff0d42-93d7-4ded-b86f-\
54b3ebf374f1"],

Cell[CellGroupData[{

Cell["Output to C++ script", "Subsection",
 CellChangeTimes->{{3.934870256595592*^9, 3.9348702711282578`*^9}, {
   3.935053384883528*^9, 3.935053387037684*^9}, 3.935054627443027*^9, {
   3.935055849615714*^9, 
   3.935055850142995*^9}},ExpressionUUID->"606c3336-f837-4812-97c2-\
76d8e58c3542"],

Cell[TextData[{
 "Output metric tensor\n\nNote that the C++ integrator use the substitution:\n\
",
 StyleBox["\\chi = \\cos{\\theta}\nmeaning that:\nd\\theta = -\\frac{d\\chi}{\
\\sqrt{1-\\chi^2}}", "NaturalLanguageInput"]
}], "Text",
 CellChangeTimes->{{3.935055854271571*^9, 3.9350558609869823`*^9}, {
  3.9350562576638203`*^9, 3.935056281803115*^9}, {3.935056329951511*^9, 
  3.935056398401905*^9}, {3.9350564784305897`*^9, 
  3.935056507833523*^9}},ExpressionUUID->"292feb17-51c1-448d-a332-\
f41a1675cb71"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Gvar", "=", 
    RowBox[{"Simplify", "[", 
     RowBox[{"G", "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"theta", "->", 
         RowBox[{"ArcCos", "[", "chi", "]"}]}], ",", 
        RowBox[{"a", "->", "spin"}], ",", 
        RowBox[{"Q", "->", "charge"}]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Part", "[", 
    RowBox[{"Gvar", ",", "3", ",", "3"}], "]"}], "=", 
   RowBox[{
    RowBox[{"Part", "[", 
     RowBox[{"Gvar", ",", "3", ",", "3"}], "]"}], "/", 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"chi", "*", "chi"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Part", "[", 
    RowBox[{"Gvar", ",", "1", ",", "3"}], "]"}], "=", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"Part", "[", 
      RowBox[{"Gvar", ",", "1", ",", "3"}], "]"}]}], "/", 
    RowBox[{"Sqrt", "[", 
     RowBox[{"1", "-", 
      RowBox[{"chi", "*", "chi"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Part", "[", 
     RowBox[{"Gvar", ",", "3", ",", "1"}], "]"}], "=", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"Part", "[", 
       RowBox[{"Gvar", ",", "1", ",", "3"}], "]"}]}], "/", 
     RowBox[{"Sqrt", "[", 
      RowBox[{"1", "-", 
       RowBox[{"chi", "*", "chi"}]}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Gvar", "//", "MatrixForm"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"outputMetric", "[", "Gvar", "]"}]}], "Input",
 CellChangeTimes->{{3.935055918487063*^9, 3.935056002681406*^9}, {
  3.935056061002329*^9, 3.935056062459378*^9}, {3.935056096075734*^9, 
  3.935056134670217*^9}, {3.935056189342351*^9, 3.935056254760674*^9}, {
  3.935056608283061*^9, 3.935056608878586*^9}, {3.935057092643891*^9, 
  3.935057099539784*^9}, {3.9350654318318987`*^9, 3.935065437306563*^9}},
 CellLabel->
  "In[340]:=",ExpressionUUID->"f44e815d-fd3c-4a84-a426-4b881ab68602"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["charge", "2"], "-", 
         RowBox[{"2", " ", "M", " ", "r"}], "+", 
         SuperscriptBox["r", "2"], "+", 
         RowBox[{
          SuperscriptBox["chi", "2"], " ", 
          SuperscriptBox["spin", "2"]}]}], 
        RowBox[{
         SuperscriptBox["r", "2"], "+", 
         RowBox[{
          SuperscriptBox["chi", "2"], " ", 
          SuperscriptBox["spin", "2"]}]}]]}], "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SuperscriptBox["chi", "2"]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["charge", "2"], "-", 
           RowBox[{"2", " ", "M", " ", "r"}]}], ")"}], " ", "spin"}], 
        RowBox[{
         SuperscriptBox["r", "2"], "+", 
         RowBox[{
          SuperscriptBox["chi", "2"], " ", 
          SuperscriptBox["spin", "2"]}]}]]}]},
     {"0", 
      FractionBox[
       RowBox[{
        SuperscriptBox["r", "2"], "+", 
        RowBox[{
         SuperscriptBox["chi", "2"], " ", 
         SuperscriptBox["spin", "2"]}]}], 
       RowBox[{
        SuperscriptBox["charge", "2"], "-", 
        RowBox[{"2", " ", "M", " ", "r"}], "+", 
        SuperscriptBox["r", "2"], "+", 
        SuperscriptBox["spin", "2"]}]], "0", "0"},
     {"0", "0", 
      FractionBox[
       RowBox[{
        SuperscriptBox["r", "2"], "+", 
        RowBox[{
         SuperscriptBox["chi", "2"], " ", 
         SuperscriptBox["spin", "2"]}]}], 
       RowBox[{"1", "-", 
        SuperscriptBox["chi", "2"]}]], "0"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SuperscriptBox["chi", "2"]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["charge", "2"], "-", 
           RowBox[{"2", " ", "M", " ", "r"}]}], ")"}], " ", "spin"}], 
        RowBox[{
         SuperscriptBox["r", "2"], "+", 
         RowBox[{
          SuperscriptBox["chi", "2"], " ", 
          SuperscriptBox["spin", "2"]}]}]]}], "0", "0", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", 
          SuperscriptBox["chi", "2"]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["r", "2"], "+", 
             SuperscriptBox["spin", "2"]}], ")"}], "2"], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             SuperscriptBox["chi", "2"]}], ")"}], " ", 
           SuperscriptBox["spin", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["charge", "2"], "-", 
             RowBox[{"2", " ", "M", " ", "r"}], "+", 
             SuperscriptBox["r", "2"], "+", 
             SuperscriptBox["spin", "2"]}], ")"}]}]}], ")"}]}], 
       RowBox[{
        SuperscriptBox["r", "2"], "+", 
        RowBox[{
         SuperscriptBox["chi", "2"], " ", 
         SuperscriptBox["spin", "2"]}]}]]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.93505597598774*^9, 3.935056002954197*^9}, 
   3.93505622850777*^9, 3.935057107559075*^9, 3.9350658243445177`*^9, 
   3.9350841794419975`*^9, 3.9352470833694515`*^9, 3.9405247444061184`*^9},
 CellLabel->
  "Out[344]//MatrixForm=",ExpressionUUID->"1c6328be-23dc-f042-9c0a-\
df922de88e44"],

Cell[BoxData["\<\"metric.cpp\"\>"], "Output",
 CellChangeTimes->{{3.93505597598774*^9, 3.935056002954197*^9}, 
   3.93505622850777*^9, 3.935057107559075*^9, 3.9350658243445177`*^9, 
   3.9350841794419975`*^9, 3.9352470833694515`*^9, 3.9405247446274147`*^9},
 CellLabel->"Out[345]=",ExpressionUUID->"b4f48128-52f0-e444-b50c-3e63bb0bb4d8"]
}, Open  ]],

Cell["Output Christoffel symbols", "Text",
 CellChangeTimes->{{3.9350558648960447`*^9, 
  3.935055870880965*^9}},ExpressionUUID->"147e8c3b-5ada-4e0c-b808-\
507bf0b22694"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Christ", "=", 
   RowBox[{
    RowBox[{"ResourceFunction", "[", "\"\<ChristoffelSymbol\>\"", "]"}], "[", 
    
    RowBox[{"Gvar", ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "r", ",", "chi", ",", "phi"}], "}"}], ",", 
     RowBox[{"\"\<Kind\>\"", "->", "\"\<Second\>\""}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Christ", "=", 
    RowBox[{"FullSimplify", "[", "Christ", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"outputChristoffel", "[", "Christ", "]"}]}], "Input",
 CellChangeTimes->{{3.935056510087935*^9, 3.935056529360258*^9}, {
  3.93505658184906*^9, 3.935056603721183*^9}, {3.935057125580485*^9, 
  3.935057145203*^9}, {3.9350658900962763`*^9, 3.935065895435565*^9}},
 CellLabel->
  "In[346]:=",ExpressionUUID->"60394249-3873-44ce-a156-e7c9decda9bd"],

Cell[BoxData["\<\"christoffel.cpp\"\>"], "Output",
 CellChangeTimes->{
  3.935065825923655*^9, {3.935065896323494*^9, 3.93506592785251*^9}, 
   3.935084181937723*^9, 3.9352470938752117`*^9, 3.9405247461744766`*^9},
 CellLabel->"Out[348]=",ExpressionUUID->"a02a8aeb-9756-334b-ba7e-ef749c53daa8"]
}, Open  ]],

Cell["Output tidal tensor", "Text",
 CellChangeTimes->{{3.935055842211031*^9, 
  3.935055845908956*^9}},ExpressionUUID->"952ea4e4-685c-4902-b8ae-\
37916e76ce9c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"outputTidal", "[", 
  RowBox[{
   RowBox[{"ClocH", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"a", "->", "spin"}], ",", 
      RowBox[{"Q", "->", "charge"}]}], "}"}]}], 
   ",", "\"\<Cloc_newman.cpp\>\""}], "]"}]], "Input",
 CellChangeTimes->{
  3.934547620724804*^9, {3.934547750484136*^9, 3.934547769790041*^9}, {
   3.934547930317883*^9, 3.934547952224785*^9}, {3.934547998961447*^9, 
   3.934548019500717*^9}, {3.93454806604023*^9, 3.93454806627367*^9}, {
   3.934870252940656*^9, 3.9348703095929623`*^9}, {3.934870453513147*^9, 
   3.9348704679429293`*^9}, {3.935056628992484*^9, 3.935056630345982*^9}, {
   3.935065665277728*^9, 3.935065669674078*^9}},
 CellLabel->
  "In[349]:=",ExpressionUUID->"e32b31e4-1c7b-42cd-ac72-1cf7a9939e0e"],

Cell[BoxData["\<\"Cloc_newman.cpp\"\>"], "Output",
 CellChangeTimes->{3.93487046830886*^9, 3.934978746833601*^9, 
  3.935065826799101*^9, 3.93506593215939*^9, 3.935084182506851*^9, 
  3.935247095972349*^9, 3.9405247467764244`*^9},
 CellLabel->"Out[349]=",ExpressionUUID->"424e249f-56d1-1d40-aa00-6de6702f67bf"]
}, Open  ]]
}, Closed]]
}, Closed]]
}, Open  ]]
},
WindowSize->{766.8, 784.8},
WindowMargins->{{331.8, Automatic}, {Automatic, 15}},
WindowStatusArea->"",
PrivateNotebookOptions->{"FileOutlineCache"->False},
TaggingRules-><|"TryRealOnly" -> False|>,
CellContext->Notebook,
Magnification:>1.1 Inherited,
FrontEndVersion->"14.2 for Mac OS X ARM (64-bit) (December 26, 2024)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"36480ea3-62fe-4340-b1b6-b06d827c0d6b"
]

