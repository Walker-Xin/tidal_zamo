(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[    245450,       6361]
NotebookOptionsPosition[    238437,       6230]
NotebookOutlinePosition[    238908,       6249]
CellTagsIndexPosition[    238865,       6246]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Local Tidal Tensor via ZAMO", "Title",
 CellChangeTimes->{{3.935053924860917*^9, 
  3.935053943461486*^9}},ExpressionUUID->"16e929a7-d0a3-42bd-8425-\
5fe6587a4caa"],

Cell["\<\
A Unified Approach for Axisymmetric Spacetimes - Rotating Wormholes\
\>", "Subtitle",
 CellChangeTimes->{{3.9350552014790783`*^9, 3.935055213434576*^9}, {
  3.9350556245990343`*^9, 3.9350556258457527`*^9}, {3.97142259343825*^9, 
  3.971422613668137*^9}},ExpressionUUID->"98bfcee8-72d8-4f3e-afeb-\
66e7a6644858"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<`*\>\"", "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{
   "reset", " ", "ALL", " ", "variables", " ", "of", " ", "this", " ", 
    "notebook", " ", "context"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{
  3.933854951673094*^9, {3.935054949859747*^9, 3.935054984633556*^9}, {
   3.935055290227911*^9, 3.935055292198041*^9}, {3.935148580061857*^9, 
   3.9351485834819307`*^9}, {3.935148640876643*^9, 3.9351486562020683`*^9}, {
   3.935148691924416*^9, 3.935148693266941*^9}, {3.935148813298492*^9, 
   3.935148847458622*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"a3093947-3853-774a-841d-0c6bf4e2cbdf"],

Cell[CellGroupData[{

Cell["0. Define Helper Functions", "Section",
 CellChangeTimes->{{3.935054792536417*^9, 3.93505480129784*^9}, {
  3.935055311243207*^9, 
  3.935055312033422*^9}},ExpressionUUID->"5f924686-9550-4b1f-97d5-\
11d0f0d62160"],

Cell[CellGroupData[{

Cell["Code for optimising symbolic expressions to C++", "Subsection",
 CellChangeTimes->{{3.935054854935876*^9, 
  3.935054883663043*^9}},ExpressionUUID->"266c74b9-ee4f-4521-9adc-\
47bbfd6a6dc8"],

Cell["ref. https://github.com/ABHModels/raytransfer", "Text",
 CellChangeTimes->{{3.93505491642021*^9, 
  3.935054919625326*^9}},ExpressionUUID->"1541ac38-f1ea-4eb3-b4f2-\
b100322da472"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"::", "Package", "::"}], "*)"}], "\n", "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"BeginPackage", "[", "\"\<OptimizeExpressionToC`\>\"", "]"}], 
    ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"OptimizeExpressionToC", "::", "usage"}], 
     "=", "\"\<Generates optimized version of expression in C\>\""}], ";"}], 
   "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ExtractTags", "::", "usage"}], "=", "\"\<\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ClearTagText", "::", "usage"}], "=", "\"\<\>\""}], ";"}], "\n", 
   
   RowBox[{
    RowBox[{
     RowBox[{"TagExistQ", "::", "usage"}], "=", "\"\<\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"AppendToTag", "::", "usage"}], "=", "\"\<\>\""}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{"Begin", "[", "\"\<Private`\>\"", "]"}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"OptimizeExpressionToC", "[", "expr_List", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "optimizedExpr", ",", "mainExpr", ",", "n", ",", "m", ",", "defs", ",",
          "output"}], "}"}], ",", 
       RowBox[{
        RowBox[{"optimizedExpr", "=", 
         RowBox[{"Experimental`OptimizeExpression", "[", "expr", "]"}]}], ";", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"ToString", "@", 
            RowBox[{"optimizedExpr", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "0"}], "]"}], "]"}]}], 
           "==", "\"\<Block\>\""}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"n", "=", 
             RowBox[{"Length", "[", 
              RowBox[{"optimizedExpr", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
            RowBox[{"mainExpr", "=", 
             RowBox[{"optimizedExpr", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "2", ",", 
                RowBox[{"n", "+", "1"}]}], "]"}], "]"}]}], ";"}], "}"}], ",", 
          
          RowBox[{"{", 
           RowBox[{
            RowBox[{"n", "=", "0"}], ";", 
            RowBox[{"mainExpr", "=", 
             RowBox[{"Flatten", "@", 
              RowBox[{"{", 
               RowBox[{"optimizedExpr", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "}"}]}]}], ";"}], "}"}]}], 
         "]"}], ";", 
        RowBox[{"m", "=", 
         RowBox[{"Length", "[", "mainExpr", "]"}]}], ";", 
        RowBox[{"defs", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"\"\<double \>\"", "<>", 
            RowBox[{"ToString", "@", 
             RowBox[{"CForm", "@", 
              RowBox[{"optimizedExpr", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "2", ",", "i", ",", "1"}], "]"}], "]"}]}]}],
             "<>", "\"\< = \>\"", "<>", 
            RowBox[{"ToString", "@", 
             RowBox[{"CForm", "@", 
              RowBox[{"optimizedExpr", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "2", ",", "i", ",", "2"}], "]"}], "]"}]}]}],
             "<>", "\"\<;\>\""}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", 
        RowBox[{"output", "=", 
         RowBox[{"MapIndexed", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"\"\<out(\>\"", "<>", 
             RowBox[{"StringJoin", "@", 
              RowBox[{"Riffle", "[", 
               RowBox[{
                RowBox[{"ToString", "/@", 
                 RowBox[{"(", 
                  RowBox[{"#2", "-", "1"}], ")"}]}], ",", "\"\<\>\""}], 
               "]"}]}], "<>", "\"\<) = \>\"", "<>", 
             RowBox[{"ToString", "@", 
              RowBox[{"CForm", "@", "#1"}]}], "<>", "\"\<;\>\""}], "&"}], ",",
            "mainExpr", ",", 
           RowBox[{"{", 
            RowBox[{"ArrayDepth", "[", "mainExpr", "]"}], "}"}]}], "]"}]}], ";", 
        RowBox[{"StringReplace", "[", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{"defs", ",", "output"}], "]"}], ",", 
          RowBox[{"\"\<Compile_$\>\"", "->", "\"\<t\>\""}]}], "]"}]}]}], 
      "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{"End", "[", "]"}], ";"}], "\n", "Null", "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ExtractTags", "[", "string_String", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"regex", ",", "extractTag"}], "}"}], ",", 
       RowBox[{
        RowBox[{"regex", "=", 
         RowBox[{
         "RegularExpression", 
          "[", "\"\<\\\\n([^\\\\n]*)// (\\\\[|</?)([^\\\\]\\\\n]*)(\\\\]|>)[^\
\\\\n]*\\\\n\>\"", "]"}]}], ";", 
        RowBox[{
         RowBox[{"extractTag", "[", "bounds_", "]"}], ":=", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "substring", ",", "indentation", ",", "tagType", ",", "tag"}], 
            "}"}], ",", 
           RowBox[{
            RowBox[{"substring", "=", 
             RowBox[{"StringTake", "[", 
              RowBox[{"string", ",", "bounds"}], "]"}]}], ";", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"{", 
               RowBox[{"indentation", ",", "tagType", ",", "tag"}], "}"}], 
              "}"}], "=", 
             RowBox[{"StringCases", "[", 
              RowBox[{"substring", ",", 
               RowBox[{"regex", "->", 
                RowBox[{"{", 
                 RowBox[{"\"\<$1\>\"", ",", "\"\<$2\>\"", ",", "\"\<$3\>\""}],
                  "}"}]}]}], "]"}]}], ";", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{"\"\<indentation\>\"", "->", "indentation"}], ",", 
              RowBox[{"\"\<tagType\>\"", "->", "tagType"}], ",", 
              RowBox[{"\"\<tag\>\"", "->", "tag"}], ",", 
              RowBox[{"\"\<start\>\"", "->", 
               RowBox[{
                RowBox[{"bounds", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "+", "1"}]}], ",", 
              RowBox[{"\"\<end\>\"", "->", 
               RowBox[{"bounds", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}]}]}], "]"}]}], ";", 
        RowBox[{
         RowBox[{
          RowBox[{"extractTag", "[", "#", "]"}], "&"}], "/@", 
         RowBox[{"StringPosition", "[", 
          RowBox[{"string", ",", "regex"}], "]"}]}]}]}], "]"}]}], ";"}], "\n",
    "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"TagExistQ", "[", 
      RowBox[{"string_String", ",", "tag_String"}], "]"}], ":=", 
     RowBox[{"AnyTrue", "[", 
      RowBox[{
       RowBox[{"ExtractTags", "[", "string", "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "\"\<tag\>\"", "]"}], "]"}], "==", "tag"}], "&"}]}], 
      "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{"ClearTagText", "[", 
     RowBox[{"string_String", ",", "tag_String"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"tags", ",", "startTag", ",", "endTag", ",", "x"}], "}"}], ",", 
      RowBox[{
       RowBox[{"tags", "=", 
        RowBox[{"ExtractTags", "[", "string", "]"}]}], ";", 
       RowBox[{"startTag", "=", 
        RowBox[{"FirstCase", "[", 
         RowBox[{"tags", ",", 
          RowBox[{"x_", "/;", 
           RowBox[{
            RowBox[{
             RowBox[{"x", "[", 
              RowBox[{"[", "\"\<tag\>\"", "]"}], "]"}], "==", "tag"}], "&&", 
            RowBox[{
             RowBox[{"x", "[", 
              RowBox[{"[", "\"\<tagType\>\"", "]"}], "]"}], 
             "==", "\"\<<\>\""}]}]}]}], "]"}]}], ";", 
       RowBox[{"endTag", "=", 
        RowBox[{"FirstCase", "[", 
         RowBox[{"tags", ",", 
          RowBox[{"x_", "/;", 
           RowBox[{
            RowBox[{
             RowBox[{"x", "[", 
              RowBox[{"[", "\"\<tag\>\"", "]"}], "]"}], "==", "tag"}], "&&", 
            RowBox[{
             RowBox[{"x", "[", 
              RowBox[{"[", "\"\<tagType\>\"", "]"}], "]"}], 
             "==", "\"\<</\>\""}]}]}]}], "]"}]}], ";", 
       RowBox[{
        RowBox[{"StringTake", "[", 
         RowBox[{"string", ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"startTag", "[", 
             RowBox[{"[", "\"\<end\>\"", "]"}], "]"}]}], "}"}]}], "]"}], "<>", 
        RowBox[{"StringTake", "[", 
         RowBox[{"string", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"endTag", "[", 
             RowBox[{"[", "\"\<start\>\"", "]"}], "]"}], ",", 
            RowBox[{"StringLength", "[", "string", "]"}]}], "}"}]}], 
         "]"}]}]}]}], "]"}]}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"AppendToTag", "[", 
      RowBox[{"string_String", ",", "tag_String", ",", "linesToAppend_List"}],
       "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tags", ",", "startTag", ",", "indent", ",", "x"}], "}"}], ",", 
       RowBox[{
        RowBox[{"tags", "=", 
         RowBox[{"ExtractTags", "[", "string", "]"}]}], ";", 
        RowBox[{"startTag", "=", 
         RowBox[{"FirstCase", "[", 
          RowBox[{"tags", ",", 
           RowBox[{"x_", "/;", 
            RowBox[{
             RowBox[{
              RowBox[{"x", "[", 
               RowBox[{"[", "\"\<tag\>\"", "]"}], "]"}], "==", "tag"}], "&&", 
             
             RowBox[{
              RowBox[{"x", "[", 
               RowBox[{"[", "\"\<tagType\>\"", "]"}], "]"}], 
              "==", "\"\<<\>\""}]}]}]}], "]"}]}], ";", 
        RowBox[{"indent", "=", 
         RowBox[{"startTag", "[", 
          RowBox[{"[", "\"\<indentation\>\"", "]"}], "]"}]}], ";", 
        RowBox[{
         RowBox[{"StringTake", "[", 
          RowBox[{"string", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"startTag", "[", 
              RowBox[{"[", "\"\<end\>\"", "]"}], "]"}]}], "}"}]}], "]"}], "<>", 
         RowBox[{"StringRiffle", "[", 
          RowBox[{"linesToAppend", ",", 
           RowBox[{"{", 
            RowBox[{"indent", ",", 
             RowBox[{"\"\<\\n\>\"", "<>", "indent"}], ",", "\"\<\\n\>\""}], 
            "}"}]}], "]"}], "<>", 
         RowBox[{"StringTake", "[", 
          RowBox[{"string", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"startTag", "[", 
               RowBox[{"[", "\"\<end\>\"", "]"}], "]"}], "+", "1"}], ",", 
             RowBox[{"StringLength", "[", "string", "]"}]}], "}"}]}], 
          "]"}]}]}]}], "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"AppendToTag", "[", 
      RowBox[{
      "string_String", ",", "tag_String", ",", "stringToAppend_String"}], 
      "]"}], ":=", 
     RowBox[{"AppendToTag", "[", 
      RowBox[{"string", ",", "tag", ",", 
       RowBox[{"StringSplit", "[", 
        RowBox[{"stringToAppend", ",", "\"\<\\n\>\""}], "]"}]}], "]"}]}], 
    ";"}], "\n", "Null", "\n", "\n", 
   RowBox[{
    RowBox[{"EndPackage", "[", "]"}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.934547450354631*^9, {3.9348698658165197`*^9, 3.934869870264975*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"f21bef1c-65ef-4768-aab2-4366f8ad3ab3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"outputMetric", "[", 
    RowBox[{"matrix_", ",", 
     RowBox[{"filename_", ":", "\"\<metric.cpp\>\""}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "text", ",", "meat", ",", "header", ",", "footer", ",", "output"}], 
      "}"}], ",", 
     RowBox[{
      RowBox[{"text", "=", 
       RowBox[{"OptimizeExpressionToC", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"matrix", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"matrix", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"matrix", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"matrix", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "4", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"matrix", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"matrix", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"matrix", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"matrix", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", 
           RowBox[{"[", "4", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"matrix", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"matrix", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"matrix", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"matrix", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "[", 
           RowBox[{"[", "4", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"matrix", "[", 
            RowBox[{"[", "4", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"matrix", "[", 
            RowBox[{"[", "4", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"matrix", "[", 
            RowBox[{"[", "4", "]"}], "]"}], "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"matrix", "[", 
            RowBox[{"[", "4", "]"}], "]"}], "[", 
           RowBox[{"[", "4", "]"}], "]"}]}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"meat", "=", 
       RowBox[{"ToString", "[", 
        RowBox[{"Column", "[", 
         RowBox[{"StringReplace", "[", 
          RowBox[{"text", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\"\<Sqrt\>\"", "->", "\"\<sqrt\>\""}], ",", 
             RowBox[{"\"\<Power(E,\>\"", "->", "\"\<exp(\>\""}], ",", 
             RowBox[{"\"\<Power\>\"", "->", "\"\<pow\>\""}], ",", 
             RowBox[{"\"\<Sin\>\"", "->", "\"\<sin\>\""}], ",", 
             RowBox[{"\"\<Cos\>\"", "->", "\"\<cos\>\""}], ",", 
             RowBox[{"\"\<Csc\>\"", "->", "\"\<1/sin\>\""}], ",", 
             RowBox[{"\"\<Cot\>\"", "->", "\"\<1/tan\>\""}], ",", 
             RowBox[{"\"\<double\>\"", "->", "\"\<double\>\""}], ",", 
             RowBox[{"\"\<;,\>\"", "->", "\"\<;\\n    \>\""}], ",", 
             RowBox[{"\"\<out(0)\>\"", "->", "\"\<g[0][0]\>\""}], ",", 
             RowBox[{"\"\<out(1)\>\"", "->", "\"\<g[0][1]\>\""}], ",", 
             RowBox[{"\"\<out(2)\>\"", "->", "\"\<g[0][2]\>\""}], ",", 
             RowBox[{"\"\<out(3)\>\"", "->", "\"\<g[0][3]\>\""}], ",", 
             RowBox[{"\"\<out(4)\>\"", "->", "\"\<g[1][0]\>\""}], ",", 
             RowBox[{"\"\<out(5)\>\"", "->", "\"\<g[1][1]\>\""}], ",", 
             RowBox[{"\"\<out(6)\>\"", "->", "\"\<g[1][2]\>\""}], ",", 
             RowBox[{"\"\<out(7)\>\"", "->", "\"\<g[1][3]\>\""}], ",", 
             RowBox[{"\"\<out(8)\>\"", "->", "\"\<g[2][0]\>\""}], ",", 
             RowBox[{"\"\<out(9)\>\"", "->", "\"\<g[2][1]\>\""}], ",", 
             RowBox[{"\"\<out(10)\>\"", "->", "\"\<g[2][2]\>\""}], ",", 
             RowBox[{"\"\<out(11)\>\"", "->", "\"\<g[2][3]\>\""}], ",", 
             RowBox[{"\"\<out(12)\>\"", "->", "\"\<g[3][0]\>\""}], ",", 
             RowBox[{"\"\<out(13)\>\"", "->", "\"\<g[3][1]\>\""}], ",", 
             RowBox[{"\"\<out(14)\>\"", "->", "\"\<g[3][2]\>\""}], ",", 
             RowBox[{"\"\<out(15)\>\"", "->", "\"\<g[3][3]\>\""}]}], "}"}]}], 
          "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
      "header", 
       "=", "\"\<void metric(double r, double chi, double \
g[4][4])\\n{\\n\>\""}], ";", "\[IndentingNewLine]", 
      RowBox[{"footer", "=", "\"\<\\n}\>\""}], ";", "\[IndentingNewLine]", 
      RowBox[{"output", "=", 
       RowBox[{"header", "<>", "meat", "<>", "footer"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{"filename", ",", "output", ",", "\"\<Text\>\""}], "]"}]}]}], 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"outputChristoffel", "[", 
    RowBox[{"matrix_", ",", 
     RowBox[{"filename_", ":", "\"\<christoffel.cpp\>\""}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "text", ",", "meat", ",", "header", ",", "footer", ",", "output"}], 
      "}"}], ",", 
     RowBox[{
      RowBox[{"text", "=", 
       RowBox[{"OptimizeExpressionToC", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "4", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", 
           RowBox[{"[", "4", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", 
            RowBox[{"[", "3", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", 
            RowBox[{"[", "3", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", 
            RowBox[{"[", "3", "]"}], "]"}], "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", 
            RowBox[{"[", "3", "]"}], "]"}], "[", 
           RowBox[{"[", "4", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", 
            RowBox[{"[", "4", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", 
            RowBox[{"[", "4", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", 
            RowBox[{"[", "4", "]"}], "]"}], "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", 
            RowBox[{"[", "4", "]"}], "]"}], "[", 
           RowBox[{"[", "4", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "4", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", 
           RowBox[{"[", "4", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "[", 
            RowBox[{"[", "3", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "[", 
            RowBox[{"[", "3", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "[", 
            RowBox[{"[", "3", "]"}], "]"}], "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "[", 
            RowBox[{"[", "3", "]"}], "]"}], "[", 
           RowBox[{"[", "4", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "[", 
            RowBox[{"[", "4", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "[", 
            RowBox[{"[", "4", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "[", 
            RowBox[{"[", "4", "]"}], "]"}], "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "[", 
            RowBox[{"[", "4", "]"}], "]"}], "[", 
           RowBox[{"[", "4", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "4", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", 
           RowBox[{"[", "4", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "[", 
            RowBox[{"[", "3", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "[", 
            RowBox[{"[", "3", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "[", 
            RowBox[{"[", "3", "]"}], "]"}], "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "[", 
            RowBox[{"[", "3", "]"}], "]"}], "[", 
           RowBox[{"[", "4", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "[", 
            RowBox[{"[", "4", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "[", 
            RowBox[{"[", "4", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "[", 
            RowBox[{"[", "4", "]"}], "]"}], "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "[", 
            RowBox[{"[", "4", "]"}], "]"}], "[", 
           RowBox[{"[", "4", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "4", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "4", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "4", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "4", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "4", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "4", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "4", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "4", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "4", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", 
           RowBox[{"[", "4", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "4", "]"}], "]"}], "[", 
            RowBox[{"[", "3", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "4", "]"}], "]"}], "[", 
            RowBox[{"[", "3", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "4", "]"}], "]"}], "[", 
            RowBox[{"[", "3", "]"}], "]"}], "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "4", "]"}], "]"}], "[", 
            RowBox[{"[", "3", "]"}], "]"}], "[", 
           RowBox[{"[", "4", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "4", "]"}], "]"}], "[", 
            RowBox[{"[", "4", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "4", "]"}], "]"}], "[", 
            RowBox[{"[", "4", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "4", "]"}], "]"}], "[", 
            RowBox[{"[", "4", "]"}], "]"}], "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "4", "]"}], "]"}], "[", 
            RowBox[{"[", "4", "]"}], "]"}], "[", 
           RowBox[{"[", "4", "]"}], "]"}]}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"meat", "=", 
       RowBox[{"ToString", "[", 
        RowBox[{"Column", "[", 
         RowBox[{"StringReplace", "[", 
          RowBox[{"text", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\"\<Sqrt\>\"", "->", "\"\<sqrt\>\""}], ",", 
             RowBox[{"\"\<Power(E,\>\"", "->", "\"\<exp(\>\""}], ",", 
             RowBox[{"\"\<Power\>\"", "->", "\"\<pow\>\""}], ",", 
             RowBox[{"\"\<Sin\>\"", "->", "\"\<sin\>\""}], ",", 
             RowBox[{"\"\<Cos\>\"", "->", "\"\<cos\>\""}], ",", 
             RowBox[{"\"\<Csc\>\"", "->", "\"\<1/sin\>\""}], ",", 
             RowBox[{"\"\<Cot\>\"", "->", "\"\<1/tan\>\""}], ",", 
             RowBox[{"\"\<double\>\"", "->", "\"\<double\>\""}], ",", 
             RowBox[{"\"\<;,\>\"", "->", "\"\<;\\n    \>\""}], ",", 
             RowBox[{"\"\<out(0)\>\"", "->", "\"\<christ[0][0][0]\>\""}], ",", 
             RowBox[{"\"\<out(1)\>\"", "->", "\"\<christ[0][0][1]\>\""}], ",", 
             RowBox[{"\"\<out(2)\>\"", "->", "\"\<christ[0][0][2]\>\""}], ",", 
             RowBox[{"\"\<out(3)\>\"", "->", "\"\<christ[0][0][3]\>\""}], ",", 
             RowBox[{"\"\<out(4)\>\"", "->", "\"\<christ[0][1][0]\>\""}], ",", 
             RowBox[{"\"\<out(5)\>\"", "->", "\"\<christ[0][1][1]\>\""}], ",", 
             RowBox[{"\"\<out(6)\>\"", "->", "\"\<christ[0][1][2]\>\""}], ",", 
             RowBox[{"\"\<out(7)\>\"", "->", "\"\<christ[0][1][3]\>\""}], ",", 
             RowBox[{"\"\<out(8)\>\"", "->", "\"\<christ[0][2][0]\>\""}], ",", 
             RowBox[{"\"\<out(9)\>\"", "->", "\"\<christ[0][2][1]\>\""}], ",", 
             RowBox[{"\"\<out(10)\>\"", "->", "\"\<christ[0][2][2]\>\""}], ",", 
             RowBox[{"\"\<out(11)\>\"", "->", "\"\<christ[0][2][3]\>\""}], ",", 
             RowBox[{"\"\<out(12)\>\"", "->", "\"\<christ[0][3][0]\>\""}], ",", 
             RowBox[{"\"\<out(13)\>\"", "->", "\"\<christ[0][3][1]\>\""}], ",", 
             RowBox[{"\"\<out(14)\>\"", "->", "\"\<christ[0][3][2]\>\""}], ",", 
             RowBox[{"\"\<out(15)\>\"", "->", "\"\<christ[0][3][3]\>\""}], ",", 
             RowBox[{"\"\<out(16)\>\"", "->", "\"\<christ[1][0][0]\>\""}], ",", 
             RowBox[{"\"\<out(17)\>\"", "->", "\"\<christ[1][0][1]\>\""}], ",", 
             RowBox[{"\"\<out(18)\>\"", "->", "\"\<christ[1][0][2]\>\""}], ",", 
             RowBox[{"\"\<out(19)\>\"", "->", "\"\<christ[1][0][3]\>\""}], ",", 
             RowBox[{"\"\<out(20)\>\"", "->", "\"\<christ[1][1][0]\>\""}], ",", 
             RowBox[{"\"\<out(21)\>\"", "->", "\"\<christ[1][1][1]\>\""}], ",", 
             RowBox[{"\"\<out(22)\>\"", "->", "\"\<christ[1][1][2]\>\""}], ",", 
             RowBox[{"\"\<out(23)\>\"", "->", "\"\<christ[1][1][3]\>\""}], ",", 
             RowBox[{"\"\<out(24)\>\"", "->", "\"\<christ[1][2][0]\>\""}], ",", 
             RowBox[{"\"\<out(25)\>\"", "->", "\"\<christ[1][2][1]\>\""}], ",", 
             RowBox[{"\"\<out(26)\>\"", "->", "\"\<christ[1][2][2]\>\""}], ",", 
             RowBox[{"\"\<out(27)\>\"", "->", "\"\<christ[1][2][3]\>\""}], ",", 
             RowBox[{"\"\<out(28)\>\"", "->", "\"\<christ[1][3][0]\>\""}], ",", 
             RowBox[{"\"\<out(29)\>\"", "->", "\"\<christ[1][3][1]\>\""}], ",", 
             RowBox[{"\"\<out(30)\>\"", "->", "\"\<christ[1][3][2]\>\""}], ",", 
             RowBox[{"\"\<out(31)\>\"", "->", "\"\<christ[1][3][3]\>\""}], ",", 
             RowBox[{"\"\<out(32)\>\"", "->", "\"\<christ[2][0][0]\>\""}], ",", 
             RowBox[{"\"\<out(33)\>\"", "->", "\"\<christ[2][0][1]\>\""}], ",", 
             RowBox[{"\"\<out(34)\>\"", "->", "\"\<christ[2][0][2]\>\""}], ",", 
             RowBox[{"\"\<out(35)\>\"", "->", "\"\<christ[2][0][3]\>\""}], ",", 
             RowBox[{"\"\<out(36)\>\"", "->", "\"\<christ[2][1][0]\>\""}], ",", 
             RowBox[{"\"\<out(37)\>\"", "->", "\"\<christ[2][1][1]\>\""}], ",", 
             RowBox[{"\"\<out(38)\>\"", "->", "\"\<christ[2][1][2]\>\""}], ",", 
             RowBox[{"\"\<out(39)\>\"", "->", "\"\<christ[2][1][3]\>\""}], ",", 
             RowBox[{"\"\<out(40)\>\"", "->", "\"\<christ[2][2][0]\>\""}], ",", 
             RowBox[{"\"\<out(41)\>\"", "->", "\"\<christ[2][2][1]\>\""}], ",", 
             RowBox[{"\"\<out(42)\>\"", "->", "\"\<christ[2][2][2]\>\""}], ",", 
             RowBox[{"\"\<out(43)\>\"", "->", "\"\<christ[2][2][3]\>\""}], ",", 
             RowBox[{"\"\<out(44)\>\"", "->", "\"\<christ[2][3][0]\>\""}], ",", 
             RowBox[{"\"\<out(45)\>\"", "->", "\"\<christ[2][3][1]\>\""}], ",", 
             RowBox[{"\"\<out(46)\>\"", "->", "\"\<christ[2][3][2]\>\""}], ",", 
             RowBox[{"\"\<out(47)\>\"", "->", "\"\<christ[2][3][3]\>\""}], ",", 
             RowBox[{"\"\<out(48)\>\"", "->", "\"\<christ[3][0][0]\>\""}], ",", 
             RowBox[{"\"\<out(49)\>\"", "->", "\"\<christ[3][0][1]\>\""}], ",", 
             RowBox[{"\"\<out(50)\>\"", "->", "\"\<christ[3][0][2]\>\""}], ",", 
             RowBox[{"\"\<out(51)\>\"", "->", "\"\<christ[3][0][3]\>\""}], ",", 
             RowBox[{"\"\<out(52)\>\"", "->", "\"\<christ[3][1][0]\>\""}], ",", 
             RowBox[{"\"\<out(53)\>\"", "->", "\"\<christ[3][1][1]\>\""}], ",", 
             RowBox[{"\"\<out(54)\>\"", "->", "\"\<christ[3][1][2]\>\""}], ",", 
             RowBox[{"\"\<out(55)\>\"", "->", "\"\<christ[3][1][3]\>\""}], ",", 
             RowBox[{"\"\<out(56)\>\"", "->", "\"\<christ[3][2][0]\>\""}], ",", 
             RowBox[{"\"\<out(57)\>\"", "->", "\"\<christ[3][2][1]\>\""}], ",", 
             RowBox[{"\"\<out(58)\>\"", "->", "\"\<christ[3][2][2]\>\""}], ",", 
             RowBox[{"\"\<out(59)\>\"", "->", "\"\<christ[3][2][3]\>\""}], ",", 
             RowBox[{"\"\<out(60)\>\"", "->", "\"\<christ[3][3][0]\>\""}], ",", 
             RowBox[{"\"\<out(61)\>\"", "->", "\"\<christ[3][3][1]\>\""}], ",", 
             RowBox[{"\"\<out(62)\>\"", "->", "\"\<christ[3][3][2]\>\""}], ",", 
             RowBox[{"\"\<out(63)\>\"", "->", "\"\<christ[3][3][3]\>\""}]}], 
            "}"}]}], "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
      "header", 
       "=", "\"\<void christoffel(double r, double chi, double \
christ[4][4][4])\\n{\\n\>\""}], ";", "\[IndentingNewLine]", 
      RowBox[{"footer", "=", "\"\<\\n}\>\""}], ";", "\[IndentingNewLine]", 
      RowBox[{"output", "=", 
       RowBox[{"header", "<>", "meat", "<>", "footer"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{"filename", ",", "output", ",", "\"\<Text\>\""}], "]"}]}]}], 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"outputTidal", "[", 
   RowBox[{"matrix_", ",", 
    RowBox[{"filename_", ":", "\"\<Cloc.cpp\>\""}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "text", ",", "meat", ",", "header", ",", "footer", ",", "output"}], 
     "}"}], ",", 
    RowBox[{
     RowBox[{"text", "=", 
      RowBox[{"OptimizeExpressionToC", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"matrix", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"matrix", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"matrix", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"matrix", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", "4", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"matrix", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"matrix", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"matrix", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"matrix", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "[", 
          RowBox[{"[", "4", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"matrix", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"matrix", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"matrix", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"matrix", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "[", 
          RowBox[{"[", "4", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"matrix", "[", 
           RowBox[{"[", "4", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"matrix", "[", 
           RowBox[{"[", "4", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"matrix", "[", 
           RowBox[{"[", "4", "]"}], "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"matrix", "[", 
           RowBox[{"[", "4", "]"}], "]"}], "[", 
          RowBox[{"[", "4", "]"}], "]"}]}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"meat", "=", 
      RowBox[{"ToString", "[", 
       RowBox[{"Column", "[", 
        RowBox[{"StringReplace", "[", 
         RowBox[{"text", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\"\<Sqrt\>\"", "->", "\"\<sqrt\>\""}], ",", 
            RowBox[{"\"\<Power(E,\>\"", "->", "\"\<exp(\>\""}], ",", 
            RowBox[{"\"\<Power\>\"", "->", "\"\<pow\>\""}], ",", 
            RowBox[{"\"\<Abs\>\"", "->", "\"\<abs\>\""}], ",", 
            RowBox[{"\"\<Sin\>\"", "->", "\"\<sin\>\""}], ",", 
            RowBox[{"\"\<Cos\>\"", "->", "\"\<cos\>\""}], ",", 
            RowBox[{"\"\<Csc\>\"", "->", "\"\<1/sin\>\""}], ",", 
            RowBox[{"\"\<Cot\>\"", "->", "\"\<1/tan\>\""}], ",", 
            RowBox[{"\"\<;,\>\"", "->", "\"\<;\\n    \>\""}], ",", 
            RowBox[{"\"\<double\>\"", "->", "\"\<complex<double>\>\""}], ",", 
            
            RowBox[{"\"\<out(0)\>\"", "->", "\"\<C[0][0]\>\""}], ",", 
            RowBox[{"\"\<out(1)\>\"", "->", "\"\<C[0][1]\>\""}], ",", 
            RowBox[{"\"\<out(2)\>\"", "->", "\"\<C[0][2]\>\""}], ",", 
            RowBox[{"\"\<out(3)\>\"", "->", "\"\<C[0][3]\>\""}], ",", 
            RowBox[{"\"\<out(4)\>\"", "->", "\"\<C[1][0]\>\""}], ",", 
            RowBox[{"\"\<out(5)\>\"", "->", "\"\<C[1][1]\>\""}], ",", 
            RowBox[{"\"\<out(6)\>\"", "->", "\"\<C[1][2]\>\""}], ",", 
            RowBox[{"\"\<out(7)\>\"", "->", "\"\<C[1][3]\>\""}], ",", 
            RowBox[{"\"\<out(8)\>\"", "->", "\"\<C[2][0]\>\""}], ",", 
            RowBox[{"\"\<out(9)\>\"", "->", "\"\<C[2][1]\>\""}], ",", 
            RowBox[{"\"\<out(10)\>\"", "->", "\"\<C[2][2]\>\""}], ",", 
            RowBox[{"\"\<out(11)\>\"", "->", "\"\<C[2][3]\>\""}], ",", 
            RowBox[{"\"\<out(12)\>\"", "->", "\"\<C[3][0]\>\""}], ",", 
            RowBox[{"\"\<out(13)\>\"", "->", "\"\<C[3][1]\>\""}], ",", 
            RowBox[{"\"\<out(14)\>\"", "->", "\"\<C[3][2]\>\""}], ",", 
            RowBox[{"\"\<out(15)\>\"", "->", "\"\<C[3][3]\>\""}]}], "}"}]}], 
         "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
     "header", 
      "=", "\"\<void ClocH(complex<double> M, complex<double> a, \
complex<double> Q, complex<double> e, complex<double> lz, complex<double> ep, \
complex<double> q, complex<double> r, complex<double> theta, complex<double> \
dt, complex<double> dr, complex<double> dtheta, complex<double> dphi, \
complex<double> C[4][4])\\n{\\n\>\""}], ";", "\[IndentingNewLine]", 
     RowBox[{"footer", "=", "\"\<\\n}\>\""}], ";", "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"header", "<>", "meat", "<>", "footer"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{"filename", ",", "output", ",", "\"\<Text\>\""}], "]"}]}]}], 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.934869974432248*^9, 3.934870117393032*^9}, {
   3.934870153965412*^9, 3.934870208815731*^9}, {3.934870340045987*^9, 
   3.934870355954009*^9}, {3.934870428919546*^9, 3.934870444496529*^9}, {
   3.934978673074291*^9, 3.934978704115281*^9}, {3.935056641516304*^9, 
   3.935056670590549*^9}, 3.935056922765959*^9, {3.935057012829417*^9, 
   3.935057013270317*^9}, 3.935057044174729*^9, {3.935057173539551*^9, 
   3.935057177828099*^9}, 3.935057229696449*^9, 3.935057373313364*^9, {
   3.935065402986771*^9, 3.935065411323144*^9}, {3.935065910064347*^9, 
   3.935065914760546*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"29641491-fd16-4695-b0a2-9de0b589632a"]
}, Closed]],

Cell[CellGroupData[{

Cell["Functions for solving IBSO radii", "Subsection",
 CellChangeTimes->{{3.935055016277986*^9, 
  3.9350550534232197`*^9}},ExpressionUUID->"7a59d467-6954-4c48-aa92-\
e192b76561a5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Ralt", "[", 
     RowBox[{
     "r_", ",", "ep_", ",", "lz_", ",", "a_", ",", "Q_", ",", "e_", ",", "m_",
       ",", "Lambda_"}], "]"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"ep", "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"r", "^", "2"}], "+", 
           RowBox[{"a", "^", "2"}]}], ")"}]}], "-", 
        RowBox[{"a", "*", "lz"}], "-", 
        RowBox[{"e", "*", "Q", "*", "r"}]}], ")"}], "^", "2"}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"r", "^", "2"}], "-", 
        RowBox[{"2", "*", "r"}], "+", 
        RowBox[{"a", "^", "2"}], "+", 
        RowBox[{"Q", "^", "2"}]}], ")"}], "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"m", "^", "2"}], "*", 
         RowBox[{"r", "^", "2"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"a", "*", "ep"}], "-", "lz"}], ")"}], "^", "2"}], "+", 
        RowBox[{
         RowBox[{"lz", "^", "2"}], "*", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Lambda", "^", "2"}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"Lambda", "^", "2"}]}], ")"}]}]}]}], ")"}]}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"dRaltdr", "[", 
     RowBox[{
     "r_", ",", "ep_", ",", "lz_", ",", "a_", ",", "Q_", ",", "e_", ",", "m_",
       ",", "Lambda_"}], "]"}], "=", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"Ralt", "[", 
       RowBox[{
       "r", ",", "ep", ",", "lz", ",", "a", ",", "Q", ",", "e", ",", "m", ",",
         "Lambda"}], "]"}], ",", "r"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"dRaltdr2", "[", 
     RowBox[{
     "r_", ",", "ep_", ",", "lz_", ",", "a_", ",", "Q_", ",", "e_", ",", "m_",
       ",", "Lambda_"}], "]"}], "=", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"dRaltdr", "[", 
       RowBox[{
       "r", ",", "ep", ",", "lz", ",", "a", ",", "Q", ",", "e", ",", "m", ",",
         "Lambda"}], "]"}], ",", "r"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"solplus", "[", 
     RowBox[{"var1_", ",", "var2_", ",", "var3_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"spin", "=", "var1"}], ",", 
        RowBox[{"charge", "=", "var2"}], ",", 
        RowBox[{"lam", "=", "var3"}], ",", "out"}], "}"}], ",", 
      RowBox[{
       RowBox[{"out", "=", 
        RowBox[{
         RowBox[{"NSolve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Ralt", "[", 
              RowBox[{
              "rsol", ",", "1", ",", "lzsol", ",", "var1", ",", "var2", ",", 
               "0", ",", "1", ",", "var3"}], "]"}], "==", "0"}], "&&", 
            RowBox[{
             RowBox[{"dRaltdr", "[", 
              RowBox[{
              "rsol", ",", "1", ",", "lzsol", ",", "var1", ",", "var2", ",", 
               "0", ",", "1", ",", "var3"}], "]"}], "==", "0"}], "&&", 
            RowBox[{"rsol", ">", "0"}], "&&", 
            RowBox[{"lzsol", ">", "0"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"rsol", ",", "lzsol"}], "}"}], ",", "Reals", ",", 
           RowBox[{"WorkingPrecision", "->", "16"}]}], "]"}], "/.", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "}"}], "->", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"rsol", "->", "0"}], ",", 
             RowBox[{"lzsol", "->", "0"}]}], "}"}]}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", "out"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"solminus", "[", 
     RowBox[{"var1_", ",", "var2_", ",", "var3_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"spin", "=", "var1"}], ",", 
        RowBox[{"charge", "=", "var2"}], ",", 
        RowBox[{"lam", "=", "var3"}], ",", "out"}], "}"}], ",", 
      RowBox[{
       RowBox[{"out", "=", 
        RowBox[{
         RowBox[{"NSolve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Ralt", "[", 
              RowBox[{
              "rsol", ",", "1", ",", "lzsol", ",", "var1", ",", "var2", ",", 
               "0", ",", "1", ",", "var3"}], "]"}], "==", "0"}], "&&", 
            RowBox[{
             RowBox[{"dRaltdr", "[", 
              RowBox[{
              "rsol", ",", "1", ",", "lzsol", ",", "var1", ",", "var2", ",", 
               "0", ",", "1", ",", "var3"}], "]"}], "==", "0"}], "&&", 
            RowBox[{"rsol", ">", "0"}], "&&", 
            RowBox[{"lzsol", "<", "0"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"rsol", ",", "lzsol"}], "}"}], ",", "Reals", ",", 
           RowBox[{"WorkingPrecision", "->", "16"}]}], "]"}], "/.", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "}"}], "->", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"rsol", "->", "0"}], ",", 
             RowBox[{"lzsol", "->", "0"}]}], "}"}]}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", "out"}]}], "]"}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"momentum", "[", 
     RowBox[{"r_", ",", "a_", ",", "Q_"}], "]"}], "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"a", "^", "2"}]}], "+", 
       RowBox[{"r", "*", 
        RowBox[{"(", 
         RowBox[{"r", "-", 
          RowBox[{"Q", "^", "2"}]}], ")"}]}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"r", "^", "2"}], "-", 
          RowBox[{"2", "*", "r"}], "+", 
          RowBox[{"a", "^", "2"}], "+", 
          RowBox[{"Q", "^", "2"}]}], ")"}], "*", 
        RowBox[{"Sqrt", "[", "r", "]"}]}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"a", "*", 
       RowBox[{"(", 
        RowBox[{"r", "-", "1"}], ")"}]}], ")"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"carterk", "[", 
     RowBox[{"r_", ",", "a_", ",", "Q_"}], "]"}], "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"r", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"a", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "3"}], " ", "+", " ", "r"}], ")"}], "*", "r"}], " ", 
         "+", " ", 
         RowBox[{
          RowBox[{"a", "^", "3"}], "*", 
          RowBox[{"(", 
           RowBox[{"1", " ", "+", " ", "r"}], ")"}]}], " ", "+", " ", 
         RowBox[{"a", "*", 
          RowBox[{"Q", "^", "2"}], "*", 
          RowBox[{"(", 
           RowBox[{"1", " ", "+", " ", "r"}], ")"}]}], " ", "+", " ", 
         RowBox[{"2", "*", 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            RowBox[{"a", "^", "2"}], "*", "r", "*", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"a", "^", "2"}], " ", "+", " ", 
               RowBox[{"Q", "^", "2"}], " ", "+", " ", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "2"}], " ", "+", " ", "r"}], ")"}], "*", 
                "r"}]}], ")"}], "^", "2"}]}], "]"}]}]}], ")"}]}], ")"}], "/", 
     
     RowBox[{"(", 
      RowBox[{"a", "*", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], " ", "+", " ", "r"}], ")"}], "^", "2"}]}], 
      ")"}]}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"carterq", "[", 
    RowBox[{"r_", ",", "a_", ",", "Q_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"carterk", "[", 
     RowBox[{"r", ",", "a", ",", "Q"}], "]"}], "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"momentum", "[", 
        RowBox[{"r", ",", "a", ",", "Q"}], "]"}], "-", "a"}], ")"}], "^", 
     "2"}]}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9344847378635025`*^9, 3.934484751366549*^9}, 
   3.935051829537908*^9, {3.935051860010437*^9, 3.9350519122344627`*^9}, 
   3.935052189118833*^9, 3.935052242770153*^9, 3.935052717342176*^9, {
   3.9350527623910217`*^9, 3.935052770221189*^9}, 3.9350528129648523`*^9, {
   3.935085850647981*^9, 3.9350858821391563`*^9}, {3.935087376567683*^9, 
   3.9350873797774105`*^9}, {3.935087434789034*^9, 3.935087552151163*^9}, {
   3.935087623573366*^9, 3.935087625497801*^9}, {3.935087831104906*^9, 
   3.935087838302534*^9}, 3.9350878741166935`*^9, {3.935087973098192*^9, 
   3.935087973331245*^9}, {3.935088010652687*^9, 3.935088010963759*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"7b5cbb39-9bc8-9740-88af-1d3c898d22e0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"carterq", "[", 
   RowBox[{"r", ",", "a", ",", "Q"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.935088074170103*^9, 3.935088080589596*^9}},
 CellLabel->"In[29]:=",ExpressionUUID->"58b998a6-e969-e743-8963-d8c277bce876"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"r", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", 
       SuperscriptBox["a", "4"], " ", 
       SqrtBox["r"]}], "-", 
      RowBox[{"2", " ", "a", " ", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["a", "2"], " ", "r", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["a", "2"], "+", 
            SuperscriptBox["Q", "2"], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "2"}], "+", "r"}], ")"}], " ", "r"}]}], ")"}], 
          "2"]}]]}], "+", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SqrtBox["r"]}], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["Q", "2"], "-", 
          RowBox[{"2", " ", "r"}], "+", 
          SuperscriptBox["r", 
           RowBox[{"3", "/", "2"}]]}], ")"}], "2"]}], "+", 
      RowBox[{
       SuperscriptBox["a", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["Q", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"4", " ", 
             SqrtBox["r"]}], "+", "r"}], ")"}]}], "+", 
         RowBox[{"r", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "-", 
            RowBox[{"6", " ", 
             SqrtBox["r"]}], "-", "r", "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["r", 
              RowBox[{"3", "/", "2"}]]}]}], ")"}]}]}], ")"}]}]}], ")"}]}], 
   RowBox[{
    SuperscriptBox["a", "2"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "r"}], ")"}], "2"]}]]}]], "Output",
 CellChangeTimes->{
  3.935088081066704*^9, 3.9352464699081516`*^9, 3.935246987896463*^9, 
   3.9352574009204464`*^9, 3.9354994304543123`*^9, {3.935572483025713*^9, 
   3.9355724912042637`*^9}, {3.9360389619347153`*^9, 3.936038963803137*^9}, 
   3.9446440497994537`*^9, 3.971422627496134*^9},
 CellLabel->"Out[29]=",ExpressionUUID->"5b6810d1-e045-46a5-8882-9c6ac4b727b9"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Modules for constructing tensors", "Subsection",
 CellChangeTimes->{{3.935055039191413*^9, 
  3.9350550596537743`*^9}},ExpressionUUID->"17f84823-11f9-46f5-87d2-\
1880f8fd34f6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"getR", "[", 
    RowBox[{"a0_", ",", "b0_", ",", "c0_", ",", "d0_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"i0", "=", "0"}], ",", 
       RowBox[{"j0", "=", "0"}], ",", 
       RowBox[{"k0", "=", "0"}], ",", 
       RowBox[{"l0", "=", "0"}], ",", 
       RowBox[{"component", "=", "0"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i0", "=", "1"}], ",", 
        RowBox[{"i0", "<=", "4"}], ",", 
        RowBox[{"i0", "++"}], ",", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"j0", "=", "1"}], ",", 
          RowBox[{"j0", "<=", "4"}], ",", 
          RowBox[{"j0", "++"}], ",", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"k0", "=", "1"}], ",", 
            RowBox[{"k0", "<=", "4"}], ",", 
            RowBox[{"k0", "++"}], ",", 
            RowBox[{"For", "[", 
             RowBox[{
              RowBox[{"l0", "=", "1"}], ",", 
              RowBox[{"l0", "<=", "4"}], ",", 
              RowBox[{"l0", "++"}], ",", 
              RowBox[{
               RowBox[{"component", "+=", 
                RowBox[{
                 RowBox[{"Part", "[", 
                  RowBox[{
                  "Robs", ",", "i0", ",", "j0", ",", "k0", ",", "l0"}], "]"}],
                  "*", 
                 RowBox[{"Part", "[", 
                  RowBox[{"matdown", ",", "a0", ",", "i0"}], "]"}], "*", 
                 RowBox[{"Part", "[", 
                  RowBox[{"matdown", ",", "b0", ",", "j0"}], "]"}], "*", 
                 RowBox[{"Part", "[", 
                  RowBox[{"matdown", ",", "c0", ",", "k0"}], "]"}], "*", 
                 RowBox[{"Part", "[", 
                  RowBox[{"matdown", ",", "d0", ",", "l0"}], "]"}]}]}], 
               ";"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "component"}]}], "]"}]}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getRH", "[", 
    RowBox[{"a0_", ",", "b0_", ",", "c0_", ",", "d0_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"i0", "=", "0"}], ",", 
       RowBox[{"j0", "=", "0"}], ",", 
       RowBox[{"k0", "=", "0"}], ",", 
       RowBox[{"l0", "=", "0"}], ",", 
       RowBox[{"component", "=", "0"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i0", "=", "1"}], ",", 
        RowBox[{"i0", "<=", "4"}], ",", 
        RowBox[{"i0", "++"}], ",", 
        RowBox[{
         RowBox[{"component", "+=", 
          RowBox[{
           RowBox[{"Part", "[", 
            RowBox[{"Rlnrf", ",", "i0", ",", "b0", ",", "c0", ",", "d0"}], 
            "]"}], "*", 
           RowBox[{"Part", "[", 
            RowBox[{"eta", ",", "a0", ",", "i0"}], "]"}]}]}], ";"}]}], "]"}], 
      ";", "\[IndentingNewLine]", "component"}]}], "]"}]}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getRIC", "[", 
    RowBox[{"a0_", ",", "b0_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"i0", "=", "0"}], ",", 
       RowBox[{"j0", "=", "0"}], ",", 
       RowBox[{"k0", "=", "0"}], ",", 
       RowBox[{"l0", "=", "0"}], ",", 
       RowBox[{"component", "=", "0"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i0", "=", "1"}], ",", 
        RowBox[{"i0", "<=", "4"}], ",", 
        RowBox[{"i0", "++"}], ",", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"j0", "=", "1"}], ",", 
          RowBox[{"j0", "<=", "4"}], ",", 
          RowBox[{"j0", "++"}], ",", 
          RowBox[{
           RowBox[{"component", "+=", 
            RowBox[{
             RowBox[{"Part", "[", 
              RowBox[{"eta", ",", "i0", ",", "j0"}], "]"}], "*", 
             RowBox[{"Part", "[", 
              RowBox[{"Rlnrf", ",", "i0", ",", "a0", ",", "j0", ",", "b0"}], 
              "]"}]}]}], ";"}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      "component"}]}], "]"}]}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getC", "[", 
    RowBox[{"a0_", ",", "b0_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"i0", "=", "0"}], ",", 
       RowBox[{"j0", "=", "0"}], ",", 
       RowBox[{"k0", "=", "0"}], ",", 
       RowBox[{"l0", "=", "0"}], ",", 
       RowBox[{"component", "=", "0"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i0", "=", "1"}], ",", 
        RowBox[{"i0", "<=", "4"}], ",", 
        RowBox[{"i0", "++"}], ",", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"j0", "=", "1"}], ",", 
          RowBox[{"j0", "<=", "4"}], ",", 
          RowBox[{"j0", "++"}], ",", 
          RowBox[{
           RowBox[{"component", "-=", 
            RowBox[{
             RowBox[{"Part", "[", 
              RowBox[{"Rlnrf", ",", "a0", ",", "i0", ",", "b0", ",", "j0"}], 
              "]"}], "*", 
             RowBox[{"Part", "[", 
              RowBox[{"Ulnrf", ",", "i0"}], "]"}], "*", 
             RowBox[{"Part", "[", 
              RowBox[{"Ulnrf", ",", "j0"}], "]"}]}]}], ";"}]}], "]"}]}], 
       "]"}], ";", "\[IndentingNewLine]", "component"}]}], "]"}]}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getCH", "[", 
    RowBox[{"a0_", ",", "b0_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"i0", "=", "0"}], ",", 
       RowBox[{"j0", "=", "0"}], ",", 
       RowBox[{"k0", "=", "0"}], ",", 
       RowBox[{"l0", "=", "0"}], ",", 
       RowBox[{"component", "=", "0"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i0", "=", "1"}], ",", 
        RowBox[{"i0", "<=", "4"}], ",", 
        RowBox[{"i0", "++"}], ",", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"j0", "=", "1"}], ",", 
          RowBox[{"j0", "<=", "4"}], ",", 
          RowBox[{"j0", "++"}], ",", 
          RowBox[{
           RowBox[{"component", "-=", 
            RowBox[{
             RowBox[{"Part", "[", 
              RowBox[{"RlnrfH", ",", "a0", ",", "i0", ",", "b0", ",", "j0"}], 
              "]"}], "*", 
             RowBox[{"Part", "[", 
              RowBox[{"Ulnrf", ",", "i0"}], "]"}], "*", 
             RowBox[{"Part", "[", 
              RowBox[{"Ulnrf", ",", "j0"}], "]"}]}]}], ";"}]}], "]"}]}], 
       "]"}], ";", "\[IndentingNewLine]", "component"}]}], "]"}]}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getCobs", "[", 
    RowBox[{"a0_", ",", "b0_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"i0", "=", "0"}], ",", 
       RowBox[{"j0", "=", "0"}], ",", 
       RowBox[{"k0", "=", "0"}], ",", 
       RowBox[{"l0", "=", "0"}], ",", 
       RowBox[{"component", "=", "0"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i0", "=", "1"}], ",", 
        RowBox[{"i0", "<=", "4"}], ",", 
        RowBox[{"i0", "++"}], ",", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"j0", "=", "1"}], ",", 
          RowBox[{"j0", "<=", "4"}], ",", 
          RowBox[{"j0", "++"}], ",", 
          RowBox[{
           RowBox[{"component", "-=", 
            RowBox[{
             RowBox[{"Part", "[", 
              RowBox[{"Robs", ",", "a0", ",", "i0", ",", "b0", ",", "j0"}], 
              "]"}], "*", 
             RowBox[{"Part", "[", 
              RowBox[{"U", ",", "i0"}], "]"}], "*", 
             RowBox[{"Part", "[", 
              RowBox[{"U", ",", "j0"}], "]"}]}]}], ";"}]}], "]"}]}], "]"}], ";",
       "\[IndentingNewLine]", "component"}]}], "]"}]}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getCobsH", "[", 
    RowBox[{"a0_", ",", "b0_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"i0", "=", "0"}], ",", 
       RowBox[{"j0", "=", "0"}], ",", 
       RowBox[{"k0", "=", "0"}], ",", 
       RowBox[{"l0", "=", "0"}], ",", 
       RowBox[{"component", "=", "0"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i0", "=", "1"}], ",", 
        RowBox[{"i0", "<=", "4"}], ",", 
        RowBox[{"i0", "++"}], ",", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"j0", "=", "1"}], ",", 
          RowBox[{"j0", "<=", "4"}], ",", 
          RowBox[{"j0", "++"}], ",", 
          RowBox[{
           RowBox[{"component", "-=", 
            RowBox[{
             RowBox[{"Part", "[", 
              RowBox[{"RobsH", ",", "a0", ",", "i0", ",", "b0", ",", "j0"}], 
              "]"}], "*", 
             RowBox[{"Part", "[", 
              RowBox[{"U", ",", "i0"}], "]"}], "*", 
             RowBox[{"Part", "[", 
              RowBox[{"U", ",", "j0"}], "]"}]}]}], ";"}]}], "]"}]}], "]"}], ";",
       "\[IndentingNewLine]", "component"}]}], "]"}]}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getClocH", "[", 
    RowBox[{"mu0_", ",", "nu0_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"i0", "=", "0"}], ",", 
       RowBox[{"j0", "=", "0"}], ",", 
       RowBox[{"k0", "=", "0"}], ",", 
       RowBox[{"l0", "=", "0"}], ",", 
       RowBox[{"component", "=", "0"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i0", "=", "1"}], ",", 
        RowBox[{"i0", "<=", "4"}], ",", 
        RowBox[{"i0", "++"}], ",", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"j0", "=", "1"}], ",", 
          RowBox[{"j0", "<=", "4"}], ",", 
          RowBox[{"j0", "++"}], ",", 
          RowBox[{
           RowBox[{"component", "+=", 
            RowBox[{
             RowBox[{"Part", "[", 
              RowBox[{"ClnrfH", ",", "i0", ",", "j0"}], "]"}], "*", 
             RowBox[{"Part", "[", 
              RowBox[{"lorentz", ",", "mu0", ",", "i0"}], "]"}], "*", 
             RowBox[{"Part", "[", 
              RowBox[{"lorentzinv", ",", "j0", ",", "nu0"}], "]"}]}]}], 
           ";"}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      "component"}]}], "]"}]}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"genRlnrf", "[", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i0", ",", "j0", ",", "k0", ",", "l0", ",", "output"}], "}"}], ",", 
     RowBox[{
      RowBox[{"output", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"getR", "[", 
          RowBox[{"i0", ",", "j0", ",", "k0", ",", "l0"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i0", ",", "1", ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j0", ",", "1", ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k0", ",", "1", ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"l0", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Simplify", "[", 
       RowBox[{"output", ",", 
        RowBox[{"Assumptions", "->", "assume"}]}], "]"}]}]}], "]"}]}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"genRlnrfH", "[", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i0", ",", "j0", ",", "k0", ",", "l0", ",", "output"}], "}"}], ",", 
     RowBox[{
      RowBox[{"output", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"getRH", "[", 
          RowBox[{"i0", ",", "j0", ",", "k0", ",", "l0"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i0", ",", "1", ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j0", ",", "1", ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k0", ",", "1", ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"l0", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Simplify", "[", 
       RowBox[{"output", ",", 
        RowBox[{"Assumptions", "->", "assume"}]}], "]"}]}]}], "]"}]}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"genRIClnrf", "[", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i0", ",", "j0", ",", "output"}], "}"}], ",", 
     RowBox[{
      RowBox[{"output", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"getRIC", "[", 
          RowBox[{"i0", ",", "j0"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i0", ",", "1", ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j0", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Simplify", "[", 
       RowBox[{"output", ",", 
        RowBox[{"Assumptions", "->", "assume"}]}], "]"}]}]}], "]"}]}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"genUlnrf", "[", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i0", ",", "j0", ",", "output"}], "}"}], ",", 
     RowBox[{
      RowBox[{"output", "=", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", "4", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i0", "=", "1"}], ",", 
        RowBox[{"i0", "<=", "4"}], ",", 
        RowBox[{"i0", "++"}], ",", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"j0", "=", "1"}], ",", 
          RowBox[{"j0", "<=", "4"}], ",", 
          RowBox[{"j0", "++"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"output", "[", 
             RowBox[{"[", "i0", "]"}], "]"}], "+=", 
            RowBox[{
             RowBox[{"Part", "[", 
              RowBox[{"U", ",", "j0"}], "]"}], "*", 
             RowBox[{"Part", "[", 
              RowBox[{"matup", ",", "i0", ",", "j0"}], "]"}]}]}], ";"}]}], 
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Simplify", "[", 
       RowBox[{"output", ",", 
        RowBox[{"Assumptions", "->", "assume"}]}], "]"}]}]}], "]"}]}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"genClnrf", "[", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i0", ",", "j0", ",", "output"}], "}"}], ",", 
     RowBox[{
      RowBox[{"output", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"getC", "[", 
          RowBox[{"i0", ",", "j0"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i0", ",", "1", ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j0", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "output"}]}], "]"}]}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"genClnrfH", "[", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i0", ",", "j0", ",", "output"}], "}"}], ",", 
     RowBox[{
      RowBox[{"output", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"getCH", "[", 
          RowBox[{"i0", ",", "j0"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i0", ",", "1", ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j0", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "output"}]}], "]"}]}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"genCobs", "[", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i0", ",", "j0", ",", "output"}], "}"}], ",", 
     RowBox[{
      RowBox[{"output", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"getCobs", "[", 
          RowBox[{"i0", ",", "j0"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i0", ",", "1", ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j0", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "output"}]}], "]"}]}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"genCobsH", "[", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i0", ",", "j0", ",", "output"}], "}"}], ",", 
     RowBox[{
      RowBox[{"output", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"getCobsH", "[", 
          RowBox[{"i0", ",", "j0"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i0", ",", "1", ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j0", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "output"}]}], "]"}]}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"genClocH", "[", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i0", ",", "j0", ",", "output"}], "}"}], ",", 
     RowBox[{
      RowBox[{"output", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"getClocH", "[", 
          RowBox[{"i0", ",", "j0"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i0", ",", "1", ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j0", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "output"}]}], "]"}]}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"genLorentz", "[", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "i0", ",", "j0", ",", "output", ",", "beta", ",", "gamma", ",", "betar",
        ",", "betatheta", ",", "betaphi"}], "}"}], ",", 
     RowBox[{
      RowBox[{"beta", "=", 
       RowBox[{"Sqrt", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Part", "[", 
           RowBox[{"UlnrfN", ",", "2"}], "]"}], "^", "2"}], "+", 
         RowBox[{
          RowBox[{"Part", "[", 
           RowBox[{"UlnrfN", ",", "3"}], "]"}], "^", "2"}], "+", 
         RowBox[{
          RowBox[{"Part", "[", 
           RowBox[{"UlnrfN", ",", "4"}], "]"}], "^", "2"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gamma", "=", 
       RowBox[{"1", "/", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"1", "-", 
          RowBox[{"beta", "^", "2"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"betar", "=", 
       RowBox[{"Part", "[", 
        RowBox[{"UlnrfN", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"betatheta", "=", 
       RowBox[{"Part", "[", 
        RowBox[{"UlnrfN", ",", "3"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"betaphi", "=", 
       RowBox[{"Part", "[", 
        RowBox[{"UlnrfN", ",", "4"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"output", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"gamma", ",", 
           RowBox[{
            RowBox[{"-", "gamma"}], "*", "betar"}], ",", 
           RowBox[{
            RowBox[{"-", "gamma"}], "*", "betatheta"}], ",", 
           RowBox[{
            RowBox[{"-", "gamma"}], "*", "betaphi"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "gamma"}], "*", "betar"}], ",", 
           RowBox[{"1", "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"gamma", "-", "1"}], ")"}], "*", 
             RowBox[{
              RowBox[{"betar", "^", "2"}], "/", 
              RowBox[{"(", 
               RowBox[{"beta", "^", "2"}], ")"}]}]}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"gamma", "-", "1"}], ")"}], "*", "betar", "*", 
            RowBox[{"betatheta", "/", 
             RowBox[{"(", 
              RowBox[{"beta", "^", "2"}], ")"}]}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"gamma", "-", "1"}], ")"}], "*", "betar", "*", 
            RowBox[{"betaphi", "/", 
             RowBox[{"(", 
              RowBox[{"beta", "^", "2"}], ")"}]}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "gamma"}], "*", "betatheta"}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"gamma", "-", "1"}], ")"}], "*", "betar", "*", 
            RowBox[{"betatheta", "/", 
             RowBox[{"(", 
              RowBox[{"beta", "^", "2"}], ")"}]}]}], ",", 
           RowBox[{"1", "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"gamma", "-", "1"}], ")"}], "*", 
             RowBox[{
              RowBox[{"betatheta", "^", "2"}], "/", 
              RowBox[{"(", 
               RowBox[{"beta", "^", "2"}], ")"}]}]}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"gamma", "-", "1"}], ")"}], "*", "betatheta", "*", 
            RowBox[{"betaphi", "/", 
             RowBox[{"(", 
              RowBox[{"beta", "^", "2"}], ")"}]}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "gamma"}], "*", "betaphi"}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"gamma", "-", "1"}], ")"}], "*", "betar", "*", 
            RowBox[{"betaphi", "/", 
             RowBox[{"(", 
              RowBox[{"beta", "^", "2"}], ")"}]}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"gamma", "-", "1"}], ")"}], "*", "betatheta", "*", 
            RowBox[{"betaphi", "/", 
             RowBox[{"(", 
              RowBox[{"beta", "^", "2"}], ")"}]}]}], ",", 
           RowBox[{"1", "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"gamma", "-", "1"}], ")"}], "*", 
             RowBox[{
              RowBox[{"betaphi", "^", "2"}], "/", 
              RowBox[{"(", 
               RowBox[{"beta", "^", "2"}], ")"}]}]}]}]}], "}"}]}], "}"}]}], ";",
       "\[IndentingNewLine]", "output"}]}], "]"}]}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"genLorentzinv", "[", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "i0", ",", "j0", ",", "output", ",", "beta", ",", "gamma", ",", "betar", 
      ",", "betatheta", ",", "betaphi"}], "}"}], ",", 
    RowBox[{
     RowBox[{"beta", "=", 
      RowBox[{"Sqrt", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Part", "[", 
          RowBox[{"UlnrfN", ",", "2"}], "]"}], "^", "2"}], "+", 
        RowBox[{
         RowBox[{"Part", "[", 
          RowBox[{"UlnrfN", ",", "3"}], "]"}], "^", "2"}], "+", 
        RowBox[{
         RowBox[{"Part", "[", 
          RowBox[{"UlnrfN", ",", "4"}], "]"}], "^", "2"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"gamma", "=", 
      RowBox[{"1", "/", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"1", "-", 
         RowBox[{"beta", "^", "2"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"betar", "=", 
      RowBox[{"Part", "[", 
       RowBox[{"UlnrfN", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"betatheta", "=", 
      RowBox[{"Part", "[", 
       RowBox[{"UlnrfN", ",", "3"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"betaphi", "=", 
      RowBox[{"Part", "[", 
       RowBox[{"UlnrfN", ",", "4"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"gamma", ",", 
          RowBox[{"gamma", "*", "betar"}], ",", 
          RowBox[{"gamma", "*", "betatheta"}], ",", 
          RowBox[{"gamma", "*", "betaphi"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"gamma", "*", "betar"}], ",", 
          RowBox[{"1", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"gamma", "-", "1"}], ")"}], "*", 
            RowBox[{
             RowBox[{"betar", "^", "2"}], "/", 
             RowBox[{"(", 
              RowBox[{"beta", "^", "2"}], ")"}]}]}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"gamma", "-", "1"}], ")"}], "*", "betar", "*", 
           RowBox[{"betatheta", "/", 
            RowBox[{"(", 
             RowBox[{"beta", "^", "2"}], ")"}]}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"gamma", "-", "1"}], ")"}], "*", "betar", "*", 
           RowBox[{"betaphi", "/", 
            RowBox[{"(", 
             RowBox[{"beta", "^", "2"}], ")"}]}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"gamma", "*", "betatheta"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"gamma", "-", "1"}], ")"}], "*", "betar", "*", 
           RowBox[{"betatheta", "/", 
            RowBox[{"(", 
             RowBox[{"beta", "^", "2"}], ")"}]}]}], ",", 
          RowBox[{"1", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"gamma", "-", "1"}], ")"}], "*", 
            RowBox[{
             RowBox[{"betatheta", "^", "2"}], "/", 
             RowBox[{"(", 
              RowBox[{"beta", "^", "2"}], ")"}]}]}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"gamma", "-", "1"}], ")"}], "*", "betatheta", "*", 
           RowBox[{"betaphi", "/", 
            RowBox[{"(", 
             RowBox[{"beta", "^", "2"}], ")"}]}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"gamma", "*", "betaphi"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"gamma", "-", "1"}], ")"}], "*", "betar", "*", 
           RowBox[{"betaphi", "/", 
            RowBox[{"(", 
             RowBox[{"beta", "^", "2"}], ")"}]}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"gamma", "-", "1"}], ")"}], "*", "betatheta", "*", 
           RowBox[{"betaphi", "/", 
            RowBox[{"(", 
             RowBox[{"beta", "^", "2"}], ")"}]}]}], ",", 
          RowBox[{"1", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"gamma", "-", "1"}], ")"}], "*", 
            RowBox[{
             RowBox[{"betaphi", "^", "2"}], "/", 
             RowBox[{"(", 
              RowBox[{"beta", "^", "2"}], ")"}]}]}]}]}], "}"}]}], "}"}]}], ";",
      "\[IndentingNewLine]", "output"}]}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9338510986322403`*^9, 3.933851231350432*^9}, {
   3.933851264401556*^9, 3.933851291694806*^9}, {3.933852357893911*^9, 
   3.933852470053194*^9}, {3.933852620603965*^9, 3.933852622282379*^9}, {
   3.933918998888369*^9, 3.93391900982312*^9}, {3.933919129849835*^9, 
   3.933919194820705*^9}, 3.933919276592138*^9, {3.9339196672698603`*^9, 
   3.93391967187815*^9}, 3.933919749230995*^9, {3.9339206852422943`*^9, 
   3.933920706503937*^9}, {3.933921386163795*^9, 3.933921407644115*^9}, {
   3.933923039275528*^9, 3.933923048758379*^9}, {3.933928940911278*^9, 
   3.933928951417703*^9}, {3.93393076808773*^9, 3.933930781131068*^9}, {
   3.933931244490231*^9, 3.933931276162438*^9}, 3.933931310830996*^9, {
   3.93393135525995*^9, 3.93393144524244*^9}, 3.933931603522331*^9, {
   3.933937038227434*^9, 3.93393706237845*^9}, {3.933939334093277*^9, 
   3.933939338000237*^9}, {3.9339418166997557`*^9, 3.933941835392231*^9}, {
   3.934001923920185*^9, 3.934001927671034*^9}, 3.934002048740551*^9, {
   3.934003274589704*^9, 3.934003326101707*^9}, {3.934003691621823*^9, 
   3.934003728143428*^9}, {3.934003956037683*^9, 3.934003956531888*^9}, {
   3.934004471745371*^9, 3.934004485422675*^9}, {3.934004707352284*^9, 
   3.9340047432435493`*^9}, {3.9340048053731737`*^9, 3.934004809181737*^9}, {
   3.934005274833391*^9, 3.934005282839207*^9}, {3.934018228838429*^9, 
   3.934018241699321*^9}, {3.934023612875197*^9, 3.9340236143227787`*^9}, {
   3.934024220860395*^9, 3.934024250200943*^9}, {3.934024334829576*^9, 
   3.934024353723679*^9}, {3.9348076894679585`*^9, 3.93480769216395*^9}, 
   3.935049508448844*^9, {3.935050269271167*^9, 3.935050276329628*^9}, {
   3.93505038947381*^9, 3.935050391199315*^9}, {3.935050458058854*^9, 
   3.93505047520511*^9}, {3.9350506212700777`*^9, 3.935050632084358*^9}, {
   3.9350506762543077`*^9, 3.935050676906253*^9}, 3.935050730547758*^9, 
   3.935050836159843*^9, {3.935051035995641*^9, 3.935051036770199*^9}, 
   3.935257893308975*^9, {3.935257929390691*^9, 3.935257930054338*^9}, 
   3.935258142046438*^9},
 CellLabel->"In[30]:=",ExpressionUUID->"4a10e253-4bcc-48e9-974d-f71d19202c61"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["1. Construct Metric and LNRF Tetrad", "Section",
 CellChangeTimes->{{3.934005722624063*^9, 3.934005732198447*^9}, {
  3.935053996240841*^9, 3.935054001785119*^9}, {3.9350540410011473`*^9, 
  3.935054058875512*^9}, {3.935054834798462*^9, 3.935054837860755*^9}, {
  3.935055173142095*^9, 3.935055181168125*^9}, {3.935055317595064*^9, 
  3.935055318057983*^9}},ExpressionUUID->"75a54489-e589-bb4b-8ccb-\
4831d80e56e4"],

Cell[CellGroupData[{

Cell["Define Metric Functions (Teo Wormhole)", "Subsection",
 CellChangeTimes->{{3.934282090937512*^9, 3.934282091510206*^9}, {
  3.934867310974741*^9, 3.934867312633335*^9}, {3.935054061101269*^9, 
  3.935054065558511*^9}, {3.935054132337101*^9, 3.93505414518657*^9}, {
  3.935499437474051*^9, 
  3.935499442080288*^9}},ExpressionUUID->"874ebe37-2463-c749-a897-\
3d4f99b12b07"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Nfunc", "[", 
     RowBox[{"r_", ",", "theta_"}], "]"}], "=", 
    RowBox[{"1", "+", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"4", "*", "a", "*", 
         RowBox[{"Cos", "[", "theta", "]"}]}], ")"}], "^", "2"}], "/", 
      "r"}]}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Kfunc", "[", 
     RowBox[{"r_", ",", "theta_"}], "]"}], " ", "=", 
    RowBox[{"1", "+", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"4", "*", "a", "*", 
         RowBox[{"Cos", "[", "theta", "]"}]}], ")"}], "^", "2"}], "/", 
      "r"}]}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bfunc", "[", 
     RowBox[{"r_", ",", "theta_"}], "]"}], " ", "=", " ", "1"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"omegafunc", "[", 
     RowBox[{"r_", ",", "theta_"}], "]"}], "=", 
    RowBox[{"2", 
     RowBox[{"a", "/", 
      RowBox[{"r", "^", "3"}]}]}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Clear", "[", 
     RowBox[{"Nfunc", ",", "Kfunc", ",", "bfunc", ",", "omegafunc"}], "]"}], 
    ";"}], "*)"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"nu", " ", "=", " ", 
    RowBox[{"Log", "[", 
     RowBox[{"Nfunc", "[", 
      RowBox[{"r", ",", "theta"}], "]"}], "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"psi", " ", "=", " ", 
    RowBox[{"Log", "[", 
     RowBox[{"r", "*", 
      RowBox[{"Kfunc", "[", 
       RowBox[{"r", ",", "theta"}], "]"}], "*", 
      RowBox[{"Sin", "[", "theta", "]"}]}], "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"mu1", " ", "=", " ", 
    RowBox[{
     RowBox[{"Log", "[", 
      RowBox[{"1", "/", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{
          RowBox[{"bfunc", "[", 
           RowBox[{"r", ",", "theta"}], "]"}], "/", "r"}]}], ")"}]}], "]"}], 
     " ", "/", " ", "2"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"mu2", " ", "=", " ", 
    RowBox[{"Log", "[", 
     RowBox[{"r", "*", 
      RowBox[{"Kfunc", "[", 
       RowBox[{"r", ",", "theta"}], "]"}]}], "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"omega", " ", "=", " ", 
    RowBox[{"omegafunc", "[", 
     RowBox[{"r", ",", "theta"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Assumptions", " ", "help", " ", "to", " ", "improve", " ", "results", " ",
     "from", " ", "Simplify", " ", "and", " ", "FullSimplify"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"assume", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"0", " ", "<", " ", "a"}], " ", ",", " ", 
      RowBox[{"M", " ", ">", "0"}], ",", 
      RowBox[{"0", " ", "<", " ", "theta", " ", "<", " ", 
       RowBox[{"Pi", "/", "2"}]}], ",", 
      RowBox[{"ep", ">", "0"}], ",", 
      RowBox[{"r", ">", "2"}], ",", 
      RowBox[{"lz", ">", "0"}]}], "}"}]}], ";"}], " "}]}], "Input",
 CellChangeTimes->{{3.933854959792768*^9, 3.9338549611571903`*^9}, {
   3.9339165206197433`*^9, 3.933916548912434*^9}, {3.933922207420917*^9, 
   3.93392222609068*^9}, {3.9339309974196997`*^9, 3.933931016199965*^9}, 
   3.933931092421702*^9, {3.93393193798018*^9, 3.933931945639496*^9}, {
   3.933932000241374*^9, 3.933932003585867*^9}, {3.933932521507957*^9, 
   3.933932523034479*^9}, {3.933932952322185*^9, 3.933933045856726*^9}, {
   3.933935218213648*^9, 3.93393521932358*^9}, {3.933935412240082*^9, 
   3.933935420434956*^9}, {3.933935477694027*^9, 3.93393561136913*^9}, {
   3.933935672477589*^9, 3.933935677470853*^9}, {3.9339358170739*^9, 
   3.933935817518752*^9}, {3.9339363257707376`*^9, 3.933936326330152*^9}, {
   3.933936910919734*^9, 3.9339369118980308`*^9}, {3.933937248099874*^9, 
   3.933937265456704*^9}, {3.933937556432447*^9, 3.933937580853297*^9}, 
   3.934005742711608*^9, {3.93401780523812*^9, 3.9340178071297913`*^9}, {
   3.934282283708282*^9, 3.934282292174451*^9}, {3.934287381989078*^9, 
   3.934287396583023*^9}, {3.934360216878838*^9, 3.934360217943141*^9}, {
   3.9344847650006657`*^9, 3.934484767675772*^9}, {3.934867360995327*^9, 
   3.934867365173066*^9}, {3.934867418011077*^9, 3.9348674556908503`*^9}, {
   3.934867573124275*^9, 3.934867604084247*^9}, {3.934867706865942*^9, 
   3.934867832007077*^9}, {3.934868357289069*^9, 3.934868358330013*^9}, {
   3.934868567418899*^9, 3.934868568290724*^9}, {3.934868785125916*^9, 
   3.934868785444957*^9}, {3.934984782456099*^9, 3.934984782770516*^9}, 
   3.935055431316845*^9, {3.935055490001709*^9, 3.935055526904283*^9}, {
   3.9352467704868317`*^9, 3.935246773894331*^9}, {3.935499852810388*^9, 
   3.935500044867433*^9}, {3.935500301953881*^9, 3.935500305564522*^9}, {
   3.9355724964209967`*^9, 3.935572513315316*^9}, {3.935575264270323*^9, 
   3.935575266727066*^9}, {3.9355754491781178`*^9, 3.935575453805635*^9}, 
   3.944644057567402*^9, {3.944644179994774*^9, 3.9446442074850235`*^9}},
 CellLabel->"In[49]:=",ExpressionUUID->"f137eb3e-4cd4-4943-9a43-e6b2a687391a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Construct metric", "Subsection",
 CellChangeTimes->{{3.934005736741164*^9, 
  3.934005752075032*^9}},ExpressionUUID->"f670db8a-8d75-e34f-b307-\
6bca94049d7c"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"g00", " ", "=", " ", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"Exp", "[", 
       RowBox[{"2", " ", "*", " ", "nu"}], "]"}]}], " ", "+", " ", 
     RowBox[{
      RowBox[{"omega", "^", "2"}], " ", "*", " ", 
      RowBox[{"Exp", "[", 
       RowBox[{"2", " ", "*", " ", "psi"}], "]"}]}]}]}], ";"}], "\n"}], "\n", 

 RowBox[{
  RowBox[{
   RowBox[{"g11", " ", "=", " ", 
    RowBox[{"Exp", "[", 
     RowBox[{"2", " ", "*", " ", "mu1"}], "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"g22", " ", "=", " ", 
    RowBox[{"Exp", "[", 
     RowBox[{"2", " ", "*", " ", "mu2"}], "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"g33", " ", "=", " ", 
    RowBox[{"Exp", "[", 
     RowBox[{"2", " ", "*", " ", "psi"}], "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"g03", " ", "=", " ", 
    RowBox[{
     RowBox[{"-", "omega"}], " ", "*", " ", 
     RowBox[{"Exp", "[", 
      RowBox[{"2", " ", "*", " ", "psi"}], "]"}]}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"g30", " ", "=", " ", "g03"}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"G", " ", "=", " ", 
    RowBox[{"Simplify", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"g00", ",", " ", "0", ",", " ", "0", ",", " ", "g03"}], "}"}],
        ",", " ", 
       RowBox[{"{", 
        RowBox[{"0", ",", " ", "g11", ",", " ", "0", ",", " ", "0"}], "}"}], ",",
        " ", 
       RowBox[{"{", 
        RowBox[{"0", ",", " ", "0", ",", " ", "g22", ",", " ", "0"}], "}"}], ",",
        " ", 
       RowBox[{"{", 
        RowBox[{
        "g03", ",", "\n", "     ", "0", ",", " ", "0", ",", " ", "g33"}], 
        "}"}]}], "}"}], "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{"G", " ", "//", " ", "MatrixForm"}], "\n", 
 RowBox[{
  RowBox[{"eta", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", " ", "0", ",", " ", "0", ",", " ", "0"}], 
      "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", "1", ",", " ", "0", ",", " ", "0"}], "}"}], ",", 
     " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", "0", ",", " ", "1", ",", " ", "0"}], "}"}], ",", 
     " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", "0", ",", " ", "0", ",", " ", "1"}], "}"}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ginv", " ", "=", " ", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"Inverse", "[", "G", "]"}], ",", 
     RowBox[{"Assumptions", "->", "assume"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Ginv", " ", "//", " ", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{"eta", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.933830506502351*^9, 3.933830703486718*^9}, {
  3.933830915507316*^9, 3.933830920422785*^9}, {3.933836233776398*^9, 
  3.933836260761751*^9}, {3.933836437750134*^9, 3.933836437887389*^9}, {
  3.933854076771879*^9, 3.9338540773039503`*^9}, {3.933931160043805*^9, 
  3.93393116219117*^9}, {3.933939187034836*^9, 3.933939225534553*^9}, {
  3.9340239111180973`*^9, 3.934023913949585*^9}, {3.93428330841564*^9, 
  3.934283309314687*^9}, {3.934868103482291*^9, 3.934868104565119*^9}, {
  3.934985157464023*^9, 3.934985160132829*^9}, {3.934985217951686*^9, 
  3.934985218115399*^9}, {3.935086714267599*^9, 3.935086715067781*^9}, {
  3.935500071788412*^9, 3.935500072702218*^9}},
 CellLabel->"In[59]:=",ExpressionUUID->"07a79e12-a0ed-c448-818f-cffb501ed195"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"r", "+", 
            RowBox[{"16", " ", 
             SuperscriptBox["a", "2"], " ", 
             SuperscriptBox[
              RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}], "2"], " ", 
         
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["r", "4"], "-", 
           RowBox[{"4", " ", 
            SuperscriptBox["a", "2"], " ", 
            SuperscriptBox[
             RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}]}], 
        SuperscriptBox["r", "6"]]}], "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "a", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"r", "+", 
            RowBox[{"16", " ", 
             SuperscriptBox["a", "2"], " ", 
             SuperscriptBox[
              RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}], "2"], " ", 
         
         SuperscriptBox[
          RowBox[{"Sin", "[", "theta", "]"}], "2"]}], 
        SuperscriptBox["r", "3"]]}]},
     {"0", 
      FractionBox["r", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "r"}]], "0", "0"},
     {"0", "0", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"r", "+", 
         RowBox[{"16", " ", 
          SuperscriptBox["a", "2"], " ", 
          SuperscriptBox[
           RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}], "2"], "0"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "a", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"r", "+", 
            RowBox[{"16", " ", 
             SuperscriptBox["a", "2"], " ", 
             SuperscriptBox[
              RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}], "2"], " ", 
         
         SuperscriptBox[
          RowBox[{"Sin", "[", "theta", "]"}], "2"]}], 
        SuperscriptBox["r", "3"]]}], "0", "0", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"r", "+", 
          RowBox[{"16", " ", 
           SuperscriptBox["a", "2"], " ", 
           SuperscriptBox[
            RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.9339312024151096`*^9, 3.933935223747494*^9, {3.9339391945553102`*^9, 
   3.933939225779566*^9}, 3.9340012486098213`*^9, 3.934003742512697*^9, 
   3.934005753759734*^9, 3.9340138668696823`*^9, 3.934017492692045*^9, 
   3.934017590460136*^9, 3.934023914392991*^9, 3.9340243052464952`*^9, 
   3.9342820232155123`*^9, 3.934282533478303*^9, 3.934283310056161*^9, 
   3.934283631193225*^9, 3.934285199943402*^9, 3.934347691979907*^9, 
   3.9343602292722273`*^9, 3.934366496979014*^9, 3.934375198589778*^9, 
   3.934484762342026*^9, 3.934539886215872*^9, 3.934807715691887*^9, 
   3.934867841402401*^9, 3.934868115877814*^9, 3.934978171671949*^9, 
   3.934981167904202*^9, {3.934985154650413*^9, 3.934985160515249*^9}, 
   3.934985218960063*^9, 3.93504996646565*^9, 3.935055988088559*^9, 
   3.93506545948032*^9, {3.935065994332148*^9, 3.9350660063390427`*^9}, 
   3.935083959596672*^9, 3.935086732097634*^9, 3.935136760236305*^9, 
   3.9352465099070168`*^9, 3.935246946769863*^9, {3.935250419743862*^9, 
   3.93525042973784*^9}, 3.935250473841503*^9, 3.935257431568857*^9, {
   3.935500049885764*^9, 3.9355000791404543`*^9}, 3.935500308542983*^9, 
   3.935572518599938*^9, 3.935574344275832*^9, 3.9360389707497044`*^9, 
   3.944644063158415*^9, 3.944644212455204*^9, 3.944644376708433*^9, 
   3.9714226500924053`*^9},
 CellLabel->
  "Out[66]//MatrixForm=",ExpressionUUID->"743ddf60-11a0-49f7-9248-\
083536d737c2"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", 
       FractionBox[
        SuperscriptBox["r", "2"], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"r", "+", 
           RowBox[{"16", " ", 
            SuperscriptBox["a", "2"], " ", 
            SuperscriptBox[
             RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}], "2"]]}], 
      "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "a"}], 
        RowBox[{"r", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"r", "+", 
            RowBox[{"16", " ", 
             SuperscriptBox["a", "2"], " ", 
             SuperscriptBox[
              RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}], 
          "2"]}]]}]},
     {"0", 
      FractionBox[
       RowBox[{
        RowBox[{"-", "1"}], "+", "r"}], "r"], "0", "0"},
     {"0", "0", 
      FractionBox["1", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"r", "+", 
          RowBox[{"16", " ", 
           SuperscriptBox["a", "2"], " ", 
           SuperscriptBox[
            RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}], "2"]], "0"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "a"}], 
        RowBox[{"r", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"r", "+", 
            RowBox[{"16", " ", 
             SuperscriptBox["a", "2"], " ", 
             SuperscriptBox[
              RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}], "2"]}]]}], 
      "0", "0", 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", "4"}], " ", 
         SuperscriptBox["a", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["r", "4"], " ", 
         SuperscriptBox[
          RowBox[{"Csc", "[", "theta", "]"}], "2"]}]}], 
       RowBox[{
        SuperscriptBox["r", "4"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"r", "+", 
           RowBox[{"16", " ", 
            SuperscriptBox["a", "2"], " ", 
            SuperscriptBox[
             RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}], "2"]}]]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.9339312024151096`*^9, 3.933935223747494*^9, {3.9339391945553102`*^9, 
   3.933939225779566*^9}, 3.9340012486098213`*^9, 3.934003742512697*^9, 
   3.934005753759734*^9, 3.9340138668696823`*^9, 3.934017492692045*^9, 
   3.934017590460136*^9, 3.934023914392991*^9, 3.9340243052464952`*^9, 
   3.9342820232155123`*^9, 3.934282533478303*^9, 3.934283310056161*^9, 
   3.934283631193225*^9, 3.934285199943402*^9, 3.934347691979907*^9, 
   3.9343602292722273`*^9, 3.934366496979014*^9, 3.934375198589778*^9, 
   3.934484762342026*^9, 3.934539886215872*^9, 3.934807715691887*^9, 
   3.934867841402401*^9, 3.934868115877814*^9, 3.934978171671949*^9, 
   3.934981167904202*^9, {3.934985154650413*^9, 3.934985160515249*^9}, 
   3.934985218960063*^9, 3.93504996646565*^9, 3.935055988088559*^9, 
   3.93506545948032*^9, {3.935065994332148*^9, 3.9350660063390427`*^9}, 
   3.935083959596672*^9, 3.935086732097634*^9, 3.935136760236305*^9, 
   3.9352465099070168`*^9, 3.935246946769863*^9, {3.935250419743862*^9, 
   3.93525042973784*^9}, 3.935250473841503*^9, 3.935257431568857*^9, {
   3.935500049885764*^9, 3.9355000791404543`*^9}, 3.935500308542983*^9, 
   3.935572518599938*^9, 3.935574344275832*^9, 3.9360389707497044`*^9, 
   3.944644063158415*^9, 3.944644212455204*^9, 3.944644376708433*^9, 
   3.971422650118485*^9},
 CellLabel->
  "Out[69]//MatrixForm=",ExpressionUUID->"32d3156c-044b-401c-ae71-\
dc39a0b03151"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "1"}], "0", "0", "0"},
     {"0", "1", "0", "0"},
     {"0", "0", "1", "0"},
     {"0", "0", "0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.9339312024151096`*^9, 3.933935223747494*^9, {3.9339391945553102`*^9, 
   3.933939225779566*^9}, 3.9340012486098213`*^9, 3.934003742512697*^9, 
   3.934005753759734*^9, 3.9340138668696823`*^9, 3.934017492692045*^9, 
   3.934017590460136*^9, 3.934023914392991*^9, 3.9340243052464952`*^9, 
   3.9342820232155123`*^9, 3.934282533478303*^9, 3.934283310056161*^9, 
   3.934283631193225*^9, 3.934285199943402*^9, 3.934347691979907*^9, 
   3.9343602292722273`*^9, 3.934366496979014*^9, 3.934375198589778*^9, 
   3.934484762342026*^9, 3.934539886215872*^9, 3.934807715691887*^9, 
   3.934867841402401*^9, 3.934868115877814*^9, 3.934978171671949*^9, 
   3.934981167904202*^9, {3.934985154650413*^9, 3.934985160515249*^9}, 
   3.934985218960063*^9, 3.93504996646565*^9, 3.935055988088559*^9, 
   3.93506545948032*^9, {3.935065994332148*^9, 3.9350660063390427`*^9}, 
   3.935083959596672*^9, 3.935086732097634*^9, 3.935136760236305*^9, 
   3.9352465099070168`*^9, 3.935246946769863*^9, {3.935250419743862*^9, 
   3.93525042973784*^9}, 3.935250473841503*^9, 3.935257431568857*^9, {
   3.935500049885764*^9, 3.9355000791404543`*^9}, 3.935500308542983*^9, 
   3.935572518599938*^9, 3.935574344275832*^9, 3.9360389707497044`*^9, 
   3.944644063158415*^9, 3.944644212455204*^9, 3.944644376708433*^9, 
   3.97142265011931*^9},
 CellLabel->
  "Out[70]//MatrixForm=",ExpressionUUID->"036fb407-36ef-4ae4-bbf5-\
ec21c38a2b0e"]
}, Open  ]],

Cell["\<\
First  integrals  to  geodesic  equations, assuming  theta = Pi/2\
\>", "Text",
 CellChangeTimes->{
  3.9355749142454147`*^9},ExpressionUUID->"37be20ee-fb0a-4a81-af7b-\
ced22daed90c"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Dfunc", "=", 
   RowBox[{
    RowBox[{"Nfunc", "[", 
     RowBox[{"r", ",", "theta"}], "]"}], "*", 
    RowBox[{"Kfunc", "[", 
     RowBox[{"r", ",", "theta"}], "]"}], "*", "r", "*", 
    RowBox[{"Sin", "[", "theta", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dsub", " ", "=", " ", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"dt", " ", "->", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Part", "[", 
           RowBox[{"G", ",", "4", ",", "4"}], "]"}], "*", "ep"}], "+", 
         RowBox[{
          RowBox[{"Part", "[", 
           RowBox[{"G", ",", "1", ",", "4"}], "]"}], "*", "lz"}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"Dfunc", "^", "2"}], ")"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"dr", " ", "->", " ", 
      RowBox[{"-", 
       RowBox[{"Sqrt", "[", 
        RowBox[{
         RowBox[{"Part", "[", 
          RowBox[{"Ginv", ",", "2", ",", "2"}], "]"}], "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Part", "[", 
                RowBox[{"G", ",", "4", ",", "4"}], "]"}], "*", 
               RowBox[{"ep", "^", "2"}]}], "+", 
              RowBox[{"2", "*", 
               RowBox[{"Part", "[", 
                RowBox[{"G", ",", "1", ",", "4"}], "]"}], "*", "lz", "*", 
               "ep"}], "+", 
              RowBox[{
               RowBox[{"Part", "[", 
                RowBox[{"G", ",", "1", ",", "1"}], "]"}], "*", 
               RowBox[{"lz", "^", "2"}]}]}], ")"}], "/", 
            RowBox[{"(", 
             RowBox[{"Dfunc", "^", "2"}], ")"}]}], "-", "1"}], ")"}]}], 
        "]"}]}]}], ",", " ", "\[IndentingNewLine]", 
     RowBox[{"dtheta", " ", "->", "0"}], ",", " ", "\[IndentingNewLine]", 
     RowBox[{"dphi", " ", "->", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Part", "[", 
            RowBox[{"G", ",", "1", ",", "4"}], "]"}], "*", "ep"}], "+", 
          RowBox[{
           RowBox[{"Part", "[", 
            RowBox[{"G", ",", "1", ",", "1"}], "]"}], "*", "lz"}]}], ")"}]}], 
       "/", 
       RowBox[{"(", 
        RowBox[{"Dfunc", "^", "2"}], ")"}]}]}]}], "\[IndentingNewLine]", 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dsub", "=", 
   RowBox[{"Simplify", "[", "dsub", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"dsubalt", "=", 
  RowBox[{"dsub", "/.", 
   RowBox[{"{", 
    RowBox[{"lz", "->", "0"}], "}"}]}]}]}], "Input",
 CellChangeTimes->{{3.935574898738449*^9, 3.935574961923955*^9}, {
  3.935575039783457*^9, 3.935575150745421*^9}, {3.9355762601847258`*^9, 
  3.935576271326268*^9}},
 CellLabel->"In[71]:=",ExpressionUUID->"61473d0e-82ad-4d68-aa20-8aff50c45b00"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"dt", "\[Rule]", 
    FractionBox[
     RowBox[{"ep", " ", 
      SuperscriptBox["r", "2"]}], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"r", "+", 
        RowBox[{"16", " ", 
         SuperscriptBox["a", "2"], " ", 
         SuperscriptBox[
          RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}], "2"]]}], ",", 
   RowBox[{"dr", "\[Rule]", 
    RowBox[{"-", 
     SqrtBox[
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "r"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox["r", "6"]}], "+", 
          RowBox[{
           SuperscriptBox["ep", "2"], " ", 
           SuperscriptBox["r", "6"]}], "-", 
          RowBox[{"32", " ", 
           SuperscriptBox["a", "2"], " ", 
           SuperscriptBox["r", "5"], " ", 
           SuperscriptBox[
            RowBox[{"Cos", "[", "theta", "]"}], "2"]}], "-", 
          RowBox[{"256", " ", 
           SuperscriptBox["a", "4"], " ", 
           SuperscriptBox["r", "4"], " ", 
           SuperscriptBox[
            RowBox[{"Cos", "[", "theta", "]"}], "4"]}]}], ")"}]}], 
       RowBox[{
        SuperscriptBox["r", "5"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"r", "+", 
           RowBox[{"16", " ", 
            SuperscriptBox["a", "2"], " ", 
            SuperscriptBox[
             RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}], 
         "2"]}]]]}]}], ",", 
   RowBox[{"dtheta", "\[Rule]", "0"}], ",", 
   RowBox[{"dphi", "\[Rule]", 
    FractionBox[
     RowBox[{"2", " ", "a", " ", "ep"}], 
     RowBox[{"r", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"r", "+", 
         RowBox[{"16", " ", 
          SuperscriptBox["a", "2"], " ", 
          SuperscriptBox[
           RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}], "2"]}]]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.935576271870591*^9, 3.9360389714108524`*^9, 
  3.944644373596878*^9, 3.971422650257511*^9},
 CellLabel->"Out[74]=",ExpressionUUID->"daa06c5d-f2ff-4ce3-846d-b5d702d7304e"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Construct LNRF tetrad", "Subsection",
 CellChangeTimes->{{3.934005758749338*^9, 
  3.9340057711714687`*^9}},ExpressionUUID->"59e53f6e-c6b4-5240-afdf-\
55d00df899c4"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"etup", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Exp", "[", "nu", "]"}], ",", " ", "0", ",", " ", "0", ",", " ",
       "0"}], "}"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"erup", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{"0", ",", " ", 
      RowBox[{"Exp", "[", "mu1", "]"}], ",", " ", "0", ",", " ", "0"}], 
     "}"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ethetaup", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{"0", ",", " ", "0", ",", " ", 
      RowBox[{"Exp", "[", "mu2", "]"}], ",", " ", "0"}], "}"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ephiup", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "omega"}], " ", "*", " ", 
       RowBox[{"Exp", "[", "psi", "]"}]}], ",", " ", "0", ",", " ", "0", ",", 
      " ", 
      RowBox[{"Exp", "[", "psi", "]"}]}], "}"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"etdown", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Exp", "[", 
       RowBox[{"-", "nu"}], "]"}], ",", " ", "0", ",", " ", "0", ",", " ", 
      RowBox[{"omega", " ", "*", " ", 
       RowBox[{"Exp", "[", 
        RowBox[{"-", "nu"}], "]"}]}]}], "}"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"erdown", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{"0", ",", " ", 
      RowBox[{"Exp", "[", 
       RowBox[{"-", "mu1"}], "]"}], ",", " ", "0", ",", " ", "0"}], "}"}]}], 
   ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ethetadown", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{"0", ",", " ", "0", ",", " ", 
      RowBox[{"Exp", "[", 
       RowBox[{"-", "mu2"}], "]"}], ",", " ", "0"}], "}"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ephidown", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{"0", ",", " ", "0", ",", " ", "0", ",", " ", 
      RowBox[{"Exp", "[", 
       RowBox[{"-", "psi"}], "]"}]}], "}"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"matup", " ", "=", " ", 
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "etup", ",", " ", "erup", ",", " ", "ethetaup", ",", " ", "ephiup"}], 
       "}"}], ",", " ", 
      RowBox[{"Assumptions", " ", "->", " ", "assume"}]}], "\n", "    ", 
     "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"matdown", " ", "=", " ", 
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "etdown", ",", " ", "erdown", ",", " ", "ethetadown", ",", " ", 
        "ephidown"}], "}"}], ",", " ", 
      RowBox[{"Assumptions", "\n", "     ", "->", " ", "assume"}]}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"matup", " ", "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{"matdown", " ", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.933845528618372*^9, 3.933845530814603*^9}, {
   3.933845582544602*^9, 3.9338456414921627`*^9}, 3.933850887613605*^9, {
   3.9339186704628773`*^9, 3.933918671732664*^9}, {3.933918709439705*^9, 
   3.93391874278925*^9}, {3.9339188180170097`*^9, 3.933918859579761*^9}, {
   3.933918933241538*^9, 3.933918968286671*^9}, {3.933919431266457*^9, 
   3.9339194653901253`*^9}, {3.933919506084997*^9, 3.93391951262516*^9}, {
   3.9339197304712057`*^9, 3.933919733663788*^9}, {3.9339197939952*^9, 
   3.9339198134478827`*^9}, {3.9339205015447693`*^9, 3.933920504778554*^9}, {
   3.93392057573744*^9, 3.933920602698117*^9}, {3.933921872255871*^9, 
   3.933921934120757*^9}, {3.933922005289003*^9, 3.933922013312416*^9}, {
   3.933922046918565*^9, 3.933922084304058*^9}, {3.933922144501965*^9, 
   3.93392214861307*^9}, 3.933922672780192*^9, {3.93392270533084*^9, 
   3.933922707109283*^9}, {3.933922758324823*^9, 3.93392276929446*^9}, {
   3.933922805919358*^9, 3.933922817797338*^9}, {3.933922859650118*^9, 
   3.933922870404048*^9}, {3.933928854886556*^9, 3.933928859668427*^9}, {
   3.933933407277974*^9, 3.933933416792776*^9}},
 CellLabel->"In[75]:=",ExpressionUUID->"84c18ada-202d-7c4c-992c-fea3cc735eec"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"1", "+", 
       FractionBox[
        RowBox[{"16", " ", 
         SuperscriptBox["a", "2"], " ", 
         SuperscriptBox[
          RowBox[{"Cos", "[", "theta", "]"}], "2"]}], "r"]}], "0", "0", "0"},
     {"0", 
      SqrtBox[
       FractionBox["r", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "r"}]]], "0", "0"},
     {"0", "0", 
      RowBox[{"r", "+", 
       RowBox[{"16", " ", 
        SuperscriptBox["a", "2"], " ", 
        SuperscriptBox[
         RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], "0"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "a", " ", 
         RowBox[{"(", 
          RowBox[{"r", "+", 
           RowBox[{"16", " ", 
            SuperscriptBox["a", "2"], " ", 
            SuperscriptBox[
             RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}], " ", 
         RowBox[{"Sin", "[", "theta", "]"}]}], 
        SuperscriptBox["r", "3"]]}], "0", "0", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"r", "+", 
         RowBox[{"16", " ", 
          SuperscriptBox["a", "2"], " ", 
          SuperscriptBox[
           RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}], " ", 
       RowBox[{"Sin", "[", "theta", "]"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.933935228922935*^9, 3.934001252988772*^9, 
  3.9340037487084846`*^9, 3.934013889955045*^9, 3.934017598455592*^9, 
  3.9342820308744717`*^9, 3.9342825649346943`*^9, 3.934283315113695*^9, 
  3.934283641738881*^9, 3.934285204444312*^9, 3.934347697182081*^9, 
  3.9343602344825287`*^9, 3.934366501370142*^9, 3.93437520429792*^9, 
  3.934484772557873*^9, 3.93453989876166*^9, 3.934807718462942*^9, 
  3.934868193511877*^9, 3.9349781777070704`*^9, 3.93498117440427*^9, 
  3.935049970575103*^9, 3.935065464069067*^9, 3.935065989385304*^9, 
  3.935083961536112*^9, 3.935136771059964*^9, 3.935246635118269*^9, 
  3.935246955049659*^9, 3.935250477879919*^9, 3.935257434964632*^9, 
  3.935500096727512*^9, 3.935500312528393*^9, 3.935572534585491*^9, 
  3.935574348670699*^9, 3.936038971569889*^9, 3.9446443796514435`*^9, 
  3.971422657619937*^9},
 CellLabel->
  "Out[85]//MatrixForm=",ExpressionUUID->"74e3c3a9-9461-4257-b6e2-\
a00d309c4b67"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox["r", 
       RowBox[{"r", "+", 
        RowBox[{"16", " ", 
         SuperscriptBox["a", "2"], " ", 
         SuperscriptBox[
          RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}]], "0", "0", 
      FractionBox[
       RowBox[{"2", " ", "a"}], 
       RowBox[{
        SuperscriptBox["r", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"r", "+", 
          RowBox[{"16", " ", 
           SuperscriptBox["a", "2"], " ", 
           SuperscriptBox[
            RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}]}]]},
     {"0", 
      SqrtBox[
       FractionBox[
        RowBox[{
         RowBox[{"-", "1"}], "+", "r"}], "r"]], "0", "0"},
     {"0", "0", 
      FractionBox["1", 
       RowBox[{"r", "+", 
        RowBox[{"16", " ", 
         SuperscriptBox["a", "2"], " ", 
         SuperscriptBox[
          RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}]], "0"},
     {"0", "0", "0", 
      FractionBox[
       RowBox[{"Csc", "[", "theta", "]"}], 
       RowBox[{"r", "+", 
        RowBox[{"16", " ", 
         SuperscriptBox["a", "2"], " ", 
         SuperscriptBox[
          RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}]]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.933935228922935*^9, 3.934001252988772*^9, 
  3.9340037487084846`*^9, 3.934013889955045*^9, 3.934017598455592*^9, 
  3.9342820308744717`*^9, 3.9342825649346943`*^9, 3.934283315113695*^9, 
  3.934283641738881*^9, 3.934285204444312*^9, 3.934347697182081*^9, 
  3.9343602344825287`*^9, 3.934366501370142*^9, 3.93437520429792*^9, 
  3.934484772557873*^9, 3.93453989876166*^9, 3.934807718462942*^9, 
  3.934868193511877*^9, 3.9349781777070704`*^9, 3.93498117440427*^9, 
  3.935049970575103*^9, 3.935065464069067*^9, 3.935065989385304*^9, 
  3.935083961536112*^9, 3.935136771059964*^9, 3.935246635118269*^9, 
  3.935246955049659*^9, 3.935250477879919*^9, 3.935257434964632*^9, 
  3.935500096727512*^9, 3.935500312528393*^9, 3.935572534585491*^9, 
  3.935574348670699*^9, 3.936038971569889*^9, 3.9446443796514435`*^9, 
  3.971422657621416*^9},
 CellLabel->
  "Out[86]//MatrixForm=",ExpressionUUID->"4e086069-bd72-45a8-97a3-\
1bb0f16125a7"]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["2. Compute Riemann Tensors in LNRF", "Section",
 CellChangeTimes->{{3.9350542398971577`*^9, 3.935054259276409*^9}, {
  3.9350553195442543`*^9, 
  3.935055319751227*^9}},ExpressionUUID->"1cc04b4d-a8d7-4b00-a7f4-\
affa0de0bc81"],

Cell[CellGroupData[{

Cell["Riemann tensor in observer frame", "Subsection",
 CellChangeTimes->{{3.934005778381692*^9, 3.934005804332829*^9}, {
   3.935054122709726*^9, 3.9350541228289747`*^9}, 3.935055260175907*^9, {
   3.9351417286346817`*^9, 
   3.9351417296350403`*^9}},ExpressionUUID->"20aa5ce1-a8ab-5f4b-b7b1-\
0405258e8457"],

Cell["last two lines take quite a while (~5 min)", "Text",
 CellChangeTimes->{
  3.935054119648446*^9, {3.9350541518052397`*^9, 
   3.935054156511533*^9}},ExpressionUUID->"baf57b4b-7491-4eaa-989f-\
e1c4c200e779"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"metric", " ", "=", " ", 
    RowBox[{
     RowBox[{"ResourceFunction", "[", "\"\<MetricTensor\>\"", "]"}], "[", 
     RowBox[{"G", ",", " ", 
      RowBox[{"{", 
       RowBox[{"t", ",", " ", "r", ",", " ", "theta", ",", " ", "phi"}], 
       "}"}], ",", " ", "True", ",", "\n", "     ", "True"}], "]"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"riemann", " ", "=", " ", 
    RowBox[{
     RowBox[{"ResourceFunction", "[", "\"\<RiemannTensor\>\"", "]"}], "[", 
     "metric", "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"riemann2", " ", "=", " ", 
    RowBox[{"riemann", "[", "\"\<CovariantRiemannTensor\>\"", "]"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{"AbsoluteTiming", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Robs", " ", "=", " ", 
    RowBox[{"riemann2", "[", "\"\<ReducedTensorRepresentation\>\"", "]"}]}], ";",
    "\[IndentingNewLine]", 
   RowBox[{"RobsH", "=", 
    RowBox[{"riemann", "[", "\"\<ReducedTensorRepresentation\>\"", "]"}]}], 
   ";"}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"ricci", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"ResourceFunction", "[", "\"\<RicciTensor\>\"", "]"}], "[", 
       "metric", "]"}], "\[IndentingNewLine]", 
      RowBox[{"ricci", "[", "\"\<ReducedMatrixRepresentation\>\"", "]"}]}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ricci", "[", "\"\<RicciScalar\>\"", "]"}], "//", "Simplify"}]}],
    "*)"}]}]}], "Input",
 TaggingRules->{},
 CellChangeTimes->{{3.890858783291338*^9, 3.890858786030251*^9}, {
   3.933838779198169*^9, 3.933838787724444*^9}, {3.93383883210533*^9, 
   3.933838842651514*^9}, 3.933838894607758*^9, {3.933839077547245*^9, 
   3.933839091084046*^9}, {3.933839124934717*^9, 3.933839178735402*^9}, {
   3.9338392159192133`*^9, 3.933839272874041*^9}, {3.933839317608643*^9, 
   3.933839348699297*^9}, {3.933839416362228*^9, 3.933839425466824*^9}, {
   3.933839512467855*^9, 3.9338395317165203`*^9}, 3.933839617436264*^9, {
   3.933839683511662*^9, 3.9338397148694477`*^9}, {3.9338508983827877`*^9, 
   3.933850914383095*^9}, {3.933930564250897*^9, 3.933930565064574*^9}, {
   3.933939263988366*^9, 3.933939276112163*^9}, {3.934003700757827*^9, 
   3.934003701025343*^9}, {3.934018475370386*^9, 3.934018477632476*^9}, {
   3.934981179467906*^9, 3.934981186726612*^9}, {3.935084074744772*^9, 
   3.9350840748748*^9}},
 CellLabel->"In[87]:=",
 CellID->950018488,ExpressionUUID->"e7f59428-5420-1d45-acc2-071660c59879"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"33.668775`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{
  3.93498152181149*^9, 3.935050314454107*^9, 3.9350657867545357`*^9, 
   3.935084156961912*^9, 3.935137098165834*^9, 3.935246962251263*^9, {
   3.935250464229042*^9, 3.935250480260065*^9}, 3.9352576543679905`*^9, 
   3.935500298529641*^9, 3.9355004227815228`*^9, 3.935573193231698*^9, 
   3.935574480669166*^9, 3.9360390290794086`*^9, 3.944644370046335*^9, 
   3.9446444069021206`*^9, 3.9714226960212183`*^9},
 CellLabel->"Out[90]=",ExpressionUUID->"d0ca52b5-33f8-4eda-b403-362751dd1148"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Riemann and Ricci tensors in LNRF", "Subsection",
 CellChangeTimes->{{3.93400582742299*^9, 3.9340058385818157`*^9}, {
  3.935050511259123*^9, 3.935050516525384*^9}, {3.935055246096229*^9, 
  3.93505525862047*^9}},ExpressionUUID->"0fb348d8-f1b2-864d-93f3-\
b26b1432e9b1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Rlnrf", "=", 
   RowBox[{"genRlnrf", "[", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"RlnrfH", "=", 
   RowBox[{"genRlnrfH", "[", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"RIClnrf", "=", 
   RowBox[{"genRIClnrf", "[", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{
  3.935050508147215*^9, {3.935053330034878*^9, 3.935053330230294*^9}},
 CellLabel->"In[91]:=",ExpressionUUID->"37f55650-fedc-484f-8e8c-832adccb3e3b"],

Cell["Check Ricci flatness", "Text",
 CellChangeTimes->{{3.935054181582512*^9, 3.9350541980390873`*^9}, {
  3.9714227048551197`*^9, 
  3.97142270629669*^9}},ExpressionUUID->"6e18ca4e-4960-49a7-a810-\
96a2896ebdf7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"RIClnrf", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"M", "->", "1"}], ",", " ", 
       RowBox[{"a", "->", "0"}]}], "}"}]}], ",", " ", 
    RowBox[{"Assumptions", "->", "assume"}]}], "]"}], " ", "//", " ", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.934003791193665*^9, 3.93400380101388*^9}, {
   3.9340040609500318`*^9, 3.934004101292737*^9}, {3.934022577912411*^9, 
   3.934022579361907*^9}, {3.934022656948678*^9, 3.934022673994715*^9}, {
   3.934022706497559*^9, 3.934022768040991*^9}, 3.934282640958331*^9, {
   3.934283459507721*^9, 3.934283469930155*^9}, {3.934868646425581*^9, 
   3.934868658514599*^9}, {3.935050544785515*^9, 3.935050546751646*^9}, {
   3.935141782193528*^9, 3.935141798345166*^9}, 3.935246997970197*^9, {
   3.935500545824334*^9, 3.935500545875447*^9}},
 CellLabel->"In[94]:=",ExpressionUUID->"d4efc434-4a4d-594f-9936-c1db043cf80a"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0"},
     {"0", 
      RowBox[{"-", 
       FractionBox["1", 
        SuperscriptBox["r", "3"]]}], "0", "0"},
     {"0", "0", 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SuperscriptBox["r", "3"]}]], "0"},
     {"0", "0", "0", 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SuperscriptBox["r", "3"]}]]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.934283463974764*^9, 3.934283491397263*^9}, 
   3.934284020812423*^9, 3.9343602502398*^9, {3.934868634810278*^9, 
   3.934868659798898*^9}, 3.934978557063002*^9, 3.934978616231942*^9, {
   3.935050540014135*^9, 3.9350505470716257`*^9}, 3.93506581547355*^9, 
   3.9350841734526424`*^9, {3.935141779199731*^9, 3.935141798664583*^9}, {
   3.935246981917246*^9, 3.9352470006749487`*^9}, {3.93550053626803*^9, 
   3.935500547375623*^9}, 3.935575169074893*^9, 3.936039042365406*^9, 
   3.971422710136525*^9},
 CellLabel->
  "Out[94]//MatrixForm=",ExpressionUUID->"399a4356-2b9e-4cf7-9897-\
c62924ce6e56"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Velocity vector in LNRF", "Subsection",
 CellChangeTimes->{{3.9340058605886083`*^9, 3.9340058835653477`*^9}, 
   3.935055262714489*^9},ExpressionUUID->"c634655f-8d16-f04f-a9ff-\
c7812ed006e5"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"U", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{"dt", ",", " ", "dr", ",", " ", "dtheta", ",", " ", "dphi"}], 
     "}"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"Ulnrf", "=", 
   RowBox[{"genUlnrf", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ulnrf", " ", "//", "MatrixForm"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"UlnrfN", " ", "=", 
   RowBox[{"Simplify", " ", "[", 
    RowBox[{
     RowBox[{"Ulnrf", "/", 
      RowBox[{"Part", "[", 
       RowBox[{"Ulnrf", ",", "1"}], "]"}]}], ",", 
     RowBox[{"Assumptions", "->", "assume"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"UlnrfN", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.933851675577676*^9, 3.933851686760352*^9}, {
  3.933851735891951*^9, 3.933851756204345*^9}, {3.933851827320006*^9, 
  3.933851958670968*^9}, {3.933932352683338*^9, 3.933932354375801*^9}, {
  3.933933286353787*^9, 3.933933297034184*^9}, {3.933933989737817*^9, 
  3.933933991537427*^9}, {3.933934127933151*^9, 3.9339341295235157`*^9}, {
  3.933940818863429*^9, 3.933940819858439*^9}, {3.9339408594684143`*^9, 
  3.933940860222914*^9}, {3.934001475112189*^9, 3.934001480459841*^9}, {
  3.934003813542688*^9, 3.934003814048861*^9}, {3.934012293335507*^9, 
  3.934012313386685*^9}, {3.934013027602186*^9, 3.93401303513273*^9}, {
  3.934018893738085*^9, 3.9340189004969597`*^9}, {3.9342873119342003`*^9, 
  3.9342873387068663`*^9}, {3.935050576550626*^9, 3.935050588430151*^9}, {
  3.935050697220103*^9, 3.93505074411895*^9}},
 CellLabel->"In[95]:=",ExpressionUUID->"bbb3b868-ef02-d043-82ac-6db52f99a920"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{"dt", "+", 
        FractionBox[
         RowBox[{"16", " ", 
          SuperscriptBox["a", "2"], " ", "dt", " ", 
          SuperscriptBox[
           RowBox[{"Cos", "[", "theta", "]"}], "2"]}], "r"]}]},
      {
       RowBox[{"dr", " ", 
        SqrtBox[
         FractionBox["r", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "r"}]]]}]},
      {
       RowBox[{"dtheta", " ", 
        RowBox[{"(", 
         RowBox[{"r", "+", 
          RowBox[{"16", " ", 
           SuperscriptBox["a", "2"], " ", 
           SuperscriptBox[
            RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}]}]},
      {
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "a", " ", "dt"}], "+", 
           RowBox[{"dphi", " ", 
            SuperscriptBox["r", "3"]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"8", " ", 
            SuperscriptBox["a", "2"]}], "+", "r", "+", 
           RowBox[{"8", " ", 
            SuperscriptBox["a", "2"], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", "theta"}], "]"}]}]}], ")"}], " ", 
         RowBox[{"Sin", "[", "theta", "]"}]}], 
        SuperscriptBox["r", "3"]]}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.9339332973313*^9, 3.933933992071515*^9, 3.933934129849415*^9, 
   3.933935308195323*^9, 3.933935685136438*^9, 3.9339364260200863`*^9, 
   3.933940820175276*^9, 3.933940860497727*^9, {3.934001471645872*^9, 
   3.9340014808960333`*^9}, 3.934004123570328*^9, 3.934004938133095*^9, 
   3.934005213712189*^9, 3.934005288954352*^9, 3.934005334777742*^9, 
   3.934012313653006*^9, 3.934013035454797*^9, 3.934014193423417*^9, 
   3.934017840273621*^9, {3.934018895097146*^9, 3.934018901058065*^9}, 
   3.934024387583971*^9, 3.93428265042798*^9, 3.934283236076844*^9, 
   3.934283544120026*^9, 3.934284181312636*^9, 3.934285360334037*^9, {
   3.934287304330793*^9, 3.934287338932934*^9}, 3.934287406357931*^9, 
   3.934348488118412*^9, 3.934360255145986*^9, 3.934360296441523*^9, 
   3.934360344119531*^9, 3.93436682145949*^9, 3.934375411912318*^9, 
   3.934484939320122*^9, 3.9345402605057077`*^9, 3.9348080302915173`*^9, 
   3.934868666031741*^9, 3.9348687922031107`*^9, 3.934978617780509*^9, 
   3.934981605282173*^9, 3.935050589473458*^9, 3.935050640517662*^9, {
   3.935050683034323*^9, 3.935050704287129*^9}, 3.9350507451352863`*^9, 
   3.935065816401063*^9, 3.935084174058779*^9, 3.9351418039290667`*^9, 
   3.935247005399332*^9, 3.9352582109994383`*^9, 3.935500558049031*^9, 
   3.9355732449879913`*^9, 3.935575180516111*^9, 3.936039116106577*^9, 
   3.9446444313937893`*^9, 3.971422720136931*^9},
 CellLabel->
  "Out[97]//MatrixForm=",ExpressionUUID->"4b3d0b2f-dfce-4ddb-945f-\
73752d9b23c1"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {"1"},
      {
       FractionBox[
        RowBox[{"dr", " ", "r", " ", 
         SqrtBox[
          FractionBox["r", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "r"}]]]}], 
        RowBox[{
         RowBox[{"dt", " ", "r"}], "+", 
         RowBox[{"16", " ", 
          SuperscriptBox["a", "2"], " ", "dt", " ", 
          SuperscriptBox[
           RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}]]},
      {
       FractionBox[
        RowBox[{"dtheta", " ", "r"}], "dt"]},
      {
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{"2", " ", "a"}], 
            SuperscriptBox["r", "2"]]}], "+", 
          FractionBox[
           RowBox[{"dphi", " ", "r"}], "dt"]}], ")"}], " ", 
        RowBox[{"Sin", "[", "theta", "]"}]}]}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.9339332973313*^9, 3.933933992071515*^9, 3.933934129849415*^9, 
   3.933935308195323*^9, 3.933935685136438*^9, 3.9339364260200863`*^9, 
   3.933940820175276*^9, 3.933940860497727*^9, {3.934001471645872*^9, 
   3.9340014808960333`*^9}, 3.934004123570328*^9, 3.934004938133095*^9, 
   3.934005213712189*^9, 3.934005288954352*^9, 3.934005334777742*^9, 
   3.934012313653006*^9, 3.934013035454797*^9, 3.934014193423417*^9, 
   3.934017840273621*^9, {3.934018895097146*^9, 3.934018901058065*^9}, 
   3.934024387583971*^9, 3.93428265042798*^9, 3.934283236076844*^9, 
   3.934283544120026*^9, 3.934284181312636*^9, 3.934285360334037*^9, {
   3.934287304330793*^9, 3.934287338932934*^9}, 3.934287406357931*^9, 
   3.934348488118412*^9, 3.934360255145986*^9, 3.934360296441523*^9, 
   3.934360344119531*^9, 3.93436682145949*^9, 3.934375411912318*^9, 
   3.934484939320122*^9, 3.9345402605057077`*^9, 3.9348080302915173`*^9, 
   3.934868666031741*^9, 3.9348687922031107`*^9, 3.934978617780509*^9, 
   3.934981605282173*^9, 3.935050589473458*^9, 3.935050640517662*^9, {
   3.935050683034323*^9, 3.935050704287129*^9}, 3.9350507451352863`*^9, 
   3.935065816401063*^9, 3.935084174058779*^9, 3.9351418039290667`*^9, 
   3.935247005399332*^9, 3.9352582109994383`*^9, 3.935500558049031*^9, 
   3.9355732449879913`*^9, 3.935575180516111*^9, 3.936039116106577*^9, 
   3.9446444313937893`*^9, 3.971422720153305*^9},
 CellLabel->
  "Out[99]//MatrixForm=",ExpressionUUID->"8963ea10-c1dd-4ae4-b053-\
37fd0b7b9ee0"]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["3. Compute Tidal Tensors and Test", "Section",
 CellChangeTimes->{{3.934005891057271*^9, 3.934005895421377*^9}, {
  3.9350542893627777`*^9, 3.935054303775754*^9}, {3.935055321429405*^9, 
  3.935055321646806*^9}},ExpressionUUID->"4fd9ff9b-cf85-8f4d-9d7a-\
e5fd5eccf79b"],

Cell[CellGroupData[{

Cell["Tidal tensor in different frames", "Subsection",
 CellChangeTimes->{{3.935054367421761*^9, 3.9350543917158537`*^9}, {
  3.935054444470669*^9, 3.9350544457369328`*^9}, {3.935055267011847*^9, 
  3.9350552758019114`*^9}},ExpressionUUID->"c8d820af-330c-488a-a919-\
8130b9f677e0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clnrf", "=", 
   RowBox[{"genClnrf", "[", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ClnrfH", "=", 
   RowBox[{"genClnrfH", "[", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Cobs", "=", 
   RowBox[{"genCobs", "[", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"CobsH", "=", 
   RowBox[{"genCobsH", "[", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.933853077732523*^9, 3.933853095775056*^9}, {
   3.93385341737712*^9, 3.933853424761711*^9}, {3.9338544386413116`*^9, 
   3.933854441425411*^9}, 3.9339323495542088`*^9, {3.93480804458367*^9, 
   3.934808047112509*^9}, 3.9350507847694407`*^9},
 CellLabel->
  "In[100]:=",ExpressionUUID->"d50d875e-e2d3-8f47-af56-ad99d0d3354e"],

Cell["\<\
Lorentz boost to local free falling frame to get local tensor\
\>", "Text",
 CellChangeTimes->{{3.934005908155973*^9, 3.934005924355298*^9}, {
  3.935051450303854*^9, 3.9350514544332314`*^9}, {3.935054451382663*^9, 
  3.935054471575951*^9}},ExpressionUUID->"435a4df2-1188-9d49-83b7-\
f2766ad91827"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"lorentz", " ", "=", " ", 
   RowBox[{"genLorentz", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lorentzinv", "=", 
   RowBox[{"genLorentzinv", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClocH", " ", "=", " ", 
   RowBox[{"genClocH", "[", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBmIQfTDveVub/1vHyoifvSB63Wzj5g4gvWzu1jYQPaXM
aBuI/hVkvR1EH3Bpugeieb6veACiP0e0/AfRFqkNDJ1AernihLXdQPoF//71
3WD91zaDaL7W49tB9A8uiT0g+vWjiftBNJP381M9QNpb+A2YPsETdRFEPw/Y
9hxE/4i/9RlEr3gs/xNEq2wW+QeizbfkCvYCaS1XjwwQvcLdF0xLX2NPNwp4
67jHlxdMN6x2XtYc+NZx5dSSdSB62WGdzSC6Zk7XThC9rvHMXhB9I5zrEIhe
FRF6CkTLXToPpl/yimjFB711ZNB2BtMA6t6eAw==
  "],
 CellLabel->
  "In[104]:=",ExpressionUUID->"1c21f494-e612-4442-8f8c-dbca43a3b0d0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"reduced", "=", 
   RowBox[{"ClocH", "/.", "dsub"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.935501209500247*^9, 3.935501220642673*^9}, {
   3.9355762790143003`*^9, 3.9355762792834873`*^9}, 3.9446445657552357`*^9},
 CellLabel->
  "In[107]:=",ExpressionUUID->"3f1d7e49-fab1-4e4b-a2c2-09abb7f75d6e"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"testmat", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"reduced", "/.", 
      RowBox[{"{", 
       RowBox[{"theta", "->", 
        RowBox[{"Pi", "/", "2"}]}], "}"}]}], ",", 
     RowBox[{"Assumptions", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"r", ">", "1"}], ",", 
        RowBox[{"ep", ">", "0"}]}], "}"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"testmat", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.93550082243306*^9, 3.935500854204556*^9}, {
   3.935501227473573*^9, 3.935501284639308*^9}, {3.9355013161268597`*^9, 
   3.935501351556422*^9}, {3.9355733347673407`*^9, 3.935573336144547*^9}, {
   3.9355752087712297`*^9, 3.935575281930434*^9}, {3.935575344121163*^9, 
   3.93557542932696*^9}, {3.9355754638386383`*^9, 3.9355755093887053`*^9}, {
   3.935576242148654*^9, 3.935576243112563*^9}, {3.935576340405283*^9, 
   3.9355763413355923`*^9}, {3.936039144561268*^9, 3.936039201218113*^9}, {
   3.9360392885179195`*^9, 3.9360392893871174`*^9}, 3.944644455755575*^9, {
   3.9446444902428455`*^9, 3.9446444925153656`*^9}, {3.944644526403143*^9, 
   3.944644539555784*^9}, {3.971422738008387*^9, 3.971422738457301*^9}},
 CellLabel->
  "In[110]:=",ExpressionUUID->"3219ae83-14b8-440f-8fd9-279196419302"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0"},
     {"0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              SuperscriptBox["ep", "2"]}], ")"}], "2"]}], " ", 
          SuperscriptBox["lz", "2"], " ", 
          SuperscriptBox["r", "16"]}], "-", 
         RowBox[{"96", " ", 
          SuperscriptBox["a", "6"], " ", 
          SuperscriptBox["lz", "4"], " ", 
          SuperscriptBox["r", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "9"}], "+", 
            RowBox[{"28", " ", 
             SuperscriptBox["lz", "2"], " ", 
             SuperscriptBox["r", "2"], " ", 
             SqrtBox[
              FractionBox["1", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "2"}], " ", "a", " ", "lz"}], "+", 
                  RowBox[{"ep", " ", 
                   SuperscriptBox["r", "3"]}]}], ")"}], "2"]]]}], "+", 
            RowBox[{"r", " ", 
             RowBox[{"(", 
              RowBox[{"9", "-", 
               RowBox[{"30", " ", 
                SuperscriptBox["lz", "2"], " ", 
                SqrtBox[
                 FractionBox["1", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "a", " ", "lz"}], "+", 
                    RowBox[{"ep", " ", 
                    SuperscriptBox["r", "3"]}]}], ")"}], "2"]]]}]}], 
              ")"}]}]}], ")"}]}], "+", 
         RowBox[{"96", " ", 
          SuperscriptBox["a", "5"], " ", "ep", " ", 
          SuperscriptBox["lz", "3"], " ", 
          SuperscriptBox["r", "5"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "18"}], "+", 
            RowBox[{"58", " ", 
             SuperscriptBox["lz", "2"], " ", 
             SuperscriptBox["r", "2"], " ", 
             SqrtBox[
              FractionBox["1", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "2"}], " ", "a", " ", "lz"}], "+", 
                  RowBox[{"ep", " ", 
                   SuperscriptBox["r", "3"]}]}], ")"}], "2"]]]}], "-", 
            RowBox[{"9", " ", "r", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "2"}], "+", 
               RowBox[{"7", " ", 
                SuperscriptBox["lz", "2"], " ", 
                SqrtBox[
                 FractionBox["1", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "a", " ", "lz"}], "+", 
                    RowBox[{"ep", " ", 
                    SuperscriptBox["r", "3"]}]}], ")"}], "2"]]]}]}], 
              ")"}]}]}], ")"}]}], "+", 
         RowBox[{"2", " ", "a", " ", "ep", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            SuperscriptBox["ep", "2"]}], ")"}], " ", "lz", " ", 
          SuperscriptBox["r", "13"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"3", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               SuperscriptBox["ep", "2"]}], ")"}], " ", 
             SuperscriptBox["r", "5"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "3"}], "+", 
               RowBox[{"2", " ", "r"}]}], ")"}], " ", 
             SqrtBox[
              FractionBox["1", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "2"}], " ", "a", " ", "lz"}], "+", 
                  RowBox[{"ep", " ", 
                   SuperscriptBox["r", "3"]}]}], ")"}], "2"]]]}], "+", 
            RowBox[{
             SuperscriptBox["lz", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "5"}], "+", 
               RowBox[{"6", " ", "r"}], "+", 
               RowBox[{"9", " ", 
                SuperscriptBox["r", "3"], " ", 
                SqrtBox[
                 FractionBox["1", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "a", " ", "lz"}], "+", 
                    RowBox[{"ep", " ", 
                    SuperscriptBox["r", "3"]}]}], ")"}], "2"]]]}], "-", 
               RowBox[{"6", " ", 
                SuperscriptBox["r", "4"], " ", 
                SqrtBox[
                 FractionBox["1", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "a", " ", "lz"}], "+", 
                    RowBox[{"ep", " ", 
                    SuperscriptBox["r", "3"]}]}], ")"}], "2"]]]}]}], 
              ")"}]}]}], ")"}]}], "+", 
         RowBox[{"8", " ", 
          SuperscriptBox["a", "3"], " ", "ep", " ", "lz", " ", 
          SuperscriptBox["r", "7"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"54", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               SuperscriptBox["ep", "2"]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "r"}], ")"}], " ", 
             SuperscriptBox["r", "4"]}], "+", 
            RowBox[{
             SuperscriptBox["lz", "4"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "59"}], "+", 
               RowBox[{"54", " ", "r"}], "+", 
               RowBox[{"99", " ", 
                SuperscriptBox["r", "3"], " ", 
                SqrtBox[
                 FractionBox["1", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "a", " ", "lz"}], "+", 
                    RowBox[{"ep", " ", 
                    SuperscriptBox["r", "3"]}]}], ")"}], "2"]]]}], "-", 
               RowBox[{"90", " ", 
                SuperscriptBox["r", "4"], " ", 
                SqrtBox[
                 FractionBox["1", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "a", " ", "lz"}], "+", 
                    RowBox[{"ep", " ", 
                    SuperscriptBox["r", "3"]}]}], ")"}], "2"]]]}]}], ")"}]}], 
            "+", 
            RowBox[{"6", " ", 
             SuperscriptBox["lz", "2"], " ", 
             SuperscriptBox["r", "2"], " ", 
             RowBox[{"(", 
              RowBox[{"12", "-", 
               RowBox[{"12", " ", "r"}], "+", 
               RowBox[{"3", " ", 
                RowBox[{"(", 
                 RowBox[{"7", "-", 
                  RowBox[{"13", " ", 
                   SuperscriptBox["ep", "2"]}]}], ")"}], " ", 
                SuperscriptBox["r", "3"], " ", 
                SqrtBox[
                 FractionBox["1", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "a", " ", "lz"}], "+", 
                    RowBox[{"ep", " ", 
                    SuperscriptBox["r", "3"]}]}], ")"}], "2"]]]}], "+", 
               RowBox[{"2", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "9"}], "+", 
                  RowBox[{"17", " ", 
                   SuperscriptBox["ep", "2"]}]}], ")"}], " ", 
                SuperscriptBox["r", "4"], " ", 
                SqrtBox[
                 FractionBox["1", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "a", " ", "lz"}], "+", 
                    RowBox[{"ep", " ", 
                    SuperscriptBox["r", "3"]}]}], ")"}], "2"]]]}]}], 
              ")"}]}]}], ")"}]}], "+", 
         RowBox[{"16", " ", 
          SuperscriptBox["a", "4"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "27"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               RowBox[{"3", " ", 
                SuperscriptBox["ep", "2"]}]}], ")"}], " ", 
             SuperscriptBox["lz", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "r"}], ")"}], " ", 
             SuperscriptBox["r", "8"]}], "+", 
            RowBox[{
             SuperscriptBox["lz", "6"], " ", 
             SuperscriptBox["r", "4"], " ", 
             RowBox[{"(", 
              RowBox[{"26", "-", 
               RowBox[{"24", " ", "r"}], "-", 
               RowBox[{"45", " ", 
                SuperscriptBox["r", "3"], " ", 
                SqrtBox[
                 FractionBox["1", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "a", " ", "lz"}], "+", 
                    RowBox[{"ep", " ", 
                    SuperscriptBox["r", "3"]}]}], ")"}], "2"]]]}], "+", 
               RowBox[{"42", " ", 
                SuperscriptBox["r", "4"], " ", 
                SqrtBox[
                 FractionBox["1", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "a", " ", "lz"}], "+", 
                    RowBox[{"ep", " ", 
                    SuperscriptBox["r", "3"]}]}], ")"}], "2"]]]}]}], ")"}]}], 
            "-", 
            RowBox[{"6", " ", 
             SuperscriptBox["lz", "4"], " ", 
             SuperscriptBox["r", "6"], " ", 
             RowBox[{"(", 
              RowBox[{"6", "-", 
               RowBox[{"6", " ", "r"}], "+", 
               RowBox[{"3", " ", 
                RowBox[{"(", 
                 RowBox[{"3", "-", 
                  RowBox[{"17", " ", 
                   SuperscriptBox["ep", "2"]}]}], ")"}], " ", 
                SuperscriptBox["r", "3"], " ", 
                SqrtBox[
                 FractionBox["1", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "a", " ", "lz"}], "+", 
                    RowBox[{"ep", " ", 
                    SuperscriptBox["r", "3"]}]}], ")"}], "2"]]]}], "+", 
               RowBox[{"2", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "4"}], "+", 
                  RowBox[{"23", " ", 
                   SuperscriptBox["ep", "2"]}]}], ")"}], " ", 
                SuperscriptBox["r", "4"], " ", 
                SqrtBox[
                 FractionBox["1", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "a", " ", "lz"}], "+", 
                    RowBox[{"ep", " ", 
                    SuperscriptBox["r", "3"]}]}], ")"}], "2"]]]}]}], 
              ")"}]}]}], ")"}]}], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["a", "2"], " ", 
          SuperscriptBox["r", "10"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "27"}], " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                SuperscriptBox["ep", "2"]}], ")"}], "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "r"}], ")"}], " ", 
             SuperscriptBox["r", "4"]}], "-", 
            RowBox[{"6", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               SuperscriptBox["ep", "2"]}], ")"}], " ", 
             SuperscriptBox["lz", "2"], " ", 
             SuperscriptBox["r", "2"], " ", 
             RowBox[{"(", 
              RowBox[{"12", "-", 
               RowBox[{"12", " ", "r"}], "+", 
               RowBox[{"3", " ", 
                RowBox[{"(", 
                 RowBox[{"1", "-", 
                  RowBox[{"9", " ", 
                   SuperscriptBox["ep", "2"]}]}], ")"}], " ", 
                SuperscriptBox["r", "3"], " ", 
                SqrtBox[
                 FractionBox["1", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "a", " ", "lz"}], "+", 
                    RowBox[{"ep", " ", 
                    SuperscriptBox["r", "3"]}]}], ")"}], "2"]]]}], "+", 
               RowBox[{"2", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", 
                  RowBox[{"11", " ", 
                   SuperscriptBox["ep", "2"]}]}], ")"}], " ", 
                SuperscriptBox["r", "4"], " ", 
                SqrtBox[
                 FractionBox["1", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "a", " ", "lz"}], "+", 
                    RowBox[{"ep", " ", 
                    SuperscriptBox["r", "3"]}]}], ")"}], "2"]]]}]}], ")"}]}], 
            "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["lz", "4"], " ", 
             RowBox[{"(", 
              RowBox[{"11", "-", 
               RowBox[{"12", " ", "r"}], "+", 
               RowBox[{"9", " ", 
                SuperscriptBox["r", "3"], " ", 
                SqrtBox[
                 FractionBox["1", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "a", " ", "lz"}], "+", 
                    RowBox[{"ep", " ", 
                    SuperscriptBox["r", "3"]}]}], ")"}], "2"]]]}], "-", 
               RowBox[{"6", " ", 
                SuperscriptBox["r", "4"], " ", 
                SqrtBox[
                 FractionBox["1", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "a", " ", "lz"}], "+", 
                    RowBox[{"ep", " ", 
                    SuperscriptBox["r", "3"]}]}], ")"}], "2"]]]}], "+", 
               RowBox[{
                SuperscriptBox["ep", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{"39", "-", 
                  RowBox[{"36", " ", "r"}], "-", 
                  RowBox[{"63", " ", 
                   SuperscriptBox["r", "3"], " ", 
                   SqrtBox[
                    FractionBox["1", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "a", " ", "lz"}], "+", 
                    RowBox[{"ep", " ", 
                    SuperscriptBox["r", "3"]}]}], ")"}], "2"]]]}], "+", 
                  RowBox[{"54", " ", 
                   SuperscriptBox["r", "4"], " ", 
                   SqrtBox[
                    FractionBox["1", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "a", " ", "lz"}], "+", 
                    RowBox[{"ep", " ", 
                    SuperscriptBox["r", "3"]}]}], ")"}], "2"]]]}]}], 
                 ")"}]}]}], ")"}]}]}], ")"}]}]}], 
        RowBox[{"2", " ", 
         SuperscriptBox["r", "9"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"4", " ", 
             SuperscriptBox["a", "2"], " ", 
             SuperscriptBox["lz", "2"]}], "-", 
            RowBox[{"4", " ", "a", " ", "ep", " ", "lz", " ", 
             SuperscriptBox["r", "3"]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               SuperscriptBox["ep", "2"]}], ")"}], " ", 
             SuperscriptBox["r", "6"]}]}], ")"}], "2"]}]]}], "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         SqrtBox[
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SuperscriptBox["ep", "2"], "+", 
           FractionBox[
            RowBox[{"4", " ", 
             SuperscriptBox["a", "2"], " ", 
             SuperscriptBox["lz", "2"]}], 
            SuperscriptBox["r", "6"]], "-", 
           FractionBox[
            RowBox[{"4", " ", "a", " ", "ep", " ", "lz"}], 
            SuperscriptBox["r", "3"]], "-", 
           FractionBox[
            SuperscriptBox["lz", "2"], 
            SuperscriptBox["r", "2"]]}]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                SuperscriptBox["ep", "2"]}], ")"}], "2"]}], " ", "lz", " ", 
            SuperscriptBox["r", "13"]}], "-", 
           RowBox[{"96", " ", 
            SuperscriptBox["a", "6"], " ", 
            SuperscriptBox["lz", "5"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "15"}], "+", 
              RowBox[{"14", " ", "r"}]}], ")"}], " ", 
            SqrtBox[
             FractionBox["1", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "2"}], " ", "a", " ", "lz"}], "+", 
                 RowBox[{"ep", " ", 
                  SuperscriptBox["r", "3"]}]}], ")"}], "2"]]]}], "+", 
           RowBox[{"48", " ", 
            SuperscriptBox["a", "5"], " ", "ep", " ", 
            SuperscriptBox["lz", "4"], " ", 
            SuperscriptBox["r", "3"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "63"}], "+", 
              RowBox[{"58", " ", "r"}]}], ")"}], " ", 
            SqrtBox[
             FractionBox["1", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "2"}], " ", "a", " ", "lz"}], "+", 
                 RowBox[{"ep", " ", 
                  SuperscriptBox["r", "3"]}]}], ")"}], "2"]]]}], "+", 
           RowBox[{"a", " ", "ep", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              SuperscriptBox["ep", "2"]}], ")"}], " ", 
            SuperscriptBox["r", "10"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"3", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", 
                 SuperscriptBox["ep", "2"]}], ")"}], " ", 
               SuperscriptBox["r", "5"], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "3"}], "+", 
                 RowBox[{"2", " ", "r"}]}], ")"}], " ", 
               SqrtBox[
                FractionBox["1", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "a", " ", "lz"}], "+", 
                    RowBox[{"ep", " ", 
                    SuperscriptBox["r", "3"]}]}], ")"}], "2"]]]}], "-", 
              RowBox[{"2", " ", 
               SuperscriptBox["lz", "2"], " ", 
               RowBox[{"(", 
                RowBox[{"5", "-", 
                 RowBox[{"6", " ", "r"}], "-", 
                 RowBox[{"9", " ", 
                  SuperscriptBox["r", "3"], " ", 
                  SqrtBox[
                   FractionBox["1", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "a", " ", "lz"}], "+", 
                    RowBox[{"ep", " ", 
                    SuperscriptBox["r", "3"]}]}], ")"}], "2"]]]}], "+", 
                 RowBox[{"6", " ", 
                  SuperscriptBox["r", "4"], " ", 
                  SqrtBox[
                   FractionBox["1", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "a", " ", "lz"}], "+", 
                    RowBox[{"ep", " ", 
                    SuperscriptBox["r", "3"]}]}], ")"}], "2"]]]}]}], 
                ")"}]}]}], ")"}]}], "+", 
           RowBox[{"8", " ", 
            SuperscriptBox["a", "3"], " ", "ep", " ", 
            SuperscriptBox["lz", "2"], " ", 
            SuperscriptBox["r", "4"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox["lz", "2"], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "59"}], "+", 
                 RowBox[{"54", " ", "r"}], "+", 
                 RowBox[{"99", " ", 
                  SuperscriptBox["r", "3"], " ", 
                  SqrtBox[
                   FractionBox["1", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "a", " ", "lz"}], "+", 
                    RowBox[{"ep", " ", 
                    SuperscriptBox["r", "3"]}]}], ")"}], "2"]]]}], "-", 
                 RowBox[{"90", " ", 
                  SuperscriptBox["r", "4"], " ", 
                  SqrtBox[
                   FractionBox["1", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "a", " ", "lz"}], "+", 
                    RowBox[{"ep", " ", 
                    SuperscriptBox["r", "3"]}]}], ")"}], "2"]]]}]}], ")"}]}], 
              "+", 
              RowBox[{"3", " ", 
               SuperscriptBox["r", "2"], " ", 
               RowBox[{"(", 
                RowBox[{"12", "-", 
                 RowBox[{"12", " ", "r"}], "+", 
                 RowBox[{"3", " ", 
                  RowBox[{"(", 
                   RowBox[{"7", "-", 
                    RowBox[{"13", " ", 
                    SuperscriptBox["ep", "2"]}]}], ")"}], " ", 
                  SuperscriptBox["r", "3"], " ", 
                  SqrtBox[
                   FractionBox["1", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "a", " ", "lz"}], "+", 
                    RowBox[{"ep", " ", 
                    SuperscriptBox["r", "3"]}]}], ")"}], "2"]]]}], "+", 
                 RowBox[{"2", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "9"}], "+", 
                    RowBox[{"17", " ", 
                    SuperscriptBox["ep", "2"]}]}], ")"}], " ", 
                  SuperscriptBox["r", "4"], " ", 
                  SqrtBox[
                   FractionBox["1", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "a", " ", "lz"}], "+", 
                    RowBox[{"ep", " ", 
                    SuperscriptBox["r", "3"]}]}], ")"}], "2"]]]}]}], 
                ")"}]}]}], ")"}]}], "+", 
           RowBox[{"16", " ", 
            SuperscriptBox["a", "4"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox["lz", "5"], " ", "r", " ", 
               RowBox[{"(", 
                RowBox[{"26", "-", 
                 RowBox[{"24", " ", "r"}], "-", 
                 RowBox[{"45", " ", 
                  SuperscriptBox["r", "3"], " ", 
                  SqrtBox[
                   FractionBox["1", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "a", " ", "lz"}], "+", 
                    RowBox[{"ep", " ", 
                    SuperscriptBox["r", "3"]}]}], ")"}], "2"]]]}], "+", 
                 RowBox[{"42", " ", 
                  SuperscriptBox["r", "4"], " ", 
                  SqrtBox[
                   FractionBox["1", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "a", " ", "lz"}], "+", 
                    RowBox[{"ep", " ", 
                    SuperscriptBox["r", "3"]}]}], ")"}], "2"]]]}]}], ")"}]}], 
              "-", 
              RowBox[{"3", " ", 
               SuperscriptBox["lz", "3"], " ", 
               SuperscriptBox["r", "3"], " ", 
               RowBox[{"(", 
                RowBox[{"6", "-", 
                 RowBox[{"6", " ", "r"}], "+", 
                 RowBox[{"3", " ", 
                  RowBox[{"(", 
                   RowBox[{"3", "-", 
                    RowBox[{"17", " ", 
                    SuperscriptBox["ep", "2"]}]}], ")"}], " ", 
                  SuperscriptBox["r", "3"], " ", 
                  SqrtBox[
                   FractionBox["1", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "a", " ", "lz"}], "+", 
                    RowBox[{"ep", " ", 
                    SuperscriptBox["r", "3"]}]}], ")"}], "2"]]]}], "+", 
                 RowBox[{"2", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "4"}], "+", 
                    RowBox[{"23", " ", 
                    SuperscriptBox["ep", "2"]}]}], ")"}], " ", 
                  SuperscriptBox["r", "4"], " ", 
                  SqrtBox[
                   FractionBox["1", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "a", " ", "lz"}], "+", 
                    RowBox[{"ep", " ", 
                    SuperscriptBox["r", "3"]}]}], ")"}], "2"]]]}]}], 
                ")"}]}]}], ")"}]}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["a", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "3"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", 
                 SuperscriptBox["ep", "2"]}], ")"}], " ", "lz", " ", 
               SuperscriptBox["r", "9"], " ", 
               RowBox[{"(", 
                RowBox[{"12", "-", 
                 RowBox[{"12", " ", "r"}], "+", 
                 RowBox[{"3", " ", 
                  RowBox[{"(", 
                   RowBox[{"1", "-", 
                    RowBox[{"9", " ", 
                    SuperscriptBox["ep", "2"]}]}], ")"}], " ", 
                  SuperscriptBox["r", "3"], " ", 
                  SqrtBox[
                   FractionBox["1", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "a", " ", "lz"}], "+", 
                    RowBox[{"ep", " ", 
                    SuperscriptBox["r", "3"]}]}], ")"}], "2"]]]}], "+", 
                 RowBox[{"2", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"11", " ", 
                    SuperscriptBox["ep", "2"]}]}], ")"}], " ", 
                  SuperscriptBox["r", "4"], " ", 
                  SqrtBox[
                   FractionBox["1", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "a", " ", "lz"}], "+", 
                    RowBox[{"ep", " ", 
                    SuperscriptBox["r", "3"]}]}], ")"}], "2"]]]}]}], ")"}]}], 
              "+", 
              RowBox[{"2", " ", 
               SuperscriptBox["lz", "3"], " ", 
               SuperscriptBox["r", "7"], " ", 
               RowBox[{"(", 
                RowBox[{"11", "-", 
                 RowBox[{"12", " ", "r"}], "+", 
                 RowBox[{"9", " ", 
                  SuperscriptBox["r", "3"], " ", 
                  SqrtBox[
                   FractionBox["1", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "a", " ", "lz"}], "+", 
                    RowBox[{"ep", " ", 
                    SuperscriptBox["r", "3"]}]}], ")"}], "2"]]]}], "-", 
                 RowBox[{"6", " ", 
                  SuperscriptBox["r", "4"], " ", 
                  SqrtBox[
                   FractionBox["1", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "a", " ", "lz"}], "+", 
                    RowBox[{"ep", " ", 
                    SuperscriptBox["r", "3"]}]}], ")"}], "2"]]]}], "+", 
                 RowBox[{
                  SuperscriptBox["ep", "2"], " ", 
                  RowBox[{"(", 
                   RowBox[{"39", "-", 
                    RowBox[{"36", " ", "r"}], "-", 
                    RowBox[{"63", " ", 
                    SuperscriptBox["r", "3"], " ", 
                    SqrtBox[
                    FractionBox["1", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "a", " ", "lz"}], "+", 
                    RowBox[{"ep", " ", 
                    SuperscriptBox["r", "3"]}]}], ")"}], "2"]]]}], "+", 
                    RowBox[{"54", " ", 
                    SuperscriptBox["r", "4"], " ", 
                    SqrtBox[
                    FractionBox["1", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "a", " ", "lz"}], "+", 
                    RowBox[{"ep", " ", 
                    SuperscriptBox["r", "3"]}]}], ")"}], "2"]]]}]}], 
                   ")"}]}]}], ")"}]}]}], ")"}]}]}], ")"}]}], 
        RowBox[{"2", " ", 
         SuperscriptBox["r", "5"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"4", " ", 
             SuperscriptBox["a", "2"], " ", 
             SuperscriptBox["lz", "2"]}], "-", 
            RowBox[{"4", " ", "a", " ", "ep", " ", "lz", " ", 
             SuperscriptBox["r", "3"]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               SuperscriptBox["ep", "2"]}], ")"}], " ", 
             SuperscriptBox["r", "6"]}]}], ")"}], "2"]}]]}]},
     {"0", "0", 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", "256"}], " ", 
         SuperscriptBox["a", "4"], " ", 
         SuperscriptBox["lz", "2"]}], "+", 
        RowBox[{"256", " ", 
         SuperscriptBox["a", "3"], " ", "ep", " ", "lz", " ", 
         SuperscriptBox["r", "3"]}], "-", 
        RowBox[{"3", " ", 
         SuperscriptBox["lz", "2"], " ", 
         SuperscriptBox["r", "4"]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SuperscriptBox["ep", "2"]}], ")"}], " ", 
         SuperscriptBox["r", "6"]}], "+", 
        RowBox[{"4", " ", "a", " ", "ep", " ", "lz", " ", 
         SuperscriptBox["r", "3"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "4"}], "+", 
           RowBox[{"3", " ", "r"}]}], ")"}]}], "+", 
        RowBox[{"4", " ", 
         SuperscriptBox["a", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "16"}], " ", 
            SuperscriptBox["ep", "2"], " ", 
            SuperscriptBox["r", "6"]}], "+", 
           RowBox[{
            SuperscriptBox["lz", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"7", "-", 
              RowBox[{"6", " ", "r"}], "+", 
              RowBox[{"16", " ", 
               SuperscriptBox["r", "4"]}]}], ")"}]}]}], ")"}]}]}], 
       RowBox[{"2", " ", 
        SuperscriptBox["r", "9"]}]], "0"},
     {"0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         SqrtBox[
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SuperscriptBox["ep", "2"], "+", 
           FractionBox[
            RowBox[{"4", " ", 
             SuperscriptBox["a", "2"], " ", 
             SuperscriptBox["lz", "2"]}], 
            SuperscriptBox["r", "6"]], "-", 
           FractionBox[
            RowBox[{"4", " ", "a", " ", "ep", " ", "lz"}], 
            SuperscriptBox["r", "3"]], "-", 
           FractionBox[
            SuperscriptBox["lz", "2"], 
            SuperscriptBox["r", "2"]]}]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                SuperscriptBox["ep", "2"]}], ")"}], "2"]}], " ", "lz", " ", 
            SuperscriptBox["r", "13"]}], "-", 
           RowBox[{"96", " ", 
            SuperscriptBox["a", "6"], " ", 
            SuperscriptBox["lz", "5"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "15"}], "+", 
              RowBox[{"14", " ", "r"}]}], ")"}], " ", 
            SqrtBox[
             FractionBox["1", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "2"}], " ", "a", " ", "lz"}], "+", 
                 RowBox[{"ep", " ", 
                  SuperscriptBox["r", "3"]}]}], ")"}], "2"]]]}], "+", 
           RowBox[{"48", " ", 
            SuperscriptBox["a", "5"], " ", "ep", " ", 
            SuperscriptBox["lz", "4"], " ", 
            SuperscriptBox["r", "3"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "63"}], "+", 
              RowBox[{"58", " ", "r"}]}], ")"}], " ", 
            SqrtBox[
             FractionBox["1", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "2"}], " ", "a", " ", "lz"}], "+", 
                 RowBox[{"ep", " ", 
                  SuperscriptBox["r", "3"]}]}], ")"}], "2"]]]}], "+", 
           RowBox[{"a", " ", "ep", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              SuperscriptBox["ep", "2"]}], ")"}], " ", 
            SuperscriptBox["r", "10"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"3", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", 
                 SuperscriptBox["ep", "2"]}], ")"}], " ", 
               SuperscriptBox["r", "5"], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "3"}], "+", 
                 RowBox[{"2", " ", "r"}]}], ")"}], " ", 
               SqrtBox[
                FractionBox["1", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "a", " ", "lz"}], "+", 
                    RowBox[{"ep", " ", 
                    SuperscriptBox["r", "3"]}]}], ")"}], "2"]]]}], "-", 
              RowBox[{"2", " ", 
               SuperscriptBox["lz", "2"], " ", 
               RowBox[{"(", 
                RowBox[{"5", "-", 
                 RowBox[{"6", " ", "r"}], "-", 
                 RowBox[{"9", " ", 
                  SuperscriptBox["r", "3"], " ", 
                  SqrtBox[
                   FractionBox["1", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "a", " ", "lz"}], "+", 
                    RowBox[{"ep", " ", 
                    SuperscriptBox["r", "3"]}]}], ")"}], "2"]]]}], "+", 
                 RowBox[{"6", " ", 
                  SuperscriptBox["r", "4"], " ", 
                  SqrtBox[
                   FractionBox["1", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "a", " ", "lz"}], "+", 
                    RowBox[{"ep", " ", 
                    SuperscriptBox["r", "3"]}]}], ")"}], "2"]]]}]}], 
                ")"}]}]}], ")"}]}], "+", 
           RowBox[{"8", " ", 
            SuperscriptBox["a", "3"], " ", "ep", " ", 
            SuperscriptBox["lz", "2"], " ", 
            SuperscriptBox["r", "4"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox["lz", "2"], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "59"}], "+", 
                 RowBox[{"54", " ", "r"}], "+", 
                 RowBox[{"99", " ", 
                  SuperscriptBox["r", "3"], " ", 
                  SqrtBox[
                   FractionBox["1", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "a", " ", "lz"}], "+", 
                    RowBox[{"ep", " ", 
                    SuperscriptBox["r", "3"]}]}], ")"}], "2"]]]}], "-", 
                 RowBox[{"90", " ", 
                  SuperscriptBox["r", "4"], " ", 
                  SqrtBox[
                   FractionBox["1", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "a", " ", "lz"}], "+", 
                    RowBox[{"ep", " ", 
                    SuperscriptBox["r", "3"]}]}], ")"}], "2"]]]}]}], ")"}]}], 
              "+", 
              RowBox[{"3", " ", 
               SuperscriptBox["r", "2"], " ", 
               RowBox[{"(", 
                RowBox[{"12", "-", 
                 RowBox[{"12", " ", "r"}], "+", 
                 RowBox[{"3", " ", 
                  RowBox[{"(", 
                   RowBox[{"7", "-", 
                    RowBox[{"13", " ", 
                    SuperscriptBox["ep", "2"]}]}], ")"}], " ", 
                  SuperscriptBox["r", "3"], " ", 
                  SqrtBox[
                   FractionBox["1", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "a", " ", "lz"}], "+", 
                    RowBox[{"ep", " ", 
                    SuperscriptBox["r", "3"]}]}], ")"}], "2"]]]}], "+", 
                 RowBox[{"2", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "9"}], "+", 
                    RowBox[{"17", " ", 
                    SuperscriptBox["ep", "2"]}]}], ")"}], " ", 
                  SuperscriptBox["r", "4"], " ", 
                  SqrtBox[
                   FractionBox["1", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "a", " ", "lz"}], "+", 
                    RowBox[{"ep", " ", 
                    SuperscriptBox["r", "3"]}]}], ")"}], "2"]]]}]}], 
                ")"}]}]}], ")"}]}], "+", 
           RowBox[{"16", " ", 
            SuperscriptBox["a", "4"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox["lz", "5"], " ", "r", " ", 
               RowBox[{"(", 
                RowBox[{"26", "-", 
                 RowBox[{"24", " ", "r"}], "-", 
                 RowBox[{"45", " ", 
                  SuperscriptBox["r", "3"], " ", 
                  SqrtBox[
                   FractionBox["1", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "a", " ", "lz"}], "+", 
                    RowBox[{"ep", " ", 
                    SuperscriptBox["r", "3"]}]}], ")"}], "2"]]]}], "+", 
                 RowBox[{"42", " ", 
                  SuperscriptBox["r", "4"], " ", 
                  SqrtBox[
                   FractionBox["1", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "a", " ", "lz"}], "+", 
                    RowBox[{"ep", " ", 
                    SuperscriptBox["r", "3"]}]}], ")"}], "2"]]]}]}], ")"}]}], 
              "-", 
              RowBox[{"3", " ", 
               SuperscriptBox["lz", "3"], " ", 
               SuperscriptBox["r", "3"], " ", 
               RowBox[{"(", 
                RowBox[{"6", "-", 
                 RowBox[{"6", " ", "r"}], "+", 
                 RowBox[{"3", " ", 
                  RowBox[{"(", 
                   RowBox[{"3", "-", 
                    RowBox[{"17", " ", 
                    SuperscriptBox["ep", "2"]}]}], ")"}], " ", 
                  SuperscriptBox["r", "3"], " ", 
                  SqrtBox[
                   FractionBox["1", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "a", " ", "lz"}], "+", 
                    RowBox[{"ep", " ", 
                    SuperscriptBox["r", "3"]}]}], ")"}], "2"]]]}], "+", 
                 RowBox[{"2", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "4"}], "+", 
                    RowBox[{"23", " ", 
                    SuperscriptBox["ep", "2"]}]}], ")"}], " ", 
                  SuperscriptBox["r", "4"], " ", 
                  SqrtBox[
                   FractionBox["1", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "a", " ", "lz"}], "+", 
                    RowBox[{"ep", " ", 
                    SuperscriptBox["r", "3"]}]}], ")"}], "2"]]]}]}], 
                ")"}]}]}], ")"}]}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["a", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "3"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", 
                 SuperscriptBox["ep", "2"]}], ")"}], " ", "lz", " ", 
               SuperscriptBox["r", "9"], " ", 
               RowBox[{"(", 
                RowBox[{"12", "-", 
                 RowBox[{"12", " ", "r"}], "+", 
                 RowBox[{"3", " ", 
                  RowBox[{"(", 
                   RowBox[{"1", "-", 
                    RowBox[{"9", " ", 
                    SuperscriptBox["ep", "2"]}]}], ")"}], " ", 
                  SuperscriptBox["r", "3"], " ", 
                  SqrtBox[
                   FractionBox["1", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "a", " ", "lz"}], "+", 
                    RowBox[{"ep", " ", 
                    SuperscriptBox["r", "3"]}]}], ")"}], "2"]]]}], "+", 
                 RowBox[{"2", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"11", " ", 
                    SuperscriptBox["ep", "2"]}]}], ")"}], " ", 
                  SuperscriptBox["r", "4"], " ", 
                  SqrtBox[
                   FractionBox["1", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "a", " ", "lz"}], "+", 
                    RowBox[{"ep", " ", 
                    SuperscriptBox["r", "3"]}]}], ")"}], "2"]]]}]}], ")"}]}], 
              "+", 
              RowBox[{"2", " ", 
               SuperscriptBox["lz", "3"], " ", 
               SuperscriptBox["r", "7"], " ", 
               RowBox[{"(", 
                RowBox[{"11", "-", 
                 RowBox[{"12", " ", "r"}], "+", 
                 RowBox[{"9", " ", 
                  SuperscriptBox["r", "3"], " ", 
                  SqrtBox[
                   FractionBox["1", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "a", " ", "lz"}], "+", 
                    RowBox[{"ep", " ", 
                    SuperscriptBox["r", "3"]}]}], ")"}], "2"]]]}], "-", 
                 RowBox[{"6", " ", 
                  SuperscriptBox["r", "4"], " ", 
                  SqrtBox[
                   FractionBox["1", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "a", " ", "lz"}], "+", 
                    RowBox[{"ep", " ", 
                    SuperscriptBox["r", "3"]}]}], ")"}], "2"]]]}], "+", 
                 RowBox[{
                  SuperscriptBox["ep", "2"], " ", 
                  RowBox[{"(", 
                   RowBox[{"39", "-", 
                    RowBox[{"36", " ", "r"}], "-", 
                    RowBox[{"63", " ", 
                    SuperscriptBox["r", "3"], " ", 
                    SqrtBox[
                    FractionBox["1", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "a", " ", "lz"}], "+", 
                    RowBox[{"ep", " ", 
                    SuperscriptBox["r", "3"]}]}], ")"}], "2"]]]}], "+", 
                    RowBox[{"54", " ", 
                    SuperscriptBox["r", "4"], " ", 
                    SqrtBox[
                    FractionBox["1", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "a", " ", "lz"}], "+", 
                    RowBox[{"ep", " ", 
                    SuperscriptBox["r", "3"]}]}], ")"}], "2"]]]}]}], 
                   ")"}]}]}], ")"}]}]}], ")"}]}]}], ")"}]}], 
        RowBox[{"2", " ", 
         SuperscriptBox["r", "5"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"4", " ", 
             SuperscriptBox["a", "2"], " ", 
             SuperscriptBox["lz", "2"]}], "-", 
            RowBox[{"4", " ", "a", " ", "ep", " ", "lz", " ", 
             SuperscriptBox["r", "3"]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               SuperscriptBox["ep", "2"]}], ")"}], " ", 
             SuperscriptBox["r", "6"]}]}], ")"}], "2"]}]]}], "0", 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             SuperscriptBox["ep", "2"]}], ")"}], "2"]}], " ", 
         SuperscriptBox["r", "16"], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["lz", "2"], "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              SuperscriptBox["ep", "2"]}], ")"}], " ", 
            SuperscriptBox["r", "2"]}]}], ")"}]}], "+", 
        RowBox[{"2", " ", "a", " ", "ep", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SuperscriptBox["ep", "2"]}], ")"}], " ", "lz", " ", 
         SuperscriptBox["r", "13"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["lz", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "5"}], "+", 
              RowBox[{"6", " ", "r"}], "+", 
              RowBox[{"9", " ", 
               SuperscriptBox["r", "3"], " ", 
               SqrtBox[
                FractionBox["1", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "a", " ", "lz"}], "+", 
                    RowBox[{"ep", " ", 
                    SuperscriptBox["r", "3"]}]}], ")"}], "2"]]]}], "-", 
              RowBox[{"6", " ", 
               SuperscriptBox["r", "4"], " ", 
               SqrtBox[
                FractionBox["1", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "a", " ", "lz"}], "+", 
                    RowBox[{"ep", " ", 
                    SuperscriptBox["r", "3"]}]}], ")"}], "2"]]]}]}], ")"}]}], 
           "+", 
           RowBox[{"3", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              SuperscriptBox["ep", "2"]}], ")"}], " ", 
            SuperscriptBox["r", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"2", " ", "r"}], "-", 
              RowBox[{"3", " ", 
               SuperscriptBox["r", "3"], " ", 
               SqrtBox[
                FractionBox["1", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "a", " ", "lz"}], "+", 
                    RowBox[{"ep", " ", 
                    SuperscriptBox["r", "3"]}]}], ")"}], "2"]]]}], "+", 
              RowBox[{"2", " ", 
               SuperscriptBox["r", "4"], " ", 
               SqrtBox[
                FractionBox["1", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "a", " ", "lz"}], "+", 
                    RowBox[{"ep", " ", 
                    SuperscriptBox["r", "3"]}]}], ")"}], "2"]]]}]}], 
             ")"}]}]}], ")"}]}], "+", 
        RowBox[{"96", " ", 
         SuperscriptBox["a", "5"], " ", "ep", " ", 
         SuperscriptBox["lz", "3"], " ", 
         SuperscriptBox["r", "3"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"6", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "r"}], ")"}], " ", 
            SuperscriptBox["r", "2"]}], "+", 
           RowBox[{
            SuperscriptBox["lz", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"37", "-", 
              RowBox[{"34", " ", "r"}], "-", 
              RowBox[{"63", " ", 
               SuperscriptBox["r", "3"], " ", 
               SqrtBox[
                FractionBox["1", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "a", " ", "lz"}], "+", 
                    RowBox[{"ep", " ", 
                    SuperscriptBox["r", "3"]}]}], ")"}], "2"]]]}], "+", 
              RowBox[{"58", " ", 
               SuperscriptBox["r", "4"], " ", 
               SqrtBox[
                FractionBox["1", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "a", " ", "lz"}], "+", 
                    RowBox[{"ep", " ", 
                    SuperscriptBox["r", "3"]}]}], ")"}], "2"]]]}]}], 
             ")"}]}]}], ")"}]}], "-", 
        RowBox[{"32", " ", 
         SuperscriptBox["a", "6"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"9", " ", 
            SuperscriptBox["lz", "4"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "r"}], ")"}], " ", 
            SuperscriptBox["r", "2"]}], "+", 
           RowBox[{
            SuperscriptBox["lz", "6"], " ", 
            RowBox[{"(", 
             RowBox[{"52", "-", 
              RowBox[{"48", " ", "r"}], "-", 
              RowBox[{"90", " ", 
               SuperscriptBox["r", "3"], " ", 
               SqrtBox[
                FractionBox["1", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "a", " ", "lz"}], "+", 
                    RowBox[{"ep", " ", 
                    SuperscriptBox["r", "3"]}]}], ")"}], "2"]]]}], "+", 
              RowBox[{"84", " ", 
               SuperscriptBox["r", "4"], " ", 
               SqrtBox[
                FractionBox["1", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "a", " ", "lz"}], "+", 
                    RowBox[{"ep", " ", 
                    SuperscriptBox["r", "3"]}]}], ")"}], "2"]]]}]}], 
             ")"}]}]}], ")"}]}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["a", "2"], " ", 
         SuperscriptBox["r", "10"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "9"}], " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               SuperscriptBox["ep", "2"]}], ")"}], "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "r"}], ")"}], " ", 
            SuperscriptBox["r", "4"]}], "-", 
           RowBox[{"6", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              SuperscriptBox["ep", "2"]}], ")"}], " ", 
            SuperscriptBox["lz", "2"], " ", 
            SuperscriptBox["r", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"4", "-", 
              RowBox[{"4", " ", "r"}], "+", 
              RowBox[{"3", " ", 
               SuperscriptBox["r", "3"], " ", 
               SqrtBox[
                FractionBox["1", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "a", " ", "lz"}], "+", 
                    RowBox[{"ep", " ", 
                    SuperscriptBox["r", "3"]}]}], ")"}], "2"]]]}], "-", 
              RowBox[{"2", " ", 
               SuperscriptBox["r", "4"], " ", 
               SqrtBox[
                FractionBox["1", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "a", " ", "lz"}], "+", 
                    RowBox[{"ep", " ", 
                    SuperscriptBox["r", "3"]}]}], ")"}], "2"]]]}], "+", 
              RowBox[{
               SuperscriptBox["ep", "2"], " ", 
               RowBox[{"(", 
                RowBox[{"16", "-", 
                 RowBox[{"16", " ", "r"}], "-", 
                 RowBox[{"27", " ", 
                  SuperscriptBox["r", "3"], " ", 
                  SqrtBox[
                   FractionBox["1", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "a", " ", "lz"}], "+", 
                    RowBox[{"ep", " ", 
                    SuperscriptBox["r", "3"]}]}], ")"}], "2"]]]}], "+", 
                 RowBox[{"22", " ", 
                  SuperscriptBox["r", "4"], " ", 
                  SqrtBox[
                   FractionBox["1", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "a", " ", "lz"}], "+", 
                    RowBox[{"ep", " ", 
                    SuperscriptBox["r", "3"]}]}], ")"}], "2"]]]}]}], 
                ")"}]}]}], ")"}]}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["lz", "4"], " ", 
            RowBox[{"(", 
             RowBox[{"11", "-", 
              RowBox[{"12", " ", "r"}], "+", 
              RowBox[{"9", " ", 
               SuperscriptBox["r", "3"], " ", 
               SqrtBox[
                FractionBox["1", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "a", " ", "lz"}], "+", 
                    RowBox[{"ep", " ", 
                    SuperscriptBox["r", "3"]}]}], ")"}], "2"]]]}], "-", 
              RowBox[{"6", " ", 
               SuperscriptBox["r", "4"], " ", 
               SqrtBox[
                FractionBox["1", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "a", " ", "lz"}], "+", 
                    RowBox[{"ep", " ", 
                    SuperscriptBox["r", "3"]}]}], ")"}], "2"]]]}], "+", 
              RowBox[{
               SuperscriptBox["ep", "2"], " ", 
               RowBox[{"(", 
                RowBox[{"39", "-", 
                 RowBox[{"36", " ", "r"}], "-", 
                 RowBox[{"63", " ", 
                  SuperscriptBox["r", "3"], " ", 
                  SqrtBox[
                   FractionBox["1", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "a", " ", "lz"}], "+", 
                    RowBox[{"ep", " ", 
                    SuperscriptBox["r", "3"]}]}], ")"}], "2"]]]}], "+", 
                 RowBox[{"54", " ", 
                  SuperscriptBox["r", "4"], " ", 
                  SqrtBox[
                   FractionBox["1", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "a", " ", "lz"}], "+", 
                    RowBox[{"ep", " ", 
                    SuperscriptBox["r", "3"]}]}], ")"}], "2"]]]}]}], 
                ")"}]}]}], ")"}]}]}], ")"}]}], "+", 
        RowBox[{"16", " ", 
         SuperscriptBox["a", "4"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "9"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              RowBox[{"3", " ", 
               SuperscriptBox["ep", "2"]}]}], ")"}], " ", 
            SuperscriptBox["lz", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "r"}], ")"}], " ", 
            SuperscriptBox["r", "8"]}], "+", 
           RowBox[{
            SuperscriptBox["lz", "6"], " ", 
            SuperscriptBox["r", "4"], " ", 
            RowBox[{"(", 
             RowBox[{"26", "-", 
              RowBox[{"24", " ", "r"}], "-", 
              RowBox[{"45", " ", 
               SuperscriptBox["r", "3"], " ", 
               SqrtBox[
                FractionBox["1", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "a", " ", "lz"}], "+", 
                    RowBox[{"ep", " ", 
                    SuperscriptBox["r", "3"]}]}], ")"}], "2"]]]}], "+", 
              RowBox[{"42", " ", 
               SuperscriptBox["r", "4"], " ", 
               SqrtBox[
                FractionBox["1", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "a", " ", "lz"}], "+", 
                    RowBox[{"ep", " ", 
                    SuperscriptBox["r", "3"]}]}], ")"}], "2"]]]}]}], ")"}]}], 
           "-", 
           RowBox[{"3", " ", 
            SuperscriptBox["lz", "4"], " ", 
            SuperscriptBox["r", "6"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "5"}], "+", 
              RowBox[{"4", " ", "r"}], "+", 
              RowBox[{"18", " ", 
               SuperscriptBox["r", "3"], " ", 
               SqrtBox[
                FractionBox["1", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "a", " ", "lz"}], "+", 
                    RowBox[{"ep", " ", 
                    SuperscriptBox["r", "3"]}]}], ")"}], "2"]]]}], "-", 
              RowBox[{"16", " ", 
               SuperscriptBox["r", "4"], " ", 
               SqrtBox[
                FractionBox["1", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "a", " ", "lz"}], "+", 
                    RowBox[{"ep", " ", 
                    SuperscriptBox["r", "3"]}]}], ")"}], "2"]]]}], "+", 
              RowBox[{
               SuperscriptBox["ep", "2"], " ", 
               RowBox[{"(", 
                RowBox[{"61", "-", 
                 RowBox[{"56", " ", "r"}], "-", 
                 RowBox[{"102", " ", 
                  SuperscriptBox["r", "3"], " ", 
                  SqrtBox[
                   FractionBox["1", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "a", " ", "lz"}], "+", 
                    RowBox[{"ep", " ", 
                    SuperscriptBox["r", "3"]}]}], ")"}], "2"]]]}], "+", 
                 RowBox[{"92", " ", 
                  SuperscriptBox["r", "4"], " ", 
                  SqrtBox[
                   FractionBox["1", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "a", " ", "lz"}], "+", 
                    RowBox[{"ep", " ", 
                    SuperscriptBox["r", "3"]}]}], ")"}], "2"]]]}]}], 
                ")"}]}]}], ")"}]}]}], ")"}]}], "+", 
        RowBox[{"8", " ", 
         SuperscriptBox["a", "3"], " ", "ep", " ", "lz", " ", 
         SuperscriptBox["r", "7"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"18", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              SuperscriptBox["ep", "2"]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "r"}], ")"}], " ", 
            SuperscriptBox["r", "4"]}], "+", 
           RowBox[{
            SuperscriptBox["lz", "4"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "59"}], "+", 
              RowBox[{"54", " ", "r"}], "+", 
              RowBox[{"99", " ", 
               SuperscriptBox["r", "3"], " ", 
               SqrtBox[
                FractionBox["1", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "a", " ", "lz"}], "+", 
                    RowBox[{"ep", " ", 
                    SuperscriptBox["r", "3"]}]}], ")"}], "2"]]]}], "-", 
              RowBox[{"90", " ", 
               SuperscriptBox["r", "4"], " ", 
               SqrtBox[
                FractionBox["1", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "a", " ", "lz"}], "+", 
                    RowBox[{"ep", " ", 
                    SuperscriptBox["r", "3"]}]}], ")"}], "2"]]]}]}], ")"}]}], 
           "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["lz", "2"], " ", 
            SuperscriptBox["r", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "3"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "7"}], "+", 
                 RowBox[{"6", " ", "r"}]}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", 
                 RowBox[{"3", " ", 
                  SuperscriptBox["r", "3"], " ", 
                  SqrtBox[
                   FractionBox["1", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "a", " ", "lz"}], "+", 
                    RowBox[{"ep", " ", 
                    SuperscriptBox["r", "3"]}]}], ")"}], "2"]]]}]}], ")"}]}], 
              "+", 
              RowBox[{
               SuperscriptBox["ep", "2"], " ", 
               RowBox[{"(", 
                RowBox[{"71", "-", 
                 RowBox[{"66", " ", "r"}], "-", 
                 RowBox[{"117", " ", 
                  SuperscriptBox["r", "3"], " ", 
                  SqrtBox[
                   FractionBox["1", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "a", " ", "lz"}], "+", 
                    RowBox[{"ep", " ", 
                    SuperscriptBox["r", "3"]}]}], ")"}], "2"]]]}], "+", 
                 RowBox[{"102", " ", 
                  SuperscriptBox["r", "4"], " ", 
                  SqrtBox[
                   FractionBox["1", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "a", " ", "lz"}], "+", 
                    RowBox[{"ep", " ", 
                    SuperscriptBox["r", "3"]}]}], ")"}], "2"]]]}]}], 
                ")"}]}]}], ")"}]}]}], ")"}]}]}], 
       RowBox[{"2", " ", 
        SuperscriptBox["r", "9"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"4", " ", 
            SuperscriptBox["a", "2"], " ", 
            SuperscriptBox["lz", "2"]}], "-", 
           RowBox[{"4", " ", "a", " ", "ep", " ", "lz", " ", 
            SuperscriptBox["r", "3"]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              SuperscriptBox["ep", "2"]}], ")"}], " ", 
            SuperscriptBox["r", "6"]}]}], ")"}], "2"]}]]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.9355754050070543`*^9, 3.9355754327746572`*^9}, 
   3.935575469638761*^9, {3.93557550019549*^9, 3.93557551122392*^9}, 
   3.9355762446509323`*^9, 3.9355762819534683`*^9, 3.935576341914535*^9, {
   3.936039138843979*^9, 3.936039202005289*^9}, 3.936039290095276*^9, {
   3.9446444463250217`*^9, 3.944644456099251*^9}, 3.944644492835037*^9, {
   3.9446445267540073`*^9, 3.9446445398212852`*^9}, 3.9446445903568935`*^9, {
   3.971422735949665*^9, 3.9714227392905827`*^9}},
 CellLabel->
  "Out[111]//MatrixForm=",ExpressionUUID->"0f3b4e02-fe5e-4fbe-a46a-\
d9effe56c5ba"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"Eigenvalues", "[", "testmat", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.935501292038332*^9, 3.935501296778561*^9}, {
   3.935501371305449*^9, 3.935501382396245*^9}, {3.935501991901003*^9, 
   3.935501993154793*^9}, 3.9355733904702*^9, {3.93557552464431*^9, 
   3.935575542469161*^9}, {3.936039162898409*^9, 3.9360391644087486`*^9}, 
   3.9360392046898956`*^9},
 CellLabel->
  "In[112]:=",ExpressionUUID->"1a94873a-0904-49a4-a6b0-a64f32c663c3"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", 
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"-", "256"}], " ", 
      SuperscriptBox["a", "4"], " ", 
      SuperscriptBox["lz", "2"]}], "+", 
     RowBox[{"256", " ", 
      SuperscriptBox["a", "3"], " ", "ep", " ", "lz", " ", 
      SuperscriptBox["r", "3"]}], "-", 
     RowBox[{"3", " ", 
      SuperscriptBox["lz", "2"], " ", 
      SuperscriptBox["r", "4"]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox["ep", "2"]}], ")"}], " ", 
      SuperscriptBox["r", "6"]}], "+", 
     RowBox[{"4", " ", "a", " ", "ep", " ", "lz", " ", 
      SuperscriptBox["r", "3"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "4"}], "+", 
        RowBox[{"3", " ", "r"}]}], ")"}]}], "+", 
     RowBox[{"4", " ", 
      SuperscriptBox["a", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "16"}], " ", 
         SuperscriptBox["ep", "2"], " ", 
         SuperscriptBox["r", "6"]}], "+", 
        RowBox[{
         SuperscriptBox["lz", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"7", "-", 
           RowBox[{"6", " ", "r"}], "+", 
           RowBox[{"16", " ", 
            SuperscriptBox["r", "4"]}]}], ")"}]}]}], ")"}]}]}], 
    RowBox[{"2", " ", 
     SuperscriptBox["r", "9"]}]], ",", 
   RowBox[{"-", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"4", " ", 
       SuperscriptBox["r", "9"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"4", " ", 
           SuperscriptBox["a", "2"], " ", 
           SuperscriptBox["lz", "2"]}], "-", 
          RowBox[{"4", " ", "a", " ", "ep", " ", "lz", " ", 
           SuperscriptBox["r", "3"]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             SuperscriptBox["ep", "2"]}], ")"}], " ", 
           SuperscriptBox["r", "6"]}]}], ")"}], "2"]}]], 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["r", "18"], "-", 
       RowBox[{"3", " ", 
        SuperscriptBox["ep", "2"], " ", 
        SuperscriptBox["r", "18"]}], "+", 
       RowBox[{"3", " ", 
        SuperscriptBox["ep", "4"], " ", 
        SuperscriptBox["r", "18"]}], "-", 
       RowBox[{
        SuperscriptBox["ep", "6"], " ", 
        SuperscriptBox["r", "18"]}], "+", 
       RowBox[{"6", " ", "a", " ", "ep", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SuperscriptBox["ep", "2"]}], ")"}], "2"], " ", "lz", " ", 
        SuperscriptBox["r", "15"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"2", " ", "r"}]}], ")"}]}], "-", 
       RowBox[{"12", " ", 
        SuperscriptBox["a", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SuperscriptBox["ep", "2"]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "r"}], ")"}], " ", 
        SuperscriptBox["r", "12"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"8", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"2", " ", 
              SuperscriptBox["ep", "2"]}]}], ")"}], " ", 
           SuperscriptBox["lz", "2"]}], "+", 
          RowBox[{"3", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             SuperscriptBox["ep", "2"]}], ")"}], " ", 
           SuperscriptBox["r", "2"]}]}], ")"}]}], "-", 
       RowBox[{"64", " ", 
        SuperscriptBox["a", "6"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"9", " ", 
           SuperscriptBox["lz", "4"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "r"}], ")"}], " ", 
           SuperscriptBox["r", "2"]}], "+", 
          RowBox[{
           SuperscriptBox["lz", "6"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "26"}], "+", 
             RowBox[{"24", " ", "r"}]}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{"96", " ", 
        SuperscriptBox["a", "5"], " ", "ep", " ", 
        SuperscriptBox["lz", "3"], " ", 
        SuperscriptBox["r", "3"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"12", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "r"}], ")"}], " ", 
           SuperscriptBox["r", "2"]}], "+", 
          RowBox[{
           SuperscriptBox["lz", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "37"}], "+", 
             RowBox[{"34", " ", "r"}]}], ")"}]}]}], ")"}]}], "-", 
       RowBox[{"48", " ", 
        SuperscriptBox["a", "4"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"6", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"3", " ", 
              SuperscriptBox["ep", "2"]}]}], ")"}], " ", 
           SuperscriptBox["lz", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "r"}], ")"}], " ", 
           SuperscriptBox["r", "8"]}], "+", 
          RowBox[{
           SuperscriptBox["lz", "4"], " ", 
           SuperscriptBox["r", "6"], " ", 
           RowBox[{"(", 
            RowBox[{"17", "-", 
             RowBox[{"16", " ", "r"}], "+", 
             RowBox[{
              SuperscriptBox["ep", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "61"}], "+", 
                RowBox[{"56", " ", "r"}]}], ")"}]}]}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{"16", " ", 
        SuperscriptBox["a", "3"], " ", "ep", " ", "lz", " ", 
        SuperscriptBox["r", "9"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"18", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             SuperscriptBox["ep", "2"]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "r"}], ")"}], " ", 
           SuperscriptBox["r", "2"]}], "+", 
          RowBox[{
           SuperscriptBox["lz", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"57", "-", 
             RowBox[{"54", " ", "r"}], "+", 
             RowBox[{
              SuperscriptBox["ep", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "71"}], "+", 
                RowBox[{"66", " ", "r"}]}], ")"}]}]}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{"\[Sqrt]", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"4", " ", 
              SuperscriptBox["a", "2"], " ", 
              SuperscriptBox["lz", "2"]}], "-", 
             RowBox[{"4", " ", "a", " ", "ep", " ", "lz", " ", 
              SuperscriptBox["r", "3"]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                SuperscriptBox["ep", "2"]}], ")"}], " ", 
              SuperscriptBox["r", "6"]}]}], ")"}], "4"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                SuperscriptBox["ep", "2"]}], ")"}], "2"], " ", 
             SuperscriptBox["r", "12"]}], "-", 
            RowBox[{"4", " ", "a", " ", "ep", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               SuperscriptBox["ep", "2"]}], ")"}], " ", "lz", " ", 
             SuperscriptBox["r", "9"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "7"}], "+", 
               RowBox[{"6", " ", "r"}]}], ")"}]}], "+", 
            RowBox[{"16", " ", 
             SuperscriptBox["a", "4"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"4", " ", 
                SuperscriptBox["lz", "4"], " ", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"13", "-", 
                   RowBox[{"12", " ", "r"}]}], ")"}], "2"]}], "+", 
               RowBox[{"9", " ", 
                SuperscriptBox["lz", "2"], " ", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"11", "-", 
                   RowBox[{"10", " ", "r"}]}], ")"}], "2"], " ", 
                SuperscriptBox["r", "2"]}], "+", 
               RowBox[{"324", " ", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "r"}], ")"}], "2"], " ", 
                SuperscriptBox["r", "4"]}]}], ")"}]}], "-", 
            RowBox[{"16", " ", 
             SuperscriptBox["a", "3"], " ", "ep", " ", "lz", " ", 
             SuperscriptBox["r", "3"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"9", " ", 
                SuperscriptBox["r", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{"31", "-", 
                  RowBox[{"46", " ", "r"}], "+", 
                  RowBox[{"16", " ", 
                   SuperscriptBox["r", "2"]}]}], ")"}]}], "+", 
               RowBox[{"2", " ", 
                SuperscriptBox["lz", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{"91", "-", 
                  RowBox[{"162", " ", "r"}], "+", 
                  RowBox[{"72", " ", 
                   SuperscriptBox["r", "2"]}]}], ")"}]}]}], ")"}]}], "+", 
            RowBox[{"4", " ", 
             SuperscriptBox["a", "2"], " ", 
             SuperscriptBox["r", "6"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"9", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", 
                  SuperscriptBox["ep", "2"]}], ")"}], " ", 
                SuperscriptBox["r", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{"13", "-", 
                  RowBox[{"16", " ", "r"}], "+", 
                  RowBox[{"4", " ", 
                   SuperscriptBox["r", "2"]}]}], ")"}]}], "+", 
               RowBox[{
                SuperscriptBox["lz", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "101"}], "+", 
                  RowBox[{"132", " ", "r"}], "-", 
                  RowBox[{"36", " ", 
                   SuperscriptBox["r", "2"]}], "+", 
                  RowBox[{
                   SuperscriptBox["ep", "2"], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "3"}], "-", 
                    RowBox[{"36", " ", "r"}], "+", 
                    RowBox[{"36", " ", 
                    SuperscriptBox["r", "2"]}]}], ")"}]}]}], ")"}]}]}], 
              ")"}]}]}], ")"}]}], ")"}]}]}], ")"}]}]}], ",", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"4", " ", 
      SuperscriptBox["r", "9"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"4", " ", 
          SuperscriptBox["a", "2"], " ", 
          SuperscriptBox["lz", "2"]}], "-", 
         RowBox[{"4", " ", "a", " ", "ep", " ", "lz", " ", 
          SuperscriptBox["r", "3"]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            SuperscriptBox["ep", "2"]}], ")"}], " ", 
          SuperscriptBox["r", "6"]}]}], ")"}], "2"]}]], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["r", "18"]}], "+", 
      RowBox[{"3", " ", 
       SuperscriptBox["ep", "2"], " ", 
       SuperscriptBox["r", "18"]}], "-", 
      RowBox[{"3", " ", 
       SuperscriptBox["ep", "4"], " ", 
       SuperscriptBox["r", "18"]}], "+", 
      RowBox[{
       SuperscriptBox["ep", "6"], " ", 
       SuperscriptBox["r", "18"]}], "-", 
      RowBox[{"6", " ", "a", " ", "ep", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SuperscriptBox["ep", "2"]}], ")"}], "2"], " ", "lz", " ", 
       SuperscriptBox["r", "15"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"2", " ", "r"}]}], ")"}]}], "+", 
      RowBox[{"12", " ", 
       SuperscriptBox["a", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         SuperscriptBox["ep", "2"]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "r"}], ")"}], " ", 
       SuperscriptBox["r", "12"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"8", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["ep", "2"]}]}], ")"}], " ", 
          SuperscriptBox["lz", "2"]}], "+", 
         RowBox[{"3", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            SuperscriptBox["ep", "2"]}], ")"}], " ", 
          SuperscriptBox["r", "2"]}]}], ")"}]}], "+", 
      RowBox[{"64", " ", 
       SuperscriptBox["a", "6"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"9", " ", 
          SuperscriptBox["lz", "4"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "r"}], ")"}], " ", 
          SuperscriptBox["r", "2"]}], "+", 
         RowBox[{
          SuperscriptBox["lz", "6"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "26"}], "+", 
            RowBox[{"24", " ", "r"}]}], ")"}]}]}], ")"}]}], "-", 
      RowBox[{"96", " ", 
       SuperscriptBox["a", "5"], " ", "ep", " ", 
       SuperscriptBox["lz", "3"], " ", 
       SuperscriptBox["r", "3"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"12", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "r"}], ")"}], " ", 
          SuperscriptBox["r", "2"]}], "+", 
         RowBox[{
          SuperscriptBox["lz", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "37"}], "+", 
            RowBox[{"34", " ", "r"}]}], ")"}]}]}], ")"}]}], "+", 
      RowBox[{"48", " ", 
       SuperscriptBox["a", "4"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"6", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"3", " ", 
             SuperscriptBox["ep", "2"]}]}], ")"}], " ", 
          SuperscriptBox["lz", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "r"}], ")"}], " ", 
          SuperscriptBox["r", "8"]}], "+", 
         RowBox[{
          SuperscriptBox["lz", "4"], " ", 
          SuperscriptBox["r", "6"], " ", 
          RowBox[{"(", 
           RowBox[{"17", "-", 
            RowBox[{"16", " ", "r"}], "+", 
            RowBox[{
             SuperscriptBox["ep", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "61"}], "+", 
               RowBox[{"56", " ", "r"}]}], ")"}]}]}], ")"}]}]}], ")"}]}], "-", 
      RowBox[{"16", " ", 
       SuperscriptBox["a", "3"], " ", "ep", " ", "lz", " ", 
       SuperscriptBox["r", "9"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"18", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            SuperscriptBox["ep", "2"]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "r"}], ")"}], " ", 
          SuperscriptBox["r", "2"]}], "+", 
         RowBox[{
          SuperscriptBox["lz", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"57", "-", 
            RowBox[{"54", " ", "r"}], "+", 
            RowBox[{
             SuperscriptBox["ep", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "71"}], "+", 
               RowBox[{"66", " ", "r"}]}], ")"}]}]}], ")"}]}]}], ")"}]}], "+", 
      RowBox[{"\[Sqrt]", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"4", " ", 
             SuperscriptBox["a", "2"], " ", 
             SuperscriptBox["lz", "2"]}], "-", 
            RowBox[{"4", " ", "a", " ", "ep", " ", "lz", " ", 
             SuperscriptBox["r", "3"]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               SuperscriptBox["ep", "2"]}], ")"}], " ", 
             SuperscriptBox["r", "6"]}]}], ")"}], "4"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               SuperscriptBox["ep", "2"]}], ")"}], "2"], " ", 
            SuperscriptBox["r", "12"]}], "-", 
           RowBox[{"4", " ", "a", " ", "ep", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              SuperscriptBox["ep", "2"]}], ")"}], " ", "lz", " ", 
            SuperscriptBox["r", "9"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "7"}], "+", 
              RowBox[{"6", " ", "r"}]}], ")"}]}], "+", 
           RowBox[{"16", " ", 
            SuperscriptBox["a", "4"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"4", " ", 
               SuperscriptBox["lz", "4"], " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"13", "-", 
                  RowBox[{"12", " ", "r"}]}], ")"}], "2"]}], "+", 
              RowBox[{"9", " ", 
               SuperscriptBox["lz", "2"], " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"11", "-", 
                  RowBox[{"10", " ", "r"}]}], ")"}], "2"], " ", 
               SuperscriptBox["r", "2"]}], "+", 
              RowBox[{"324", " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "r"}], ")"}], "2"], " ", 
               SuperscriptBox["r", "4"]}]}], ")"}]}], "-", 
           RowBox[{"16", " ", 
            SuperscriptBox["a", "3"], " ", "ep", " ", "lz", " ", 
            SuperscriptBox["r", "3"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"9", " ", 
               SuperscriptBox["r", "2"], " ", 
               RowBox[{"(", 
                RowBox[{"31", "-", 
                 RowBox[{"46", " ", "r"}], "+", 
                 RowBox[{"16", " ", 
                  SuperscriptBox["r", "2"]}]}], ")"}]}], "+", 
              RowBox[{"2", " ", 
               SuperscriptBox["lz", "2"], " ", 
               RowBox[{"(", 
                RowBox[{"91", "-", 
                 RowBox[{"162", " ", "r"}], "+", 
                 RowBox[{"72", " ", 
                  SuperscriptBox["r", "2"]}]}], ")"}]}]}], ")"}]}], "+", 
           RowBox[{"4", " ", 
            SuperscriptBox["a", "2"], " ", 
            SuperscriptBox["r", "6"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"9", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", 
                 SuperscriptBox["ep", "2"]}], ")"}], " ", 
               SuperscriptBox["r", "2"], " ", 
               RowBox[{"(", 
                RowBox[{"13", "-", 
                 RowBox[{"16", " ", "r"}], "+", 
                 RowBox[{"4", " ", 
                  SuperscriptBox["r", "2"]}]}], ")"}]}], "+", 
              RowBox[{
               SuperscriptBox["lz", "2"], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "101"}], "+", 
                 RowBox[{"132", " ", "r"}], "-", 
                 RowBox[{"36", " ", 
                  SuperscriptBox["r", "2"]}], "+", 
                 RowBox[{
                  SuperscriptBox["ep", "2"], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "3"}], "-", 
                    RowBox[{"36", " ", "r"}], "+", 
                    RowBox[{"36", " ", 
                    SuperscriptBox["r", "2"]}]}], ")"}]}]}], ")"}]}]}], 
             ")"}]}]}], ")"}]}], ")"}]}]}], ")"}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.935501312807856*^9, 3.935501382648203*^9}, 
   3.935501993552207*^9, 3.9355733908013277`*^9, {3.935575519378251*^9, 
   3.935575543179954*^9}, 3.935576582445388*^9, 3.9360391566860065`*^9, 
   3.936039205274027*^9, 3.9360392940101624`*^9, {3.944644466212162*^9, 
   3.9446444950445404`*^9}, 3.971422743544167*^9},
 CellLabel->
  "Out[112]=",ExpressionUUID->"492b7f14-2667-4214-9ce4-eed600590b55"]
}, Open  ]],

Cell["Now set lz = 0", "Text",
 CellChangeTimes->{{3.934005908155973*^9, 3.934005924355298*^9}, {
  3.935051450303854*^9, 3.9350514544332314`*^9}, {3.935054451382663*^9, 
  3.935054471575951*^9}, {3.971422782734787*^9, 3.971422785017006*^9}, {
  3.971422817174466*^9, 
  3.9714228230275993`*^9}},ExpressionUUID->"9986855e-a2b1-4ee2-be13-\
12748bb9bec0"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"testmat", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"reduced", "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"theta", "->", 
         RowBox[{"Pi", "/", "2"}]}], ",", 
        RowBox[{"lz", "->", "0"}]}], "}"}]}], ",", 
     RowBox[{"Assumptions", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"r", ">", "1"}], ",", 
        RowBox[{"ep", ">", "0"}]}], "}"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"testmat", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.9714227920091953`*^9, 3.971422798114053*^9}},
 CellLabel->
  "In[113]:=",ExpressionUUID->"e6c915be-bcfb-449e-8145-e181703d4ca3"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0"},
     {"0", 
      FractionBox[
       RowBox[{"27", " ", 
        SuperscriptBox["a", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "r"}], ")"}]}], 
       SuperscriptBox["r", "7"]], "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"3", " ", "a", " ", 
         SqrtBox[
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SuperscriptBox["ep", "2"]}]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "3"}], "+", 
           RowBox[{"2", " ", "r"}]}], ")"}]}], 
        RowBox[{"2", " ", 
         SuperscriptBox["r", "5"]}]]}]},
     {"0", "0", 
      FractionBox[
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"64", " ", 
            SuperscriptBox["a", "2"]}]}], ")"}], " ", 
         SuperscriptBox["ep", "2"]}]}], 
       RowBox[{"2", " ", 
        SuperscriptBox["r", "3"]}]], "0"},
     {"0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"3", " ", "a", " ", 
         SqrtBox[
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SuperscriptBox["ep", "2"]}]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "3"}], "+", 
           RowBox[{"2", " ", "r"}]}], ")"}]}], 
        RowBox[{"2", " ", 
         SuperscriptBox["r", "5"]}]]}], "0", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"9", " ", 
          SuperscriptBox["a", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "r"}], ")"}]}], 
         SuperscriptBox["r", "7"]]}], "+", 
       FractionBox[
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         SuperscriptBox["ep", "2"]}], 
        RowBox[{"2", " ", 
         SuperscriptBox["r", "3"]}]]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.971422798784501*^9},
 CellLabel->
  "Out[114]//MatrixForm=",ExpressionUUID->"92c76a85-5c8a-4741-9762-\
5ef437062687"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"Eigenvalues", "[", "testmat", "]"}], "]"}]], "Input",
 CellLabel->
  "In[115]:=",ExpressionUUID->"b75cf5d1-7c3d-45e9-b49b-3bcb700426c6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", 
   FractionBox[
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"64", " ", 
         SuperscriptBox["a", "2"]}]}], ")"}], " ", 
      SuperscriptBox["ep", "2"]}]}], 
    RowBox[{"2", " ", 
     SuperscriptBox["r", "3"]}]], ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      RowBox[{
       RowBox[{"-", "36"}], " ", 
       SuperscriptBox["a", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "r"}], ")"}]}], "+", 
      SuperscriptBox["r", "4"], "-", 
      RowBox[{
       SuperscriptBox["ep", "2"], " ", 
       SuperscriptBox["r", "4"]}], "+", 
      SqrtBox[
       RowBox[{
        RowBox[{"5184", " ", 
         SuperscriptBox["a", "4"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "r"}], ")"}], "2"]}], "+", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            SuperscriptBox["ep", "2"]}], ")"}], "2"], " ", 
         SuperscriptBox["r", "8"]}], "+", 
        RowBox[{"36", " ", 
         SuperscriptBox["a", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SuperscriptBox["ep", "2"]}], ")"}], " ", 
         SuperscriptBox["r", "4"], " ", 
         RowBox[{"(", 
          RowBox[{"13", "-", 
           RowBox[{"16", " ", "r"}], "+", 
           RowBox[{"4", " ", 
            SuperscriptBox["r", "2"]}]}], ")"}]}]}]]}], 
     RowBox[{"4", " ", 
      SuperscriptBox["r", "7"]}]]}], ",", 
   FractionBox[
    RowBox[{
     RowBox[{"36", " ", 
      SuperscriptBox["a", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "r"}], ")"}]}], "-", 
     SuperscriptBox["r", "4"], "+", 
     RowBox[{
      SuperscriptBox["ep", "2"], " ", 
      SuperscriptBox["r", "4"]}], "+", 
     SqrtBox[
      RowBox[{
       RowBox[{"5184", " ", 
        SuperscriptBox["a", "4"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "r"}], ")"}], "2"]}], "+", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SuperscriptBox["ep", "2"]}], ")"}], "2"], " ", 
        SuperscriptBox["r", "8"]}], "+", 
       RowBox[{"36", " ", 
        SuperscriptBox["a", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SuperscriptBox["ep", "2"]}], ")"}], " ", 
        SuperscriptBox["r", "4"], " ", 
        RowBox[{"(", 
         RowBox[{"13", "-", 
          RowBox[{"16", " ", "r"}], "+", 
          RowBox[{"4", " ", 
           SuperscriptBox["r", "2"]}]}], ")"}]}]}]]}], 
    RowBox[{"4", " ", 
     SuperscriptBox["r", "7"]}]]}], "}"}]], "Output",
 CellChangeTimes->{3.971422805144671*^9},
 CellLabel->
  "Out[115]=",ExpressionUUID->"c08a9585-3720-4da9-b5bc-fcc3f50e0c49"]
}, Open  ]]
}, Open  ]]
}, Closed]]
}, Open  ]]
},
WindowSize->{1470, 894},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
WindowStatusArea->"",
CellContext->Notebook,
Magnification:>1.1 Inherited,
FrontEndVersion->"14.2 for Mac OS X ARM (64-bit) (December 26, 2024)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"7b9d83f7-1ede-4df4-b15e-39e5e4371821"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[576, 22, 170, 3, 106, "Title",ExpressionUUID->"16e929a7-d0a3-42bd-8425-5fe6587a4caa"],
Cell[749, 27, 321, 6, 57, "Subtitle",ExpressionUUID->"98bfcee8-72d8-4f3e-afeb-66e7a6644858"],
Cell[1073, 35, 656, 13, 32, "Input",ExpressionUUID->"a3093947-3853-774a-841d-0c6bf4e2cbdf"],
Cell[CellGroupData[{
Cell[1754, 52, 219, 4, 72, "Section",ExpressionUUID->"5f924686-9550-4b1f-97d5-11d0f0d62160"],
Cell[CellGroupData[{
Cell[1998, 60, 195, 3, 58, "Subsection",ExpressionUUID->"266c74b9-ee4f-4521-9adc-47bbfd6a6dc8"],
Cell[2196, 65, 186, 3, 38, "Text",ExpressionUUID->"1541ac38-f1ea-4eb3-b4f2-b100322da472"],
Cell[2385, 70, 11283, 296, 1576, "Input",ExpressionUUID->"f21bef1c-65ef-4768-aab2-4366f8ad3ab3",
 InitializationCell->True],
Cell[13671, 368, 33401, 758, 2828, "Input",ExpressionUUID->"29641491-fd16-4695-b0a2-9de0b589632a",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[47109, 1131, 182, 3, 40, "Subsection",ExpressionUUID->"7a59d467-6954-4c48-aa92-e192b76561a5"],
Cell[47294, 1136, 8794, 250, 872, "Input",ExpressionUUID->"7b5cbb39-9bc8-9740-88af-1d3c898d22e0",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[56113, 1390, 274, 5, 31, "Input",ExpressionUUID->"58b998a6-e969-e743-8963-d8c277bce876"],
Cell[56390, 1397, 2172, 65, 70, "Output",ExpressionUUID->"5b6810d1-e045-46a5-8882-9c6ac4b727b9"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[58611, 1468, 182, 3, 40, "Subsection",ExpressionUUID->"17f84823-11f9-46f5-87d2-1880f8fd34f6"],
Cell[58796, 1473, 28267, 754, 2748, "Input",ExpressionUUID->"4a10e253-4bcc-48e9-974d-f71d19202c61",
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[87112, 2233, 421, 6, 57, "Section",ExpressionUUID->"75a54489-e589-bb4b-8ccb-4831d80e56e4"],
Cell[CellGroupData[{
Cell[87558, 2243, 378, 6, 58, "Subsection",ExpressionUUID->"874ebe37-2463-c749-a897-3d4f99b12b07"],
Cell[87939, 2251, 5187, 128, 504, "Input",ExpressionUUID->"f137eb3e-4cd4-4943-9a43-e6b2a687391a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[93163, 2384, 164, 3, 58, "Subsection",ExpressionUUID->"f670db8a-8d75-e34f-b307-6bca94049d7c"],
Cell[CellGroupData[{
Cell[93352, 2391, 3496, 93, 459, "Input",ExpressionUUID->"07a79e12-a0ed-c448-818f-cffb501ed195"],
Cell[96851, 2486, 4182, 107, 144, "Output",ExpressionUUID->"743ddf60-11a0-49f7-9248-083536d737c2"],
Cell[101036, 2595, 3974, 104, 156, "Output",ExpressionUUID->"32d3156c-044b-401c-ae71-dc39a0b03151"],
Cell[105013, 2701, 2007, 41, 103, "Output",ExpressionUUID->"036fb407-36ef-4ae4-bbf5-ec21c38a2b0e"]
}, Open  ]],
Cell[107035, 2745, 193, 5, 37, "Text",ExpressionUUID->"37be20ee-fb0a-4a81-af7b-ced22daed90c"],
Cell[CellGroupData[{
Cell[107253, 2754, 2884, 77, 212, "Input",ExpressionUUID->"61473d0e-82ad-4d68-aa20-8aff50c45b00"],
Cell[110140, 2833, 2156, 64, 70, "Output",ExpressionUUID->"daa06c5d-f2ff-4ce3-846d-b5d702d7304e"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[112345, 2903, 171, 3, 58, "Subsection",ExpressionUUID->"59e53f6e-c6b4-5240-afdf-55d00df899c4"],
Cell[CellGroupData[{
Cell[112541, 2910, 4088, 104, 549, "Input",ExpressionUUID->"84c18ada-202d-7c4c-992c-fea3cc735eec"],
Cell[116632, 3016, 2625, 67, 145, "Output",ExpressionUUID->"74e3c3a9-9461-4257-b6e2-a00d309c4b67"],
Cell[119260, 3085, 2557, 66, 152, "Output",ExpressionUUID->"4e086069-bd72-45a8-97a3-1bb0f16125a7"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[121878, 3158, 232, 4, 57, "Section",ExpressionUUID->"1cc04b4d-a8d7-4b00-a7f4-affa0de0bc81"],
Cell[CellGroupData[{
Cell[122135, 3166, 309, 5, 58, "Subsection",ExpressionUUID->"20aa5ce1-a8ab-5f4b-b7b1-0405258e8457"],
Cell[122447, 3173, 212, 4, 37, "Text",ExpressionUUID->"baf57b4b-7491-4eaa-989f-e1c4c200e779"],
Cell[CellGroupData[{
Cell[122684, 3181, 2573, 58, 324, "Input",ExpressionUUID->"e7f59428-5420-1d45-acc2-071660c59879",
 CellID->950018488],
Cell[125260, 3241, 594, 10, 36, "Output",ExpressionUUID->"d0ca52b5-33f8-4eda-b403-362751dd1148"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[125903, 3257, 276, 4, 58, "Subsection",ExpressionUUID->"0fb348d8-f1b2-864d-93f3-b26b1432e9b1"],
Cell[126182, 3263, 452, 12, 77, "Input",ExpressionUUID->"37f55650-fedc-484f-8e8c-832adccb3e3b"],
Cell[126637, 3277, 214, 4, 37, "Text",ExpressionUUID->"6e18ca4e-4960-49a7-a810-96a2896ebdf7"],
Cell[CellGroupData[{
Cell[126876, 3285, 961, 19, 32, "Input",ExpressionUUID->"d4efc434-4a4d-594f-9936-c1db043cf80a"],
Cell[127840, 3306, 1420, 37, 128, "Output",ExpressionUUID->"399a4356-2b9e-4cf7-9897-c62924ce6e56"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[129309, 3349, 198, 3, 58, "Subsection",ExpressionUUID->"c634655f-8d16-f04f-a9ff-c7812ed006e5"],
Cell[CellGroupData[{
Cell[129532, 3356, 1679, 33, 167, "Input",ExpressionUUID->"bbb3b868-ef02-d043-82ac-6db52f99a920"],
Cell[131214, 3391, 3285, 79, 148, "Output",ExpressionUUID->"4b3d0b2f-dfce-4ddb-945f-73752d9b23c1"],
Cell[134502, 3472, 2834, 67, 143, "Output",ExpressionUUID->"8963ea10-c1dd-4ae4-b053-37fd0b7b9ee0"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[137397, 3546, 275, 4, 57, "Section",ExpressionUUID->"4fd9ff9b-cf85-8f4d-9d7a-e5fd5eccf79b"],
Cell[CellGroupData[{
Cell[137697, 3554, 281, 4, 58, "Subsection",ExpressionUUID->"c8d820af-330c-488a-a919-8130b9f677e0"],
Cell[137981, 3560, 709, 18, 99, "Input",ExpressionUUID->"d50d875e-e2d3-8f47-af56-ad99d0d3354e"],
Cell[138693, 3580, 308, 6, 37, "Text",ExpressionUUID->"435a4df2-1188-9d49-83b7-f2766ad91827"],
Cell[139004, 3588, 816, 19, 77, "Input",ExpressionUUID->"1c21f494-e612-4442-8f8c-dbca43a3b0d0"],
Cell[139823, 3609, 332, 7, 32, "Input",ExpressionUUID->"3f1d7e49-fab1-4e4b-a2c2-09abb7f75d6e"],
Cell[CellGroupData[{
Cell[140180, 3620, 1299, 26, 54, "Input",ExpressionUUID->"3219ae83-14b8-440f-8fd9-279196419302"],
Cell[141482, 3648, 68672, 1761, 194, "Output",ExpressionUUID->"0f3b4e02-fe5e-4fbe-a46a-d9effe56c5ba"]
}, Open  ]],
Cell[CellGroupData[{
Cell[210191, 5414, 499, 9, 32, "Input",ExpressionUUID->"1a94873a-0904-49a4-a6b0-a64f32c663c3"],
Cell[210693, 5425, 20889, 576, 357, "Output",ExpressionUUID->"492b7f14-2667-4214-9ce4-eed600590b55"]
}, Open  ]],
Cell[231597, 6004, 353, 6, 37, "Text",ExpressionUUID->"9986855e-a2b1-4ee2-be13-12748bb9bec0"],
Cell[CellGroupData[{
Cell[231975, 6014, 688, 19, 54, "Input",ExpressionUUID->"e6c915be-bcfb-449e-8145-e181703d4ca3"],
Cell[232666, 6035, 2446, 80, 147, "Output",ExpressionUUID->"92c76a85-5c8a-4741-9762-5ef437062687"]
}, Open  ]],
Cell[CellGroupData[{
Cell[235149, 6120, 188, 4, 32, "Input",ExpressionUUID->"b75cf5d1-7c3d-45e9-b49b-3bcb700426c6"],
Cell[235340, 6126, 3045, 98, 110, "Output",ExpressionUUID->"c08a9585-3720-4da9-b5bc-fcc3f50e0c49"]
}, Open  ]]
}, Open  ]]
}, Closed]]
}, Open  ]]
}
]
*)

